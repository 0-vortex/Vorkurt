"use strict";(self.webpackChunkvorkurt=self.webpackChunkvorkurt||[]).push([[746],{3461:(Xi,lt,A)=>{A.d(lt,{_t:()=>I});var E=A(7716),he=A(8583),y=A(1386),$=A(521),Q=A(9490),re=A(9238),Me=A(7574),we=A(3637),ve=A(6561);function Wt(_){const{subscriber:u,counter:h,period:g}=_;u.next(h),this.schedule({subscriber:u,counter:h+1,period:g},g)}var se=A(9765),gt=A(5319),Xt=A(1927),nt=A(6682),Jt=A(6782);function Lt(_,u,h){for(let g in u)if(u.hasOwnProperty(g)){const v=u[g];v?_.setProperty(g,v,(null==h?void 0:h.has(g))?"important":""):_.removeProperty(g)}return _}function Et(_,u){const h=u?"":"none";Lt(_.style,{"touch-action":u?"":"none","-webkit-user-drag":u?"":"none","-webkit-tap-highlight-color":u?"":"transparent","user-select":h,"-ms-user-select":h,"-webkit-user-select":h,"-moz-user-select":h})}function Cn(_,u,h){Lt(_.style,{position:u?"":"fixed",top:u?"":"0",opacity:u?"":"0",left:u?"":"-999em"},h)}function tn(_,u){return u&&"none"!=u?_+" "+u:_}function F(_){const u=_.toLowerCase().indexOf("ms")>-1?1:1e3;return parseFloat(_)*u}function j(_,u){return _.getPropertyValue(u).split(",").map(g=>g.trim())}function It(_){const u=_.getBoundingClientRect();return{top:u.top,right:u.right,bottom:u.bottom,left:u.left,width:u.width,height:u.height}}function Ot(_,u,h){const{top:g,bottom:v,left:T,right:S}=_;return h>=g&&h<=v&&u>=T&&u<=S}function Qe(_,u,h){_.top+=u,_.bottom=_.top+_.height,_.left+=h,_.right=_.left+_.width}function si(_,u,h,g){const{top:v,right:T,bottom:S,left:R,width:U,height:z}=_,G=U*u,Z=z*u;return g>v-Z&&g<S+Z&&h>R-G&&h<T+G}A(9761),A(8002),A(5257),A(3342),A(3190),A(946);class Mt{constructor(u,h){this._document=u,this._viewportRuler=h,this.positions=new Map}clear(){this.positions.clear()}cache(u){this.clear(),this.positions.set(this._document,{scrollPosition:this._viewportRuler.getViewportScrollPosition()}),u.forEach(h=>{this.positions.set(h,{scrollPosition:{top:h.scrollTop,left:h.scrollLeft},clientRect:It(h)})})}handleScroll(u){const h=(0,$.sA)(u),g=this.positions.get(h);if(!g)return null;const v=h===this._document?h.documentElement:h,T=g.scrollPosition;let S,R;if(h===this._document){const G=this._viewportRuler.getViewportScrollPosition();S=G.top,R=G.left}else S=h.scrollTop,R=h.scrollLeft;const U=T.top-S,z=T.left-R;return this.positions.forEach((G,Z)=>{G.clientRect&&h!==Z&&v.contains(Z)&&Qe(G.clientRect,U,z)}),T.top=S,T.left=R,{top:U,left:z}}}function oi(_){const u=_.cloneNode(!0),h=u.querySelectorAll("[id]"),g=_.nodeName.toLowerCase();u.removeAttribute("id");for(let v=0;v<h.length;v++)h[v].removeAttribute("id");return"canvas"===g?St(_,u):("input"===g||"select"===g||"textarea"===g)&&de(_,u),ai("canvas",_,u,St),ai("input, textarea, select",_,u,de),u}function ai(_,u,h,g){const v=u.querySelectorAll(_);if(v.length){const T=h.querySelectorAll(_);for(let S=0;S<v.length;S++)g(v[S],T[S])}}let Ji=0;function de(_,u){"file"!==u.type&&(u.value=_.value),"radio"===u.type&&u.name&&(u.name=`mat-clone-${u.name}-${Ji++}`)}function St(_,u){const h=u.getContext("2d");if(h)try{h.drawImage(_,0,0)}catch(g){}}const fe=(0,$.i$)({passive:!0}),rt=(0,$.i$)({passive:!1}),Dt=new Set(["position"]);class ht{constructor(u,h,g,v,T,S){this._config=h,this._document=g,this._ngZone=v,this._viewportRuler=T,this._dragDropRegistry=S,this._passiveTransform={x:0,y:0},this._activeTransform={x:0,y:0},this._hasStartedDragging=!1,this._moveEvents=new se.xQ,this._pointerMoveSubscription=gt.w.EMPTY,this._pointerUpSubscription=gt.w.EMPTY,this._scrollSubscription=gt.w.EMPTY,this._resizeSubscription=gt.w.EMPTY,this._boundaryElement=null,this._nativeInteractionsEnabled=!0,this._handles=[],this._disabledHandles=new Set,this._direction="ltr",this.dragStartDelay=0,this._disabled=!1,this.beforeStarted=new se.xQ,this.started=new se.xQ,this.released=new se.xQ,this.ended=new se.xQ,this.entered=new se.xQ,this.exited=new se.xQ,this.dropped=new se.xQ,this.moved=this._moveEvents,this._pointerDown=R=>{if(this.beforeStarted.next(),this._handles.length){const U=this._handles.find(z=>{const G=(0,$.sA)(R);return!!G&&(G===z||z.contains(G))});U&&!this._disabledHandles.has(U)&&!this.disabled&&this._initializeDragSequence(U,R)}else this.disabled||this._initializeDragSequence(this._rootElement,R)},this._pointerMove=R=>{const U=this._getPointerPositionOnPage(R);if(!this._hasStartedDragging){if(Math.abs(U.x-this._pickupPositionOnPage.x)+Math.abs(U.y-this._pickupPositionOnPage.y)>=this._config.dragStartThreshold){const Xe=Date.now()>=this._dragStartTime+this._getDragStartDelay(R),_t=this._dropContainer;if(!Xe)return void this._endDragSequence(R);(!_t||!_t.isDragging()&&!_t.isReceiving())&&(R.preventDefault(),this._hasStartedDragging=!0,this._ngZone.run(()=>this._startDragSequence(R)))}return}this._boundaryElement&&(!this._previewRect||!this._previewRect.width&&!this._previewRect.height)&&(this._previewRect=(this._preview||this._rootElement).getBoundingClientRect()),R.preventDefault();const z=this._getConstrainedPointerPosition(U);if(this._hasMoved=!0,this._lastKnownPointerPosition=U,this._updatePointerDirectionDelta(z),this._dropContainer)this._updateActiveDropContainer(z,U);else{const G=this._activeTransform;G.x=z.x-this._pickupPositionOnPage.x+this._passiveTransform.x,G.y=z.y-this._pickupPositionOnPage.y+this._passiveTransform.y,this._applyRootElementTransform(G.x,G.y),"undefined"!=typeof SVGElement&&this._rootElement instanceof SVGElement&&this._rootElement.setAttribute("transform",`translate(${G.x} ${G.y})`)}this._moveEvents.observers.length&&this._ngZone.run(()=>{this._moveEvents.next({source:this,pointerPosition:z,event:R,distance:this._getDragDistance(z),delta:this._pointerDirectionDelta})})},this._pointerUp=R=>{this._endDragSequence(R)},this.withRootElement(u).withParent(h.parentDragRef||null),this._parentPositions=new Mt(g,T),S.registerDragItem(this)}get disabled(){return this._disabled||!(!this._dropContainer||!this._dropContainer.disabled)}set disabled(u){const h=(0,Q.Ig)(u);h!==this._disabled&&(this._disabled=h,this._toggleNativeDragInteractions(),this._handles.forEach(g=>Et(g,h)))}getPlaceholderElement(){return this._placeholder}getRootElement(){return this._rootElement}getVisibleElement(){return this.isDragging()?this.getPlaceholderElement():this.getRootElement()}withHandles(u){this._handles=u.map(g=>(0,Q.fI)(g)),this._handles.forEach(g=>Et(g,this.disabled)),this._toggleNativeDragInteractions();const h=new Set;return this._disabledHandles.forEach(g=>{this._handles.indexOf(g)>-1&&h.add(g)}),this._disabledHandles=h,this}withPreviewTemplate(u){return this._previewTemplate=u,this}withPlaceholderTemplate(u){return this._placeholderTemplate=u,this}withRootElement(u){const h=(0,Q.fI)(u);return h!==this._rootElement&&(this._rootElement&&this._removeRootElementListeners(this._rootElement),this._ngZone.runOutsideAngular(()=>{h.addEventListener("mousedown",this._pointerDown,rt),h.addEventListener("touchstart",this._pointerDown,fe)}),this._initialTransform=void 0,this._rootElement=h),"undefined"!=typeof SVGElement&&this._rootElement instanceof SVGElement&&(this._ownerSVGElement=this._rootElement.ownerSVGElement),this}withBoundaryElement(u){return this._boundaryElement=u?(0,Q.fI)(u):null,this._resizeSubscription.unsubscribe(),u&&(this._resizeSubscription=this._viewportRuler.change(10).subscribe(()=>this._containInsideBoundaryOnResize())),this}withParent(u){return this._parentDragRef=u,this}dispose(){this._removeRootElementListeners(this._rootElement),this.isDragging()&&Ut(this._rootElement),Ut(this._anchor),this._destroyPreview(),this._destroyPlaceholder(),this._dragDropRegistry.removeDragItem(this),this._removeSubscriptions(),this.beforeStarted.complete(),this.started.complete(),this.released.complete(),this.ended.complete(),this.entered.complete(),this.exited.complete(),this.dropped.complete(),this._moveEvents.complete(),this._handles=[],this._disabledHandles.clear(),this._dropContainer=void 0,this._resizeSubscription.unsubscribe(),this._parentPositions.clear(),this._boundaryElement=this._rootElement=this._ownerSVGElement=this._placeholderTemplate=this._previewTemplate=this._anchor=this._parentDragRef=null}isDragging(){return this._hasStartedDragging&&this._dragDropRegistry.isDragging(this)}reset(){this._rootElement.style.transform=this._initialTransform||"",this._activeTransform={x:0,y:0},this._passiveTransform={x:0,y:0}}disableHandle(u){!this._disabledHandles.has(u)&&this._handles.indexOf(u)>-1&&(this._disabledHandles.add(u),Et(u,!0))}enableHandle(u){this._disabledHandles.has(u)&&(this._disabledHandles.delete(u),Et(u,this.disabled))}withDirection(u){return this._direction=u,this}_withDropContainer(u){this._dropContainer=u}getFreeDragPosition(){const u=this.isDragging()?this._activeTransform:this._passiveTransform;return{x:u.x,y:u.y}}setFreeDragPosition(u){return this._activeTransform={x:0,y:0},this._passiveTransform.x=u.x,this._passiveTransform.y=u.y,this._dropContainer||this._applyRootElementTransform(u.x,u.y),this}withPreviewContainer(u){return this._previewContainer=u,this}_sortFromLastPointerPosition(){const u=this._lastKnownPointerPosition;u&&this._dropContainer&&this._updateActiveDropContainer(this._getConstrainedPointerPosition(u),u)}_removeSubscriptions(){this._pointerMoveSubscription.unsubscribe(),this._pointerUpSubscription.unsubscribe(),this._scrollSubscription.unsubscribe()}_destroyPreview(){this._preview&&Ut(this._preview),this._previewRef&&this._previewRef.destroy(),this._preview=this._previewRef=null}_destroyPlaceholder(){this._placeholder&&Ut(this._placeholder),this._placeholderRef&&this._placeholderRef.destroy(),this._placeholder=this._placeholderRef=null}_endDragSequence(u){if(this._dragDropRegistry.isDragging(this)&&(this._removeSubscriptions(),this._dragDropRegistry.stopDragging(this),this._toggleNativeDragInteractions(),this._handles&&(this._rootElement.style.webkitTapHighlightColor=this._rootElementTapHighlight),this._hasStartedDragging))if(this.released.next({source:this}),this._dropContainer)this._dropContainer._stopScrolling(),this._animatePreviewToPlaceholder().then(()=>{this._cleanupDragArtifacts(u),this._cleanupCachedDimensions(),this._dragDropRegistry.stopDragging(this)});else{this._passiveTransform.x=this._activeTransform.x;const h=this._getPointerPositionOnPage(u);this._passiveTransform.y=this._activeTransform.y,this._ngZone.run(()=>{this.ended.next({source:this,distance:this._getDragDistance(h),dropPoint:h})}),this._cleanupCachedDimensions(),this._dragDropRegistry.stopDragging(this)}}_startDragSequence(u){mt(u)&&(this._lastTouchEventTime=Date.now()),this._toggleNativeDragInteractions();const h=this._dropContainer;if(h){const g=this._rootElement,v=g.parentNode,T=this._placeholder=this._createPlaceholderElement(),S=this._anchor=this._anchor||this._document.createComment(""),R=this._getShadowRoot();v.insertBefore(S,g),this._initialTransform=g.style.transform||"",this._preview=this._createPreviewElement(),Cn(g,!1,Dt),this._document.body.appendChild(v.replaceChild(T,g)),this._getPreviewInsertionPoint(v,R).appendChild(this._preview),this.started.next({source:this}),h.start(),this._initialContainer=h,this._initialIndex=h.getItemIndex(this)}else this.started.next({source:this}),this._initialContainer=this._initialIndex=void 0;this._parentPositions.cache(h?h.getScrollableParents():[])}_initializeDragSequence(u,h){this._parentDragRef&&h.stopPropagation();const g=this.isDragging(),v=mt(h),T=!v&&0!==h.button,S=this._rootElement,R=(0,$.sA)(h),U=!v&&this._lastTouchEventTime&&this._lastTouchEventTime+800>Date.now(),z=v?(0,re.yG)(h):(0,re.X6)(h);if(R&&R.draggable&&"mousedown"===h.type&&h.preventDefault(),g||T||U||z)return;this._handles.length&&(this._rootElementTapHighlight=S.style.webkitTapHighlightColor||"",S.style.webkitTapHighlightColor="transparent"),this._hasStartedDragging=this._hasMoved=!1,this._removeSubscriptions(),this._pointerMoveSubscription=this._dragDropRegistry.pointerMove.subscribe(this._pointerMove),this._pointerUpSubscription=this._dragDropRegistry.pointerUp.subscribe(this._pointerUp),this._scrollSubscription=this._dragDropRegistry.scrolled(this._getShadowRoot()).subscribe(xe=>this._updateOnScroll(xe)),this._boundaryElement&&(this._boundaryRect=It(this._boundaryElement));const G=this._previewTemplate;this._pickupPositionInElement=G&&G.template&&!G.matchSize?{x:0,y:0}:this._getPointerPositionInElement(u,h);const Z=this._pickupPositionOnPage=this._lastKnownPointerPosition=this._getPointerPositionOnPage(h);this._pointerDirectionDelta={x:0,y:0},this._pointerPositionAtLastDirectionChange={x:Z.x,y:Z.y},this._dragStartTime=Date.now(),this._dragDropRegistry.startDragging(this,h)}_cleanupDragArtifacts(u){Cn(this._rootElement,!0,Dt),this._anchor.parentNode.replaceChild(this._rootElement,this._anchor),this._destroyPreview(),this._destroyPlaceholder(),this._boundaryRect=this._previewRect=this._initialTransform=void 0,this._ngZone.run(()=>{const h=this._dropContainer,g=h.getItemIndex(this),v=this._getPointerPositionOnPage(u),T=this._getDragDistance(v),S=h._isOverContainer(v.x,v.y);this.ended.next({source:this,distance:T,dropPoint:v}),this.dropped.next({item:this,currentIndex:g,previousIndex:this._initialIndex,container:h,previousContainer:this._initialContainer,isPointerOverContainer:S,distance:T,dropPoint:v}),h.drop(this,g,this._initialIndex,this._initialContainer,S,T,v),this._dropContainer=this._initialContainer})}_updateActiveDropContainer({x:u,y:h},{x:g,y:v}){let T=this._initialContainer._getSiblingContainerFromPosition(this,u,h);!T&&this._dropContainer!==this._initialContainer&&this._initialContainer._isOverContainer(u,h)&&(T=this._initialContainer),T&&T!==this._dropContainer&&this._ngZone.run(()=>{this.exited.next({item:this,container:this._dropContainer}),this._dropContainer.exit(this),this._dropContainer=T,this._dropContainer.enter(this,u,h,T===this._initialContainer&&T.sortingDisabled?this._initialIndex:void 0),this.entered.next({item:this,container:T,currentIndex:T.getItemIndex(this)})}),this.isDragging()&&(this._dropContainer._startScrollingIfNecessary(g,v),this._dropContainer._sortItem(this,u,h,this._pointerDirectionDelta),this._applyPreviewTransform(u-this._pickupPositionInElement.x,h-this._pickupPositionInElement.y))}_createPreviewElement(){const u=this._previewTemplate,h=this.previewClass,g=u?u.template:null;let v;if(g&&u){const T=u.matchSize?this._rootElement.getBoundingClientRect():null,S=u.viewContainer.createEmbeddedView(g,u.context);S.detectChanges(),v=Vt(S,this._document),this._previewRef=S,u.matchSize?Rn(v,T):v.style.transform=Ft(this._pickupPositionOnPage.x,this._pickupPositionOnPage.y)}else{const T=this._rootElement;v=oi(T),Rn(v,T.getBoundingClientRect()),this._initialTransform&&(v.style.transform=this._initialTransform)}return Lt(v.style,{"pointer-events":"none",margin:"0",position:"fixed",top:"0",left:"0","z-index":`${this._config.zIndex||1e3}`},Dt),Et(v,!1),v.classList.add("cdk-drag-preview"),v.setAttribute("dir",this._direction),h&&(Array.isArray(h)?h.forEach(T=>v.classList.add(T)):v.classList.add(h)),v}_animatePreviewToPlaceholder(){if(!this._hasMoved)return Promise.resolve();const u=this._placeholder.getBoundingClientRect();this._preview.classList.add("cdk-drag-animating"),this._applyPreviewTransform(u.left,u.top);const h=function(_){const u=getComputedStyle(_),h=j(u,"transition-property"),g=h.find(R=>"transform"===R||"all"===R);if(!g)return 0;const v=h.indexOf(g),T=j(u,"transition-duration"),S=j(u,"transition-delay");return F(T[v])+F(S[v])}(this._preview);return 0===h?Promise.resolve():this._ngZone.runOutsideAngular(()=>new Promise(g=>{const v=S=>{(!S||(0,$.sA)(S)===this._preview&&"transform"===S.propertyName)&&(this._preview.removeEventListener("transitionend",v),g(),clearTimeout(T))},T=setTimeout(v,1.5*h);this._preview.addEventListener("transitionend",v)}))}_createPlaceholderElement(){const u=this._placeholderTemplate,h=u?u.template:null;let g;return h?(this._placeholderRef=u.viewContainer.createEmbeddedView(h,u.context),this._placeholderRef.detectChanges(),g=Vt(this._placeholderRef,this._document)):g=oi(this._rootElement),g.classList.add("cdk-drag-placeholder"),g}_getPointerPositionInElement(u,h){const g=this._rootElement.getBoundingClientRect(),v=u===this._rootElement?null:u,T=v?v.getBoundingClientRect():g,S=mt(h)?h.targetTouches[0]:h,R=this._getViewportScrollPosition();return{x:T.left-g.left+(S.pageX-T.left-R.left),y:T.top-g.top+(S.pageY-T.top-R.top)}}_getPointerPositionOnPage(u){const h=this._getViewportScrollPosition(),g=mt(u)?u.touches[0]||u.changedTouches[0]||{pageX:0,pageY:0}:u,v=g.pageX-h.left,T=g.pageY-h.top;if(this._ownerSVGElement){const S=this._ownerSVGElement.getScreenCTM();if(S){const R=this._ownerSVGElement.createSVGPoint();return R.x=v,R.y=T,R.matrixTransform(S.inverse())}}return{x:v,y:T}}_getConstrainedPointerPosition(u){const h=this._dropContainer?this._dropContainer.lockAxis:null;let{x:g,y:v}=this.constrainPosition?this.constrainPosition(u,this):u;if("x"===this.lockAxis||"x"===h?v=this._pickupPositionOnPage.y:("y"===this.lockAxis||"y"===h)&&(g=this._pickupPositionOnPage.x),this._boundaryRect){const{x:T,y:S}=this._pickupPositionInElement,R=this._boundaryRect,U=this._previewRect,z=R.top+S,G=R.bottom-(U.height-S);g=li(g,R.left+T,R.right-(U.width-T)),v=li(v,z,G)}return{x:g,y:v}}_updatePointerDirectionDelta(u){const{x:h,y:g}=u,v=this._pointerDirectionDelta,T=this._pointerPositionAtLastDirectionChange,S=Math.abs(h-T.x),R=Math.abs(g-T.y);return S>this._config.pointerDirectionChangeThreshold&&(v.x=h>T.x?1:-1,T.x=h),R>this._config.pointerDirectionChangeThreshold&&(v.y=g>T.y?1:-1,T.y=g),v}_toggleNativeDragInteractions(){if(!this._rootElement||!this._handles)return;const u=this._handles.length>0||!this.isDragging();u!==this._nativeInteractionsEnabled&&(this._nativeInteractionsEnabled=u,Et(this._rootElement,u))}_removeRootElementListeners(u){u.removeEventListener("mousedown",this._pointerDown,rt),u.removeEventListener("touchstart",this._pointerDown,fe)}_applyRootElementTransform(u,h){const g=Ft(u,h);null==this._initialTransform&&(this._initialTransform=this._rootElement.style.transform&&"none"!=this._rootElement.style.transform?this._rootElement.style.transform:""),this._rootElement.style.transform=tn(g,this._initialTransform)}_applyPreviewTransform(u,h){var g;const v=(null===(g=this._previewTemplate)||void 0===g?void 0:g.template)?void 0:this._initialTransform,T=Ft(u,h);this._preview.style.transform=tn(T,v)}_getDragDistance(u){const h=this._pickupPositionOnPage;return h?{x:u.x-h.x,y:u.y-h.y}:{x:0,y:0}}_cleanupCachedDimensions(){this._boundaryRect=this._previewRect=void 0,this._parentPositions.clear()}_containInsideBoundaryOnResize(){let{x:u,y:h}=this._passiveTransform;if(0===u&&0===h||this.isDragging()||!this._boundaryElement)return;const g=this._boundaryElement.getBoundingClientRect(),v=this._rootElement.getBoundingClientRect();if(0===g.width&&0===g.height||0===v.width&&0===v.height)return;const T=g.left-v.left,S=v.right-g.right,R=g.top-v.top,U=v.bottom-g.bottom;g.width>v.width?(T>0&&(u+=T),S>0&&(u-=S)):u=0,g.height>v.height?(R>0&&(h+=R),U>0&&(h-=U)):h=0,(u!==this._passiveTransform.x||h!==this._passiveTransform.y)&&this.setFreeDragPosition({y:h,x:u})}_getDragStartDelay(u){const h=this.dragStartDelay;return"number"==typeof h?h:mt(u)?h.touch:h?h.mouse:0}_updateOnScroll(u){const h=this._parentPositions.handleScroll(u);if(h){const g=(0,$.sA)(u);this._boundaryRect&&(g===this._document||g!==this._boundaryElement&&g.contains(this._boundaryElement))&&Qe(this._boundaryRect,h.top,h.left),this._pickupPositionOnPage.x+=h.left,this._pickupPositionOnPage.y+=h.top,this._dropContainer||(this._activeTransform.x-=h.left,this._activeTransform.y-=h.top,this._applyRootElementTransform(this._activeTransform.x,this._activeTransform.y))}}_getViewportScrollPosition(){const u=this._parentPositions.positions.get(this._document);return u?u.scrollPosition:this._viewportRuler.getViewportScrollPosition()}_getShadowRoot(){return void 0===this._cachedShadowRoot&&(this._cachedShadowRoot=(0,$.kV)(this._rootElement)),this._cachedShadowRoot}_getPreviewInsertionPoint(u,h){const g=this._previewContainer||"global";if("parent"===g)return u;if("global"===g){const v=this._document;return h||v.fullscreenElement||v.webkitFullscreenElement||v.mozFullScreenElement||v.msFullscreenElement||v.body}return(0,Q.fI)(g)}}function Ft(_,u){return`translate3d(${Math.round(_)}px, ${Math.round(u)}px, 0)`}function li(_,u,h){return Math.max(u,Math.min(h,_))}function Ut(_){_&&_.parentNode&&_.parentNode.removeChild(_)}function mt(_){return"t"===_.type[0]}function Vt(_,u){const h=_.rootNodes;if(1===h.length&&h[0].nodeType===u.ELEMENT_NODE)return h[0];const g=u.createElement("div");return h.forEach(v=>g.appendChild(v)),g}function Rn(_,u){_.style.width=`${u.width}px`,_.style.height=`${u.height}px`,_.style.transform=Ft(u.left,u.top)}function xt(_,u){return Math.max(0,Math.min(u,_))}class hi{constructor(u,h,g,v,T){this._dragDropRegistry=h,this._ngZone=v,this._viewportRuler=T,this.disabled=!1,this.sortingDisabled=!1,this.autoScrollDisabled=!1,this.autoScrollStep=2,this.enterPredicate=()=>!0,this.sortPredicate=()=>!0,this.beforeStarted=new se.xQ,this.entered=new se.xQ,this.exited=new se.xQ,this.dropped=new se.xQ,this.sorted=new se.xQ,this._isDragging=!1,this._itemPositions=[],this._previousSwap={drag:null,delta:0,overlaps:!1},this._draggables=[],this._siblings=[],this._orientation="vertical",this._activeSiblings=new Set,this._direction="ltr",this._viewportScrollSubscription=gt.w.EMPTY,this._verticalScrollDirection=0,this._horizontalScrollDirection=0,this._stopScrollTimers=new se.xQ,this._cachedShadowRoot=null,this._startScrollInterval=()=>{this._stopScrolling(),function(_=0,u=we.P){return(!(0,ve.k)(_)||_<0)&&(_=0),(!u||"function"!=typeof u.schedule)&&(u=we.P),new Me.y(h=>(h.add(u.schedule(Wt,_,{subscriber:h,counter:0,period:_})),h))}(0,Xt.Z).pipe((0,Jt.R)(this._stopScrollTimers)).subscribe(()=>{const S=this._scrollNode,R=this.autoScrollStep;1===this._verticalScrollDirection?Nn(S,-R):2===this._verticalScrollDirection&&Nn(S,R),1===this._horizontalScrollDirection?sn(S,-R):2===this._horizontalScrollDirection&&sn(S,R)})},this.element=(0,Q.fI)(u),this._document=g,this.withScrollableParents([this.element]),h.registerDropContainer(this),this._parentPositions=new Mt(g,T)}dispose(){this._stopScrolling(),this._stopScrollTimers.complete(),this._viewportScrollSubscription.unsubscribe(),this.beforeStarted.complete(),this.entered.complete(),this.exited.complete(),this.dropped.complete(),this.sorted.complete(),this._activeSiblings.clear(),this._scrollNode=null,this._parentPositions.clear(),this._dragDropRegistry.removeDropContainer(this)}isDragging(){return this._isDragging}start(){this._draggingStarted(),this._notifyReceivingSiblings()}enter(u,h,g,v){let T;this._draggingStarted(),null==v?(T=this.sortingDisabled?this._draggables.indexOf(u):-1,-1===T&&(T=this._getItemIndexFromPointerPosition(u,h,g))):T=v;const S=this._activeDraggables,R=S.indexOf(u),U=u.getPlaceholderElement();let z=S[T];if(z===u&&(z=S[T+1]),R>-1&&S.splice(R,1),z&&!this._dragDropRegistry.isDragging(z)){const G=z.getRootElement();G.parentElement.insertBefore(U,G),S.splice(T,0,u)}else if(this._shouldEnterAsFirstChild(h,g)){const G=S[0].getRootElement();G.parentNode.insertBefore(U,G),S.unshift(u)}else(0,Q.fI)(this.element).appendChild(U),S.push(u);U.style.transform="",this._cacheItemPositions(),this._cacheParentPositions(),this._notifyReceivingSiblings(),this.entered.next({item:u,container:this,currentIndex:this.getItemIndex(u)})}exit(u){this._reset(),this.exited.next({item:u,container:this})}drop(u,h,g,v,T,S,R){this._reset(),this.dropped.next({item:u,currentIndex:h,previousIndex:g,container:this,previousContainer:v,isPointerOverContainer:T,distance:S,dropPoint:R})}withItems(u){const h=this._draggables;return this._draggables=u,u.forEach(g=>g._withDropContainer(this)),this.isDragging()&&(h.filter(v=>v.isDragging()).every(v=>-1===u.indexOf(v))?this._reset():this._cacheItems()),this}withDirection(u){return this._direction=u,this}connectedTo(u){return this._siblings=u.slice(),this}withOrientation(u){return this._orientation=u,this}withScrollableParents(u){const h=(0,Q.fI)(this.element);return this._scrollableElements=-1===u.indexOf(h)?[h,...u]:u.slice(),this}getScrollableParents(){return this._scrollableElements}getItemIndex(u){return this._isDragging?rn("horizontal"===this._orientation&&"rtl"===this._direction?this._itemPositions.slice().reverse():this._itemPositions,g=>g.drag===u):this._draggables.indexOf(u)}isReceiving(){return this._activeSiblings.size>0}_sortItem(u,h,g,v){if(this.sortingDisabled||!this._clientRect||!si(this._clientRect,.05,h,g))return;const T=this._itemPositions,S=this._getItemIndexFromPointerPosition(u,h,g,v);if(-1===S&&T.length>0)return;const R="horizontal"===this._orientation,U=rn(T,ne=>ne.drag===u),z=T[S],Z=z.clientRect,xe=U>S?1:-1,Xe=this._getItemOffsetPx(T[U].clientRect,Z,xe),_t=this._getSiblingOffsetPx(U,T,xe),oe=T.slice();(function(_,u,h){const g=xt(u,_.length-1),v=xt(h,_.length-1);if(g===v)return;const T=_[g],S=v<g?-1:1;for(let R=g;R!==v;R+=S)_[R]=_[R+S];_[v]=T})(T,U,S),this.sorted.next({previousIndex:U,currentIndex:S,container:this,item:u}),T.forEach((ne,fi)=>{if(oe[fi]===ne)return;const pi=ne.drag===u,or=pi?Xe:_t,rs=pi?u.getPlaceholderElement():ne.drag.getRootElement();ne.offset+=or,R?(rs.style.transform=tn(`translate3d(${Math.round(ne.offset)}px, 0, 0)`,ne.initialTransform),Qe(ne.clientRect,0,or)):(rs.style.transform=tn(`translate3d(0, ${Math.round(ne.offset)}px, 0)`,ne.initialTransform),Qe(ne.clientRect,or,0))}),this._previousSwap.overlaps=Ot(Z,h,g),this._previousSwap.drag=z.drag,this._previousSwap.delta=R?v.x:v.y}_startScrollingIfNecessary(u,h){if(this.autoScrollDisabled)return;let g,v=0,T=0;if(this._parentPositions.positions.forEach((S,R)=>{R===this._document||!S.clientRect||g||si(S.clientRect,.05,u,h)&&([v,T]=function(_,u,h,g){const v=on(u,g),T=kn(u,h);let S=0,R=0;if(v){const U=_.scrollTop;1===v?U>0&&(S=1):_.scrollHeight-U>_.clientHeight&&(S=2)}if(T){const U=_.scrollLeft;1===T?U>0&&(R=1):_.scrollWidth-U>_.clientWidth&&(R=2)}return[S,R]}(R,S.clientRect,u,h),(v||T)&&(g=R))}),!v&&!T){const{width:S,height:R}=this._viewportRuler.getViewportSize(),U={width:S,height:R,top:0,right:S,bottom:R,left:0};v=on(U,h),T=kn(U,u),g=window}g&&(v!==this._verticalScrollDirection||T!==this._horizontalScrollDirection||g!==this._scrollNode)&&(this._verticalScrollDirection=v,this._horizontalScrollDirection=T,this._scrollNode=g,(v||T)&&g?this._ngZone.runOutsideAngular(this._startScrollInterval):this._stopScrolling())}_stopScrolling(){this._stopScrollTimers.next()}_draggingStarted(){const u=(0,Q.fI)(this.element).style;this.beforeStarted.next(),this._isDragging=!0,this._initialScrollSnap=u.msScrollSnapType||u.scrollSnapType||"",u.scrollSnapType=u.msScrollSnapType="none",this._cacheItems(),this._viewportScrollSubscription.unsubscribe(),this._listenToScrollEvents()}_cacheParentPositions(){const u=(0,Q.fI)(this.element);this._parentPositions.cache(this._scrollableElements),this._clientRect=this._parentPositions.positions.get(u).clientRect}_cacheItemPositions(){const u="horizontal"===this._orientation;this._itemPositions=this._activeDraggables.map(h=>{const g=h.getVisibleElement();return{drag:h,offset:0,initialTransform:g.style.transform||"",clientRect:It(g)}}).sort((h,g)=>u?h.clientRect.left-g.clientRect.left:h.clientRect.top-g.clientRect.top)}_reset(){this._isDragging=!1;const u=(0,Q.fI)(this.element).style;u.scrollSnapType=u.msScrollSnapType=this._initialScrollSnap,this._activeDraggables.forEach(h=>{var g;const v=h.getRootElement();if(v){const T=null===(g=this._itemPositions.find(S=>S.drag===h))||void 0===g?void 0:g.initialTransform;v.style.transform=T||""}}),this._siblings.forEach(h=>h._stopReceiving(this)),this._activeDraggables=[],this._itemPositions=[],this._previousSwap.drag=null,this._previousSwap.delta=0,this._previousSwap.overlaps=!1,this._stopScrolling(),this._viewportScrollSubscription.unsubscribe(),this._parentPositions.clear()}_getSiblingOffsetPx(u,h,g){const v="horizontal"===this._orientation,T=h[u].clientRect,S=h[u+-1*g];let R=T[v?"width":"height"]*g;if(S){const U=v?"left":"top",z=v?"right":"bottom";-1===g?R-=S.clientRect[U]-T[z]:R+=T[U]-S.clientRect[z]}return R}_getItemOffsetPx(u,h,g){const v="horizontal"===this._orientation;let T=v?h.left-u.left:h.top-u.top;return-1===g&&(T+=v?h.width-u.width:h.height-u.height),T}_shouldEnterAsFirstChild(u,h){if(!this._activeDraggables.length)return!1;const g=this._itemPositions,v="horizontal"===this._orientation;if(g[0].drag!==this._activeDraggables[0]){const S=g[g.length-1].clientRect;return v?u>=S.right:h>=S.bottom}{const S=g[0].clientRect;return v?u<=S.left:h<=S.top}}_getItemIndexFromPointerPosition(u,h,g,v){const T="horizontal"===this._orientation,S=rn(this._itemPositions,({drag:R,clientRect:U},z,G)=>{if(R===u)return G.length<2;if(v){const Z=T?v.x:v.y;if(R===this._previousSwap.drag&&this._previousSwap.overlaps&&Z===this._previousSwap.delta)return!1}return T?h>=Math.floor(U.left)&&h<Math.floor(U.right):g>=Math.floor(U.top)&&g<Math.floor(U.bottom)});return-1!==S&&this.sortPredicate(S,u,this)?S:-1}_cacheItems(){this._activeDraggables=this._draggables.slice(),this._cacheItemPositions(),this._cacheParentPositions()}_isOverContainer(u,h){return null!=this._clientRect&&Ot(this._clientRect,u,h)}_getSiblingContainerFromPosition(u,h,g){return this._siblings.find(v=>v._canReceive(u,h,g))}_canReceive(u,h,g){if(!this._clientRect||!Ot(this._clientRect,h,g)||!this.enterPredicate(u,this))return!1;const v=this._getShadowRoot().elementFromPoint(h,g);if(!v)return!1;const T=(0,Q.fI)(this.element);return v===T||T.contains(v)}_startReceiving(u,h){const g=this._activeSiblings;!g.has(u)&&h.every(v=>this.enterPredicate(v,this)||this._draggables.indexOf(v)>-1)&&(g.add(u),this._cacheParentPositions(),this._listenToScrollEvents())}_stopReceiving(u){this._activeSiblings.delete(u),this._viewportScrollSubscription.unsubscribe()}_listenToScrollEvents(){this._viewportScrollSubscription=this._dragDropRegistry.scrolled(this._getShadowRoot()).subscribe(u=>{if(this.isDragging()){const h=this._parentPositions.handleScroll(u);h&&(this._itemPositions.forEach(({clientRect:g})=>{Qe(g,h.top,h.left)}),this._itemPositions.forEach(({drag:g})=>{this._dragDropRegistry.isDragging(g)&&g._sortFromLastPointerPosition()}))}else this.isReceiving()&&this._cacheParentPositions()})}_getShadowRoot(){if(!this._cachedShadowRoot){const u=(0,$.kV)((0,Q.fI)(this.element));this._cachedShadowRoot=u||this._document}return this._cachedShadowRoot}_notifyReceivingSiblings(){const u=this._activeDraggables.filter(h=>h.isDragging());this._siblings.forEach(h=>h._startReceiving(this,u))}}function rn(_,u){for(let h=0;h<_.length;h++)if(u(_[h],h,_))return h;return-1}function Nn(_,u){_===window?_.scrollBy(0,u):_.scrollTop+=u}function sn(_,u){_===window?_.scrollBy(u,0):_.scrollLeft+=u}function on(_,u){const{top:h,bottom:g,height:v}=_,T=.05*v;return u>=h-T&&u<=h+T?1:u>=g-T&&u<=g+T?2:0}function kn(_,u){const{left:h,right:g,width:v}=_,T=.05*v;return u>=h-T&&u<=h+T?1:u>=g-T&&u<=g+T?2:0}const vt=(0,$.i$)({passive:!1,capture:!0});let We=(()=>{class _{constructor(h,g){this._ngZone=h,this._dropInstances=new Set,this._dragInstances=new Set,this._activeDragInstances=[],this._globalListeners=new Map,this._draggingPredicate=v=>v.isDragging(),this.pointerMove=new se.xQ,this.pointerUp=new se.xQ,this.scroll=new se.xQ,this._preventDefaultWhileDragging=v=>{this._activeDragInstances.length>0&&v.preventDefault()},this._persistentTouchmoveListener=v=>{this._activeDragInstances.length>0&&(this._activeDragInstances.some(this._draggingPredicate)&&v.preventDefault(),this.pointerMove.next(v))},this._document=g}registerDropContainer(h){this._dropInstances.has(h)||this._dropInstances.add(h)}registerDragItem(h){this._dragInstances.add(h),1===this._dragInstances.size&&this._ngZone.runOutsideAngular(()=>{this._document.addEventListener("touchmove",this._persistentTouchmoveListener,vt)})}removeDropContainer(h){this._dropInstances.delete(h)}removeDragItem(h){this._dragInstances.delete(h),this.stopDragging(h),0===this._dragInstances.size&&this._document.removeEventListener("touchmove",this._persistentTouchmoveListener,vt)}startDragging(h,g){if(!(this._activeDragInstances.indexOf(h)>-1)&&(this._activeDragInstances.push(h),1===this._activeDragInstances.length)){const v=g.type.startsWith("touch");this._globalListeners.set(v?"touchend":"mouseup",{handler:T=>this.pointerUp.next(T),options:!0}).set("scroll",{handler:T=>this.scroll.next(T),options:!0}).set("selectstart",{handler:this._preventDefaultWhileDragging,options:vt}),v||this._globalListeners.set("mousemove",{handler:T=>this.pointerMove.next(T),options:vt}),this._ngZone.runOutsideAngular(()=>{this._globalListeners.forEach((T,S)=>{this._document.addEventListener(S,T.handler,T.options)})})}}stopDragging(h){const g=this._activeDragInstances.indexOf(h);g>-1&&(this._activeDragInstances.splice(g,1),0===this._activeDragInstances.length&&this._clearGlobalListeners())}isDragging(h){return this._activeDragInstances.indexOf(h)>-1}scrolled(h){const g=[this.scroll];return h&&h!==this._document&&g.push(new Me.y(v=>this._ngZone.runOutsideAngular(()=>{const S=R=>{this._activeDragInstances.length&&v.next(R)};return h.addEventListener("scroll",S,!0),()=>{h.removeEventListener("scroll",S,!0)}}))),(0,nt.T)(...g)}ngOnDestroy(){this._dragInstances.forEach(h=>this.removeDragItem(h)),this._dropInstances.forEach(h=>this.removeDropContainer(h)),this._clearGlobalListeners(),this.pointerMove.complete(),this.pointerUp.complete()}_clearGlobalListeners(){this._globalListeners.forEach((h,g)=>{this._document.removeEventListener(g,h.handler,h.options)}),this._globalListeners.clear()}}return _.\u0275fac=function(h){return new(h||_)(E.LFG(E.R0b),E.LFG(he.K0))},_.\u0275prov=E.Yz7({factory:function(){return new _(E.LFG(E.R0b),E.LFG(he.K0))},token:_,providedIn:"root"}),_})();const di={dragStartThreshold:5,pointerDirectionChangeThreshold:5};let an=(()=>{class _{constructor(h,g,v,T){this._document=h,this._ngZone=g,this._viewportRuler=v,this._dragDropRegistry=T}createDrag(h,g=di){return new ht(h,g,this._document,this._ngZone,this._viewportRuler,this._dragDropRegistry)}createDropList(h){return new hi(h,this._dragDropRegistry,this._document,this._ngZone,this._viewportRuler)}}return _.\u0275fac=function(h){return new(h||_)(E.LFG(he.K0),E.LFG(E.R0b),E.LFG(y.rL),E.LFG(We))},_.\u0275prov=E.Yz7({factory:function(){return new _(E.LFG(he.K0),E.LFG(E.R0b),E.LFG(y.rL),E.LFG(We))},token:_,providedIn:"root"}),_})(),I=(()=>{class _{}return _.\u0275fac=function(h){return new(h||_)},_.\u0275mod=E.oAB({type:_}),_.\u0275inj=E.cJS({providers:[an],imports:[y.ZD]}),_})()},6746:(Xi,lt,A)=>{A.r(lt),A.d(lt,{HeaderModule:()=>qt});var E=A(8583),he=A(4419),y=A(7716),$=A(7238),Q=A(8002),re=A(2809),Me=A(8753);function we(I,_){if(1&I&&(y.TgZ(0,"div",3),y.TgZ(1,"div",4),y.TgZ(2,"div",5),y._uU(3),y.qZA(),y.TgZ(4,"div"),y._uU(5),y.qZA(),y.qZA(),y.qZA()),2&I){const u=_.$implicit;y.xp6(3),y.Oqu(u.id),y.xp6(2),y.Oqu(u.name)}}function ve(I,_){if(1&I&&(y.TgZ(0,"elix-jumbotron",1),y.YNc(1,we,6,2,"div",2),y.qZA()),2&I){const u=y.oxw();y.Q6J("type","template"),y.xp6(1),y.Q6J("ngForOf",u.notifications)}}let ut=(()=>{class I{constructor(u){this._timerService=u}ngOnInit(){this._timerService.counterData$.subscribe(u=>this.notifications=u)}}return I.\u0275fac=function(u){return new(u||I)(y.Y36(re.f))},I.\u0275cmp=y.Xpm({type:I,selectors:[["elix-notification"]],decls:1,vars:1,consts:[["class","text-xl vorkurt__color-text flex vorkurt__container-template",3,"type",4,"ngIf"],[1,"text-xl","vorkurt__color-text","flex","vorkurt__container-template",3,"type"],["class","flex flex-col",4,"ngFor","ngForOf"],[1,"flex","flex-col"],[1,"hover:","cursor-pointer","flex","vorkurt__notification"],[1,"w-10"]],template:function(u,h){1&u&&y.YNc(0,ve,2,2,"elix-jumbotron",0),2&u&&y.Q6J("ngIf",h.notifications.length)},directives:[E.O5,Me.w,E.sg],styles:[".vorkurt__notification[_ngcontent-%COMP%]:hover{background:#316dca;color:#8f8f8f}"]}),I})();var Wt=A(281),se=A(6215),gt=A(9765);let Xt=(()=>{class I{constructor(){this._statePopUpLogin=new se.X(!1),this.statePopUp$=this._statePopUpLogin.asObservable(),this._coordinates=new gt.xQ,this.coordinates$=this._coordinates.asObservable()}coordinates(u){this._coordinates.next(u)}statePopLogin(u){this._statePopUpLogin.next(u)}}return I.\u0275fac=function(u){return new(u||I)},I.\u0275prov=y.Yz7({token:I,factory:I.\u0275fac,providedIn:"root"}),I})();var nt=A(625),Jt=A(7636),xn=A(9335),C=A(8403),en=A(1233),it=A(2458),Ye=A(9490),W=A(6237),Lt=A(5319),Et=A(2759),Cn=A(5435);const tn=["primaryValueBar"],F=(0,it.pj)(class{constructor(I){this._elementRef=I}},"primary"),An=new y.OlP("mat-progress-bar-location",{providedIn:"root",factory:function(){const I=(0,y.f3M)(E.K0),_=I?I.location:null;return{getPathname:()=>_?_.pathname+_.search:""}}});let It=0,Ot=(()=>{class I extends F{constructor(u,h,g,v){super(u),this._ngZone=h,this._animationMode=g,this._isNoopAnimation=!1,this._value=0,this._bufferValue=0,this.animationEnd=new y.vpe,this._animationEndSubscription=Lt.w.EMPTY,this.mode="determinate",this.progressbarId="mat-progress-bar-"+It++;const T=v?v.getPathname().split("#")[0]:"";this._rectangleFillValue=`url('${T}#${this.progressbarId}')`,this._isNoopAnimation="NoopAnimations"===g}get value(){return this._value}set value(u){this._value=Qe((0,Ye.su)(u)||0)}get bufferValue(){return this._bufferValue}set bufferValue(u){this._bufferValue=Qe(u||0)}_primaryTransform(){return{transform:`scale3d(${this.value/100}, 1, 1)`}}_bufferTransform(){return"buffer"===this.mode?{transform:`scale3d(${this.bufferValue/100}, 1, 1)`}:null}ngAfterViewInit(){this._ngZone.runOutsideAngular(()=>{const u=this._primaryValueBar.nativeElement;this._animationEndSubscription=(0,Et.R)(u,"transitionend").pipe((0,Cn.h)(h=>h.target===u)).subscribe(()=>{("determinate"===this.mode||"buffer"===this.mode)&&this._ngZone.run(()=>this.animationEnd.next({value:this.value}))})})}ngOnDestroy(){this._animationEndSubscription.unsubscribe()}}return I.\u0275fac=function(u){return new(u||I)(y.Y36(y.SBq),y.Y36(y.R0b),y.Y36(W.Qb,8),y.Y36(An,8))},I.\u0275cmp=y.Xpm({type:I,selectors:[["mat-progress-bar"]],viewQuery:function(u,h){if(1&u&&y.Gf(tn,5),2&u){let g;y.iGM(g=y.CRH())&&(h._primaryValueBar=g.first)}},hostAttrs:["role","progressbar","aria-valuemin","0","aria-valuemax","100","tabindex","-1",1,"mat-progress-bar"],hostVars:4,hostBindings:function(u,h){2&u&&(y.uIk("aria-valuenow","indeterminate"===h.mode||"query"===h.mode?null:h.value)("mode",h.mode),y.ekj("_mat-animation-noopable",h._isNoopAnimation))},inputs:{color:"color",mode:"mode",value:"value",bufferValue:"bufferValue"},outputs:{animationEnd:"animationEnd"},exportAs:["matProgressBar"],features:[y.qOj],decls:10,vars:4,consts:[["aria-hidden","true"],["width","100%","height","4","focusable","false",1,"mat-progress-bar-background","mat-progress-bar-element"],["x","4","y","0","width","8","height","4","patternUnits","userSpaceOnUse",3,"id"],["cx","2","cy","2","r","2"],["width","100%","height","100%"],[1,"mat-progress-bar-buffer","mat-progress-bar-element",3,"ngStyle"],[1,"mat-progress-bar-primary","mat-progress-bar-fill","mat-progress-bar-element",3,"ngStyle"],["primaryValueBar",""],[1,"mat-progress-bar-secondary","mat-progress-bar-fill","mat-progress-bar-element"]],template:function(u,h){1&u&&(y.TgZ(0,"div",0),y.O4$(),y.TgZ(1,"svg",1),y.TgZ(2,"defs"),y.TgZ(3,"pattern",2),y._UZ(4,"circle",3),y.qZA(),y.qZA(),y._UZ(5,"rect",4),y.qZA(),y.kcU(),y._UZ(6,"div",5),y._UZ(7,"div",6,7),y._UZ(9,"div",8),y.qZA()),2&u&&(y.xp6(3),y.Q6J("id",h.progressbarId),y.xp6(2),y.uIk("fill",h._rectangleFillValue),y.xp6(1),y.Q6J("ngStyle",h._bufferTransform()),y.xp6(1),y.Q6J("ngStyle",h._primaryTransform()))},directives:[E.PC],styles:['.mat-progress-bar{display:block;height:4px;overflow:hidden;position:relative;transition:opacity 250ms linear;width:100%}._mat-animation-noopable.mat-progress-bar{transition:none;animation:none}.mat-progress-bar .mat-progress-bar-element,.mat-progress-bar .mat-progress-bar-fill::after{height:100%;position:absolute;width:100%}.mat-progress-bar .mat-progress-bar-background{width:calc(100% + 10px)}.cdk-high-contrast-active .mat-progress-bar .mat-progress-bar-background{display:none}.mat-progress-bar .mat-progress-bar-buffer{transform-origin:top left;transition:transform 250ms ease}.cdk-high-contrast-active .mat-progress-bar .mat-progress-bar-buffer{border-top:solid 5px;opacity:.5}.mat-progress-bar .mat-progress-bar-secondary{display:none}.mat-progress-bar .mat-progress-bar-fill{animation:none;transform-origin:top left;transition:transform 250ms ease}.cdk-high-contrast-active .mat-progress-bar .mat-progress-bar-fill{border-top:solid 4px}.mat-progress-bar .mat-progress-bar-fill::after{animation:none;content:"";display:inline-block;left:0}.mat-progress-bar[dir=rtl],[dir=rtl] .mat-progress-bar{transform:rotateY(180deg)}.mat-progress-bar[mode=query]{transform:rotateZ(180deg)}.mat-progress-bar[mode=query][dir=rtl],[dir=rtl] .mat-progress-bar[mode=query]{transform:rotateZ(180deg) rotateY(180deg)}.mat-progress-bar[mode=indeterminate] .mat-progress-bar-fill,.mat-progress-bar[mode=query] .mat-progress-bar-fill{transition:none}.mat-progress-bar[mode=indeterminate] .mat-progress-bar-primary,.mat-progress-bar[mode=query] .mat-progress-bar-primary{-webkit-backface-visibility:hidden;backface-visibility:hidden;animation:mat-progress-bar-primary-indeterminate-translate 2000ms infinite linear;left:-145.166611%}.mat-progress-bar[mode=indeterminate] .mat-progress-bar-primary.mat-progress-bar-fill::after,.mat-progress-bar[mode=query] .mat-progress-bar-primary.mat-progress-bar-fill::after{-webkit-backface-visibility:hidden;backface-visibility:hidden;animation:mat-progress-bar-primary-indeterminate-scale 2000ms infinite linear}.mat-progress-bar[mode=indeterminate] .mat-progress-bar-secondary,.mat-progress-bar[mode=query] .mat-progress-bar-secondary{-webkit-backface-visibility:hidden;backface-visibility:hidden;animation:mat-progress-bar-secondary-indeterminate-translate 2000ms infinite linear;left:-54.888891%;display:block}.mat-progress-bar[mode=indeterminate] .mat-progress-bar-secondary.mat-progress-bar-fill::after,.mat-progress-bar[mode=query] .mat-progress-bar-secondary.mat-progress-bar-fill::after{-webkit-backface-visibility:hidden;backface-visibility:hidden;animation:mat-progress-bar-secondary-indeterminate-scale 2000ms infinite linear}.mat-progress-bar[mode=buffer] .mat-progress-bar-background{-webkit-backface-visibility:hidden;backface-visibility:hidden;animation:mat-progress-bar-background-scroll 250ms infinite linear;display:block}.mat-progress-bar._mat-animation-noopable .mat-progress-bar-fill,.mat-progress-bar._mat-animation-noopable .mat-progress-bar-fill::after,.mat-progress-bar._mat-animation-noopable .mat-progress-bar-buffer,.mat-progress-bar._mat-animation-noopable .mat-progress-bar-primary,.mat-progress-bar._mat-animation-noopable .mat-progress-bar-primary.mat-progress-bar-fill::after,.mat-progress-bar._mat-animation-noopable .mat-progress-bar-secondary,.mat-progress-bar._mat-animation-noopable .mat-progress-bar-secondary.mat-progress-bar-fill::after,.mat-progress-bar._mat-animation-noopable .mat-progress-bar-background{animation:none;transition-duration:1ms}@keyframes mat-progress-bar-primary-indeterminate-translate{0%{transform:translateX(0)}20%{animation-timing-function:cubic-bezier(0.5, 0, 0.701732, 0.495819);transform:translateX(0)}59.15%{animation-timing-function:cubic-bezier(0.302435, 0.381352, 0.55, 0.956352);transform:translateX(83.67142%)}100%{transform:translateX(200.611057%)}}@keyframes mat-progress-bar-primary-indeterminate-scale{0%{transform:scaleX(0.08)}36.65%{animation-timing-function:cubic-bezier(0.334731, 0.12482, 0.785844, 1);transform:scaleX(0.08)}69.15%{animation-timing-function:cubic-bezier(0.06, 0.11, 0.6, 1);transform:scaleX(0.661479)}100%{transform:scaleX(0.08)}}@keyframes mat-progress-bar-secondary-indeterminate-translate{0%{animation-timing-function:cubic-bezier(0.15, 0, 0.515058, 0.409685);transform:translateX(0)}25%{animation-timing-function:cubic-bezier(0.31033, 0.284058, 0.8, 0.733712);transform:translateX(37.651913%)}48.35%{animation-timing-function:cubic-bezier(0.4, 0.627035, 0.6, 0.902026);transform:translateX(84.386165%)}100%{transform:translateX(160.277782%)}}@keyframes mat-progress-bar-secondary-indeterminate-scale{0%{animation-timing-function:cubic-bezier(0.15, 0, 0.515058, 0.409685);transform:scaleX(0.08)}19.15%{animation-timing-function:cubic-bezier(0.31033, 0.284058, 0.8, 0.733712);transform:scaleX(0.457104)}44.15%{animation-timing-function:cubic-bezier(0.4, 0.627035, 0.6, 0.902026);transform:scaleX(0.72796)}100%{transform:scaleX(0.08)}}@keyframes mat-progress-bar-background-scroll{to{transform:translateX(-8px)}}\n'],encapsulation:2,changeDetection:0}),I})();function Qe(I,_=0,u=100){return Math.max(_,Math.min(u,I))}let si=(()=>{class I{}return I.\u0275fac=function(u){return new(u||I)},I.\u0275mod=y.oAB({type:I}),I.\u0275inj=y.cJS({imports:[[E.ez,it.BQ],it.BQ]}),I})();var Mt=A(1095);const oi=["popUp"];let ai=(()=>{class I{constructor(u,h,g,v,T,S){this._popState=u,this._render=h,this._authService=g,this._userService=v,this._spinnerService=T,this._overlayConfig=S,this.start=0,this.timer=0}ngOnInit(){this.dataUser=this._userService.getUserLoggedIn(),this.resumeTimeOut()}signOut(){this._popState.statePopLogin(!1),this._spinnerService.setStateBehaviorSpinner(!0),this._authService.logout(),this._spinnerService.setStateBehaviorSpinner(!1),this._overlayConfig.closeOverlay()}stopTimer(){window.setTimeout(()=>{this.componentRef.destroy()})}pauseTimeout(){window.clearInterval(this.timer)}resumeTimeOut(){this.timer=window.setInterval(()=>{if(!(this.start<100))return this.pauseTimeout(),void this._overlayConfig.closeOverlay();this.start+=10},500)}}return I.\u0275fac=function(u){return new(u||I)(y.Y36(Xt),y.Y36(y.Qsj),y.Y36(xn.e),y.Y36(C.K),y.Y36(en.V),y.Y36(St))},I.\u0275cmp=y.Xpm({type:I,selectors:[["elix-pop-up-login"]],viewQuery:function(u,h){if(1&u&&y.Gf(oi,5),2&u){let g;y.iGM(g=y.CRH())&&(h.popUp=g.first)}},inputs:{componentRef:"componentRef"},decls:11,vars:2,consts:[[1,"border-2","rounded-2xl","text-white","w-44","elix__border-color","border-solid",3,"mouseenter","mouseleave"],["popUp",""],[1,"truncate"],["mode","determinate",3,"value"],[1,"flex","justify-center"],["mat-flat-button","",3,"click"]],template:function(u,h){1&u&&(y.TgZ(0,"div",0,1),y.NdJ("mouseenter",function(){return h.pauseTimeout()})("mouseleave",function(){return h.resumeTimeOut()}),y.TgZ(2,"div"),y.TgZ(3,"div"),y.TgZ(4,"p",2),y._uU(5),y.qZA(),y.qZA(),y.TgZ(6,"div"),y._UZ(7,"mat-progress-bar",3),y.qZA(),y.TgZ(8,"div",4),y.TgZ(9,"button",5),y.NdJ("click",function(){return h.signOut()}),y._uU(10,"Sign Out"),y.qZA(),y.qZA(),y.qZA(),y.qZA()),2&u&&(y.xp6(5),y.hij("",h.dataUser.email||h.dataUser.user.email," "),y.xp6(2),y.Q6J("value",h.start))},directives:[Ot,Mt.lW],styles:[".elix__border-color[_ngcontent-%COMP%]{border-color:#1ea7fd;box-shadow:2px 1px 8px #00f,-8px 0 8px;position:absolute;z-index:100000000;height:-webkit-min-content;height:min-content}h1[_ngcontent-%COMP%]{margin:0;padding:1em}"]}),I})(),Ji=(()=>{class I{constructor(u){this._overlayRef=u}close(){this._overlayRef.dispose(),this._overlayRef.detach()}}return I.\u0275fac=function(u){return new(u||I)(y.LFG(nt.Iu))},I.\u0275prov=y.Yz7({token:I,factory:I.\u0275fac,providedIn:"root"}),I})();const de={hasBackdrop:!0,backdropClass:"dark-backdrop",panelClass:"elixir-dialog-panel"};let St=(()=>{class I{constructor(u){this._overlay=u}open(u,h={}){const g=Object.assign(Object.assign({},de),h);return this.overlayRef=this.createOverlay(g,u),this.dialogRef=new Ji(this.overlayRef),this.filePortal=new Jt.C5(ai),this.overlayRef.attach(this.filePortal),this.overlayRef.backdropClick().subscribe(v=>this.dialogRef.close()),this.overlayRef}closeOverlay(){this.dialogRef.close()}createOverlay(u,h){const g=this.getOverlayConfig(u,h);return this._overlay.create(g)}getOverlayConfig(u,h){const g=this._overlay.position().global().left(h.clientX-176+"px").top(h.clientY+3+"px");return new nt.X_({hasBackdrop:u.hasBackdrop,backdropClass:u.backdropClass,panelClass:u.panelClass,scrollStrategy:this._overlay.scrollStrategies.block(),positionStrategy:g})}}return I.\u0275fac=function(u){return new(u||I)(y.LFG(nt.aV))},I.\u0275prov=y.Yz7({token:I,factory:I.\u0275fac,providedIn:"root"}),I})();var fe=A(531);let rt=(()=>{class I{constructor(u,h){this._elementRef=u,this._renderer=h,this.defaultColor="transparent",this.resizableGrabWidth=8,this.resizableMinWidth=10,this.dragging=!1;const S=Z=>{const xe=Math.max(this.resizableMinWidth,Z);u.nativeElement.style.width=xe+"px"};document.addEventListener("mousemove",Z=>{!this.dragging||(S(Z.clientX+u.nativeElement.offsetLeft),Z.stopPropagation())},!0),document.addEventListener("mouseup",Z=>{!this.dragging||(document.body.style.pointerEvents="auto",this.dragging=!1,Z.stopPropagation())},!0),u.nativeElement.addEventListener("mousedown",Z=>{this.inDragRegion(Z)&&(this.dragging=!0,document.body.style.pointerEvents="none",Z.stopPropagation())},!0),u.nativeElement.addEventListener("mousemove",Z=>{u.nativeElement.style.cursor=this.inDragRegion(Z)||this.dragging?"col-resize":"default"},!0)}ngOnInit(){}inDragRegion(u){return this._elementRef.nativeElement.clientWidth-u.clientX+this._elementRef.nativeElement.offsetLeft<this.resizableGrabWidth}}return I.\u0275fac=function(u){return new(u||I)(y.Y36(y.SBq),y.Y36(y.Qsj))},I.\u0275dir=y.lG2({type:I,selectors:[["","elixElixDrag",""]],inputs:{defaultColor:"defaultColor",resizableGrabWidth:"resizableGrabWidth",resizableMinWidth:"resizableMinWidth"}}),I})();var ci=A(6627),Dt=A(3679),ht=A(9238);let Ft=0;const li=(0,it.Id)(class{});let Ut=(()=>{class I extends li{constructor(u,h,g,v,T){super(),this._ngZone=u,this._elementRef=h,this._ariaDescriber=g,this._renderer=v,this._animationMode=T,this._hasContent=!1,this._color="primary",this._overlap=!0,this.position="above after",this.size="medium",this._id=Ft++}get color(){return this._color}set color(u){this._setColor(u),this._color=u}get overlap(){return this._overlap}set overlap(u){this._overlap=(0,Ye.Ig)(u)}get description(){return this._description}set description(u){if(u!==this._description){const h=this._badgeElement;this._updateHostAriaDescription(u,this._description),this._description=u,h&&(u?h.setAttribute("aria-label",u):h.removeAttribute("aria-label"))}}get hidden(){return this._hidden}set hidden(u){this._hidden=(0,Ye.Ig)(u)}isAbove(){return-1===this.position.indexOf("below")}isAfter(){return-1===this.position.indexOf("before")}ngOnChanges(u){const h=u.content;if(h){const g=h.currentValue;this._hasContent=null!=g&&`${g}`.trim().length>0,this._updateTextContent()}}ngOnDestroy(){const u=this._badgeElement;u&&(this.description&&this._ariaDescriber.removeDescription(u,this.description),this._renderer.destroyNode&&this._renderer.destroyNode(u))}getBadgeElement(){return this._badgeElement}_updateTextContent(){return this._badgeElement?this._badgeElement.textContent=this._stringifyContent():this._badgeElement=this._createBadgeElement(),this._badgeElement}_createBadgeElement(){const u=this._renderer.createElement("span"),h="mat-badge-active",g="mat-badge-content";return this._clearExistingBadges(g),u.setAttribute("id",`mat-badge-content-${this._id}`),u.classList.add(g),u.textContent=this._stringifyContent(),"NoopAnimations"===this._animationMode&&u.classList.add("_mat-animation-noopable"),this.description&&u.setAttribute("aria-label",this.description),this._elementRef.nativeElement.appendChild(u),"function"==typeof requestAnimationFrame&&"NoopAnimations"!==this._animationMode?this._ngZone.runOutsideAngular(()=>{requestAnimationFrame(()=>{u.classList.add(h)})}):u.classList.add(h),u}_updateHostAriaDescription(u,h){const g=this._updateTextContent();h&&this._ariaDescriber.removeDescription(g,h),u&&this._ariaDescriber.describe(g,u)}_setColor(u){if(u!==this._color){const h=this._elementRef.nativeElement.classList;this._color&&h.remove(`mat-badge-${this._color}`),u&&h.add(`mat-badge-${u}`)}}_clearExistingBadges(u){const h=this._elementRef.nativeElement;let g=h.children.length;for(;g--;){const v=h.children[g];v.classList.contains(u)&&h.removeChild(v)}}_stringifyContent(){const u=this.content;return null==u?"":`${u}`}}return I.\u0275fac=function(u){return new(u||I)(y.Y36(y.R0b),y.Y36(y.SBq),y.Y36(ht.$s),y.Y36(y.Qsj),y.Y36(W.Qb,8))},I.\u0275dir=y.lG2({type:I,selectors:[["","matBadge",""]],hostAttrs:[1,"mat-badge"],hostVars:20,hostBindings:function(u,h){2&u&&y.ekj("mat-badge-overlap",h.overlap)("mat-badge-above",h.isAbove())("mat-badge-below",!h.isAbove())("mat-badge-before",!h.isAfter())("mat-badge-after",h.isAfter())("mat-badge-small","small"===h.size)("mat-badge-medium","medium"===h.size)("mat-badge-large","large"===h.size)("mat-badge-hidden",h.hidden||!h._hasContent)("mat-badge-disabled",h.disabled)},inputs:{disabled:["matBadgeDisabled","disabled"],position:["matBadgePosition","position"],size:["matBadgeSize","size"],color:["matBadgeColor","color"],overlap:["matBadgeOverlap","overlap"],description:["matBadgeDescription","description"],hidden:["matBadgeHidden","hidden"],content:["matBadge","content"]},features:[y.qOj,y.TTD]}),I})(),mt=(()=>{class I{}return I.\u0275fac=function(u){return new(u||I)},I.\u0275mod=y.oAB({type:I}),I.\u0275inj=y.cJS({imports:[[ht.rt,it.BQ],it.BQ]}),I})();const Vt=["pointIcon"],Rn=["notification"],De=function(I){return[I]};function ui(I,_){if(1&I&&(y.TgZ(0,"div",17),y.TgZ(1,"a",7),y._uU(2),y.qZA(),y.qZA()),2&I){const u=_.$implicit,h=y.oxw();y.xp6(1),y.Q6J("routerLink",y.VKq(3,De,u.path))("ngClass","colorIcon-"+h.color),y.xp6(1),y.Oqu(u.name)}}const Re=function(){return["account/pull_request"]};let xt=(()=>{class I{constructor(u,h,g,v,T,S){this._firebaseTry=u,this._popUpState=h,this._overlayPopUpService=g,this._router=v,this._timer=T,this._overlayAll=S,this.inputValue="",this.color="transparent",this.onSayHello=new y.vpe,this.background="transparent",this.routerData=[],this._firebaseTry.setUrl("/repository")}ngOnInit(){this._timer.counterData$.subscribe(u=>this.number=u.length),this._firebaseTry.data.snapshotChanges().pipe((0,Q.U)(u=>u.map(h=>{let g=h.payload.doc.data();return{key:h.payload.doc.id,value:g[Object.keys(g)[0]]}}))).subscribe(u=>console.log(u)),this.routerData=this._router.snapshot.data.data}resizeData(u,h){this.inputValue=h?" ":""}retriveCoordinates(u){this.onSayHello.emit(u),this._popUpState.statePopLogin(!0),this._overlayPopUpService.open(u)}openBadge(){this._overlayAll.display(this.notification,ut)}}return I.\u0275fac=function(u){return new(u||I)(y.Y36(Wt.M),y.Y36(Xt),y.Y36(St),y.Y36(he.gz),y.Y36(re.f),y.Y36(fe.F))},I.\u0275cmp=y.Xpm({type:I,selectors:[["elix-header"]],viewQuery:function(u,h){if(1&u&&(y.Gf(Vt,5),y.Gf(Rn,5)),2&u){let g;y.iGM(g=y.CRH())&&(h.pointIcon=g.first),y.iGM(g=y.CRH())&&(h.notification=g.first)}},inputs:{inputValue:"inputValue",name:"name",color:"color",background:"background"},outputs:{onSayHello:"onSayHello"},decls:21,vars:17,consts:[[1,"bg-blue-700","sticky","iufce__top",3,"ngClass"],["elixElixDrag","",1,"flex","pl-8","justify-center","items-center","h-16"],[1,"w-8","h-8","mr-4","cursor-pointer",3,"routerLink"],[1,"iufce__icon",3,"svgIcon","ngClass"],[1,"flex","flex-1","items-center"],["type","text",1,"w-1/6","h-7","text-black","pl-3","vorkurt__background-primary","text-white",3,"ngClass","ngModel","focus","ngModelChange","focusout"],[1,"ml-2"],["routerLinkActive","active",1,"text-white","vorkurt__text-size-secondary",3,"routerLink","ngClass"],["class","ml-2 vorkurt__router",4,"ngFor","ngForOf"],[1,"flex","pr-8"],[1,"w-5","h-5"],["notification",""],[3,"matBadge","click"],[1,"iufce__icon","cursor-pointer",3,"svgIcon","ngClass"],[1,"w-5","h-5","ml-2"],["pointIcon",""],[1,"iufce__icon","cursor-pointer",3,"svgIcon","ngClass","click"],[1,"ml-2","vorkurt__router"]],template:function(u,h){1&u&&(y.TgZ(0,"div",0),y.TgZ(1,"div",1),y.TgZ(2,"div",2),y._UZ(3,"mat-icon",3),y.qZA(),y.TgZ(4,"div",4),y.TgZ(5,"input",5),y.NdJ("focus",function(v){return h.resizeData(v,!0)})("ngModelChange",function(v){return h.inputValue=v})("focusout",function(v){return h.resizeData(v,!1)}),y.qZA(),y.TgZ(6,"div",6),y.TgZ(7,"a",7),y._uU(8,"Pull request"),y.qZA(),y.qZA(),y.YNc(9,ui,3,5,"div",8),y.qZA(),y.TgZ(10,"div",9),y.TgZ(11,"div",10,11),y.TgZ(13,"button",12),y.NdJ("click",function(){return h.openBadge()}),y._UZ(14,"mat-icon",13),y.qZA(),y.qZA(),y.TgZ(15,"div",14),y._UZ(16,"mat-icon",13),y.qZA(),y.TgZ(17,"div",14,15),y.TgZ(19,"mat-icon",16),y.NdJ("click",function(v){return h.retriveCoordinates(v)}),y.qZA(),y.qZA(),y.qZA(),y.qZA(),y.qZA(),y._UZ(20,"router-outlet")),2&u&&(y.Q6J("ngClass"," vorkurt__background-thrid iufce__parrent-header background-"+h.background),y.xp6(2),y.Q6J("routerLink","account"),y.xp6(1),y.Q6J("svgIcon","fa_brands:github")("ngClass","colorIcon-"+h.color),y.xp6(2),y.Q6J("ngClass",h.inputValue?"iufce__expand-input":"")("ngModel",h.inputValue),y.xp6(2),y.Q6J("routerLink",y.DdM(16,Re))("ngClass","colorIcon-"+h.color),y.xp6(2),y.Q6J("ngForOf",h.routerData),y.xp6(4),y.Q6J("matBadge",0===h.number?"":h.number),y.xp6(1),y.Q6J("svgIcon","fa_solid:bell")("ngClass","colorIcon-"+h.color),y.xp6(2),y.Q6J("svgIcon","fa_solid:plus")("ngClass","colorIcon-"+h.color),y.xp6(3),y.Q6J("svgIcon","fa_solid:user-circle")("ngClass","colorIcon-"+h.color))},directives:[E.mk,rt,he.rH,ci.Hw,Dt.Fj,Dt.JJ,Dt.On,he.yS,he.Od,E.sg,Ut,he.lC],styles:[".iufce__icon[_ngcontent-%COMP%]{color:#cdd9e5;height:inherit;width:inherit}.iufce__top[_ngcontent-%COMP%]{top:0px}.iufce__expand-input[_ngcontent-%COMP%]{width:32.75rem;transition:all .5s ease-in-out}.iufce__parrent-header.background-dark[_ngcontent-%COMP%]{background:#8F8F8F}.iufce__parrent-header.background-transparent[_ngcontent-%COMP%]{background:#2d333b}.iufce__parrent-header.background-light[_ngcontent-%COMP%]{background:#F6F6F6}.colorIcon-dark[_ngcontent-%COMP%]{color:#d9e5ff}.colorIcon-transparent[_ngcontent-%COMP%]{color:#92a2bd}.colorIcon-light[_ngcontent-%COMP%]{color:#8f8f8f}.active[_ngcontent-%COMP%]{border:1px solid;border-radius:5px}"],data:{animation:[(0,$.X$)("openClose",[(0,$.SB)("open",(0,$.oB)({height:"200px",opacity:1,backgroundColor:"yellow"})),(0,$.SB)("closed",(0,$.oB)({height:"100px",opacity:.8,backgroundColor:"#c6ecff"})),(0,$.eR)("open => closed",[(0,$.jt)("1s")]),(0,$.eR)("closed => open",[(0,$.jt)("0.5s")])])]}}),I})();var Pn=A(5704),nn=A(2801);const hi=[{path:"",redirectTo:"account",pathMatch:"full"},{path:"",component:xt,children:[{path:"account",loadChildren:()=>Promise.all([A.e(295),A.e(592),A.e(690)]).then(A.bind(A,4690)).then(I=>I.AccountModule)},{path:"new",loadChildren:()=>Promise.all([A.e(295),A.e(983),A.e(133)]).then(A.bind(A,6133)).then(I=>I.NewRepoModule)},{path:"timer",loadChildren:()=>Promise.all([A.e(295),A.e(983),A.e(342)]).then(A.bind(A,7342)).then(I=>I.TimerModule)},{path:":id",canActivate:[Pn.e],loadChildren:()=>Promise.all([A.e(592),A.e(864)]).then(A.bind(A,4864)).then(I=>I.RepositoryModule)},{path:"**",component:nn.r}]}];let rn=(()=>{class I{}return I.\u0275fac=function(u){return new(u||I)},I.\u0275mod=y.oAB({type:I}),I.\u0275inj=y.cJS({imports:[[he.Bz.forChild(hi)],he.Bz]}),I})();var Nn=A(3461),sn=A(4466),on=A(1386);A(6461),A(5072),A(521),A(6782),A(5257),A(946);const On={provide:new y.OlP("mat-tooltip-scroll-strategy"),deps:[nt.aV],useFactory:function(I){return()=>I.scrollStrategies.reposition({scrollThrottle:20})}};let is=(()=>{class I{}return I.\u0275fac=function(u){return new(u||I)},I.\u0275mod=y.oAB({type:I}),I.\u0275inj=y.cJS({providers:[On],imports:[[ht.rt,E.ez,nt.U8,it.BQ],it.BQ,on.ZD]}),I})(),qt=(()=>{class I{}return I.\u0275fac=function(u){return new(u||I)},I.\u0275mod=y.oAB({type:I}),I.\u0275inj=y.cJS({imports:[[nt.U8,ci.Ps,Dt.u5,E.ez,rn,Nn._t,sn.m,Mt.ot,is,si,mt]]}),I})()},8753:(Xi,lt,A)=>{A.d(lt,{w:()=>Me});var E=A(7716),he=A(8583);function y(we,ve){1&we&&(E.TgZ(0,"div",3),E.TgZ(1,"div",4),E.TgZ(2,"div",5),E.TgZ(3,"h1"),E._uU(4,"TItle"),E.qZA(),E.qZA(),E.TgZ(5,"div"),E._uU(6," Action "),E.qZA(),E.qZA(),E.TgZ(7,"div"),E.Hsn(8),E.qZA(),E._UZ(9,"div"),E.TgZ(10,"footer"),E.TgZ(11,"div",6),E.TgZ(12,"div",7),E.TgZ(13,"div"),E._uU(14,"language"),E.qZA(),E.TgZ(15,"div"),E._uU(16," star"),E.qZA(),E.TgZ(17,"div"),E._uU(18,"Update date"),E.qZA(),E.qZA(),E.qZA(),E.qZA(),E.qZA())}function $(we,ve){1&we&&(E.TgZ(0,"div",8),E.TgZ(1,"div"),E.Hsn(2,1),E.qZA(),E.qZA())}const Q=[[["","post",""]],"*"],re=["[post]","*"];let Me=(()=>{class we{constructor(){}ngOnInit(){}}return we.\u0275fac=function(ut){return new(ut||we)},we.\u0275cmp=E.Xpm({type:we,selectors:[["elix-jumbotron"]],inputs:{closeAction:"closeAction",title:"title",action:"action",type:"type"},ngContentSelectors:re,decls:3,vars:2,consts:[[1,"vorkurt__color-background","border-2","elix__shared-border-color","border-solid","rounded-lg","mr-2","ml-2"],["class","pl-2 pr-2",4,"ngIf"],["class","w-96 pl-2 pr-2",4,"ngIf"],[1,"pl-2","pr-2"],[1,"flex"],[1,"flex-1"],[1,"w-72"],[1,"flex","justify-between"],[1,"w-96","pl-2","pr-2"]],template:function(ut,Wt){1&ut&&(E.F$t(Q),E.TgZ(0,"div",0),E.YNc(1,y,19,0,"div",1),E.YNc(2,$,3,0,"div",2),E.qZA()),2&ut&&(E.xp6(1),E.Q6J("ngIf","post"===Wt.type),E.xp6(1),E.Q6J("ngIf","template"===Wt.type))},directives:[he.O5],styles:[".elix__shared-border-color[_ngcontent-%COMP%]{border-color:#444c56;width:100%}"]}),we})()},281:(Xi,lt,A)=>{A.d(lt,{M:()=>py});var E=A(7716),he=A(3637),y=A(7574),$=A(4402),Q=A(5917),re=A(9126),Me=A(9761),we=A(9328),ve=A(8002),ut=A(2145),Wt=A(7519),se=A(5435),gt=A(9746),Xt=A(8939),nt=A(8583),xn=(A(9083),A(4486)),C=A(8239),en=A(5452),it=A(6034),Ye=A(300),W=A(4685),Lt=function(s,i){return(Lt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var a in o)Object.prototype.hasOwnProperty.call(o,a)&&(r[a]=o[a])})(s,i)};function Cn(s){var i="function"==typeof Symbol&&Symbol.iterator,r=i&&s[i],o=0;if(r)return r.call(s);if(s&&"number"==typeof s.length)return{next:function(){return s&&o>=s.length&&(s=void 0),{value:s&&s[o++],done:!s}}};throw new TypeError(i?"Object is not iterable.":"Symbol.iterator is not defined.")}var F,tn="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},An=An||{},j=tn||self;function It(){}function Ot(s){var i=typeof s;return"array"==(i="object"!=i?i:s?Array.isArray(s)?"array":i:"null")||"object"==i&&"number"==typeof s.length}function Qe(s){var i=typeof s;return"object"==i&&null!=s||"function"==i}var Mt="closure_uid_"+(1e9*Math.random()>>>0),oi=0;function ai(s,i,r){return s.call.apply(s.bind,arguments)}function Ji(s,i,r){if(!s)throw Error();if(2<arguments.length){var o=Array.prototype.slice.call(arguments,2);return function(){var a=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(a,o),s.apply(i,a)}}return function(){return s.apply(i,arguments)}}function de(s,i,r){return(de=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?ai:Ji).apply(null,arguments)}function St(s,i){var r=Array.prototype.slice.call(arguments,1);return function(){var o=r.slice();return o.push.apply(o,arguments),s.apply(this,o)}}function fe(s,i){function r(){}r.prototype=i.prototype,s.Z=i.prototype,s.prototype=new r,s.prototype.constructor=s,s.Vb=function(o,a,c){for(var l=Array(arguments.length-2),d=2;d<arguments.length;d++)l[d-2]=arguments[d];return i.prototype[a].apply(o,l)}}function rt(){this.s=this.s,this.o=this.o}var Dt={};rt.prototype.s=!1,rt.prototype.na=function(){if(!this.s&&(this.s=!0,this.M(),0)){var s=function(s){return Object.prototype.hasOwnProperty.call(s,Mt)&&s[Mt]||(s[Mt]=++oi)}(this);delete Dt[s]}},rt.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};var ht=Array.prototype.indexOf?function(s,i){return Array.prototype.indexOf.call(s,i,void 0)}:function(s,i){if("string"==typeof s)return"string"!=typeof i||1!=i.length?-1:s.indexOf(i,0);for(var r=0;r<s.length;r++)if(r in s&&s[r]===i)return r;return-1},Ft=Array.prototype.forEach?function(s,i,r){Array.prototype.forEach.call(s,i,r)}:function(s,i,r){for(var o=s.length,a="string"==typeof s?s.split(""):s,c=0;c<o;c++)c in a&&i.call(r,a[c],c,s)};function Ut(s){return Array.prototype.concat.apply([],arguments)}function mt(s){var i=s.length;if(0<i){for(var r=Array(i),o=0;o<i;o++)r[o]=s[o];return r}return[]}function Vt(s){return/^[\s\xa0]*$/.test(s)}var Re,Rn=String.prototype.trim?function(s){return s.trim()}:function(s){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(s)[1]};function De(s,i){return-1!=s.indexOf(i)}function ui(s,i){return s<i?-1:s>i?1:0}e:{var xt=j.navigator;if(xt){var Pn=xt.userAgent;if(Pn){Re=Pn;break e}}Re=""}function nn(s,i,r){for(var o in s)i.call(r,s[o],o,s)}function hi(s){var i={};for(var r in s)i[r]=s[r];return i}var rn="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Nn(s,i){for(var r,o,a=1;a<arguments.length;a++){for(r in o=arguments[a])s[r]=o[r];for(var c=0;c<rn.length;c++)r=rn[c],Object.prototype.hasOwnProperty.call(o,r)&&(s[r]=o[r])}}function sn(s){return sn[" "](s),s}sn[" "]=It;var Ct,s,kn=De(Re,"Opera"),yt=De(Re,"Trident")||De(Re,"MSIE"),vt=De(Re,"Edge"),We=vt||yt,di=De(Re,"Gecko")&&!(De(Re.toLowerCase(),"webkit")&&!De(Re,"Edge"))&&!(De(Re,"Trident")||De(Re,"MSIE"))&&!De(Re,"Edge"),an=De(Re.toLowerCase(),"webkit")&&!De(Re,"Edge");function cn(){var s=j.document;return s?s.documentMode:void 0}e:{var er="",Bt=(s=Re,di?/rv:([^\);]+)(\)|;)/.exec(s):vt?/Edge\/([\d\.]+)/.exec(s):yt?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(s):an?/WebKit\/(\S+)/.exec(s):kn?/(?:Version)[ \/]?(\S+)/.exec(s):void 0);if(Bt&&(er=Bt?Bt[1]:""),yt){var Ln=cn();if(null!=Ln&&Ln>parseFloat(er)){Ct=String(Ln);break e}}Ct=er}var tr={};function nr(){return i=tr,Object.prototype.hasOwnProperty.call(i,9)?i[9]:i[9]=function(){for(var s=0,i=Rn(String(Ct)).split("."),r=Rn("9").split("."),o=Math.max(i.length,r.length),a=0;0==s&&a<o;a++){var c=i[a]||"",l=r[a]||"";do{if(c=/(\d*)(\D*)(.*)/.exec(c)||["","","",""],l=/(\d*)(\D*)(.*)/.exec(l)||["","","",""],0==c[0].length&&0==l[0].length)break;s=ui(0==c[1].length?0:parseInt(c[1],10),0==l[1].length?0:parseInt(l[1],10))||ui(0==c[2].length,0==l[2].length)||ui(c[2],l[2]),c=c[3],l=l[3]}while(0==s)}return 0<=s}();var i}var On=j.document&&yt&&(cn()||parseInt(Ct,10))||void 0,ns=function(){if(!j.addEventListener||!Object.defineProperty)return!1;var s=!1,i=Object.defineProperty({},"passive",{get:function(){s=!0}});try{j.addEventListener("test",It,i),j.removeEventListener("test",It,i)}catch(r){}return s}();function _e(s,i){this.type=s,this.g=this.target=i,this.defaultPrevented=!1}function un(s,i){if(_e.call(this,s?s.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,s){var r=this.type=s.type,o=s.changedTouches&&s.changedTouches.length?s.changedTouches[0]:null;if(this.target=s.target||s.srcElement,this.g=i,i=s.relatedTarget){if(di){e:{try{sn(i.nodeName);var a=!0;break e}catch(c){}a=!1}a||(i=null)}}else"mouseover"==r?i=s.fromElement:"mouseout"==r&&(i=s.toElement);this.relatedTarget=i,o?(this.clientX=void 0!==o.clientX?o.clientX:o.pageX,this.clientY=void 0!==o.clientY?o.clientY:o.pageY,this.screenX=o.screenX||0,this.screenY=o.screenY||0):(this.clientX=void 0!==s.clientX?s.clientX:s.pageX,this.clientY=void 0!==s.clientY?s.clientY:s.pageY,this.screenX=s.screenX||0,this.screenY=s.screenY||0),this.button=s.button,this.key=s.key||"",this.ctrlKey=s.ctrlKey,this.altKey=s.altKey,this.shiftKey=s.shiftKey,this.metaKey=s.metaKey,this.pointerId=s.pointerId||0,this.pointerType="string"==typeof s.pointerType?s.pointerType:rr[s.pointerType]||"",this.state=s.state,this.i=s,s.defaultPrevented&&un.Z.h.call(this)}}_e.prototype.h=function(){this.defaultPrevented=!0},fe(un,_e);var rr={2:"touch",3:"pen",4:"mouse"};un.prototype.h=function(){un.Z.h.call(this);var s=this.i;s.preventDefault?s.preventDefault():s.returnValue=!1};var hn="closure_listenable_"+(1e6*Math.random()|0),sr=0;function is(s,i,r,o,a){this.listener=s,this.proxy=null,this.src=i,this.type=r,this.capture=!!o,this.ia=a,this.key=++sr,this.ca=this.fa=!1}function qt(s){s.ca=!0,s.listener=null,s.proxy=null,s.src=null,s.ia=null}function I(s){this.src=s,this.g={},this.h=0}function _(s,i){var r=i.type;if(r in s.g){var c,o=s.g[r],a=ht(o,i);(c=0<=a)&&Array.prototype.splice.call(o,a,1),c&&(qt(i),0==s.g[r].length&&(delete s.g[r],s.h--))}}function u(s,i,r,o){for(var a=0;a<s.length;++a){var c=s[a];if(!c.ca&&c.listener==i&&c.capture==!!r&&c.ia==o)return a}return-1}I.prototype.add=function(s,i,r,o,a){var c=s.toString();(s=this.g[c])||(s=this.g[c]=[],this.h++);var l=u(s,i,o,a);return-1<l?(i=s[l],r||(i.fa=!1)):((i=new is(i,this.src,c,!!o,a)).fa=r,s.push(i)),i};var h="closure_lm_"+(1e6*Math.random()|0),g={};function v(s,i,r,o,a){if(o&&o.once)return R(s,i,r,o,a);if(Array.isArray(i)){for(var c=0;c<i.length;c++)v(s,i[c],r,o,a);return null}return r=_t(r),s&&s[hn]?s.N(i,r,Qe(o)?!!o.capture:!!o,a):T(s,i,r,!1,o,a)}function T(s,i,r,o,a,c){if(!i)throw Error("Invalid event type");var l=Qe(a)?!!a.capture:!!a,d=xe(s);if(d||(s[h]=d=new I(s)),(r=d.add(i,r,o,l,c)).proxy)return r;if(o=function(){var i=Z;return function s(r){return i.call(s.src,s.listener,r)}}(),r.proxy=o,o.src=s,o.listener=r,s.addEventListener)ns||(a=l),void 0===a&&(a=!1),s.addEventListener(i.toString(),o,a);else if(s.attachEvent)s.attachEvent(G(i.toString()),o);else{if(!s.addListener||!s.removeListener)throw Error("addEventListener and attachEvent are unavailable.");s.addListener(o)}return r}function R(s,i,r,o,a){if(Array.isArray(i)){for(var c=0;c<i.length;c++)R(s,i[c],r,o,a);return null}return r=_t(r),s&&s[hn]?s.O(i,r,Qe(o)?!!o.capture:!!o,a):T(s,i,r,!0,o,a)}function U(s,i,r,o,a){if(Array.isArray(i))for(var c=0;c<i.length;c++)U(s,i[c],r,o,a);else o=Qe(o)?!!o.capture:!!o,r=_t(r),s&&s[hn]?(s=s.i,(i=String(i).toString())in s.g&&-1<(r=u(c=s.g[i],r,o,a))&&(qt(c[r]),Array.prototype.splice.call(c,r,1),0==c.length&&(delete s.g[i],s.h--))):s&&(s=xe(s))&&(i=s.g[i.toString()],s=-1,i&&(s=u(i,r,o,a)),(r=-1<s?i[s]:null)&&z(r))}function z(s){if("number"!=typeof s&&s&&!s.ca){var i=s.src;if(i&&i[hn])_(i.i,s);else{var r=s.type,o=s.proxy;i.removeEventListener?i.removeEventListener(r,o,s.capture):i.detachEvent?i.detachEvent(G(r),o):i.addListener&&i.removeListener&&i.removeListener(o),(r=xe(i))?(_(r,s),0==r.h&&(r.src=null,i[h]=null)):qt(s)}}}function G(s){return s in g?g[s]:g[s]="on"+s}function Z(s,i){if(s.ca)s=!0;else{i=new un(i,this);var r=s.listener,o=s.ia||s.src;s.fa&&z(s),s=r.call(o,i)}return s}function xe(s){return(s=s[h])instanceof I?s:null}var Xe="__closure_events_fn_"+(1e9*Math.random()>>>0);function _t(s){return"function"==typeof s?s:(s[Xe]||(s[Xe]=function(i){return s.handleEvent(i)}),s[Xe])}function oe(){rt.call(this),this.i=new I(this),this.P=this,this.I=null}function ne(s,i){var r,o=s.I;if(o)for(r=[];o;o=o.I)r.push(o);if(s=s.P,o=i.type||i,"string"==typeof i)i=new _e(i,s);else if(i instanceof _e)i.target=i.target||s;else{var a=i;Nn(i=new _e(o,s),a)}if(a=!0,r)for(var c=r.length-1;0<=c;c--){var l=i.g=r[c];a=fi(l,o,!0,i)&&a}if(a=fi(l=i.g=s,o,!0,i)&&a,a=fi(l,o,!1,i)&&a,r)for(c=0;c<r.length;c++)a=fi(l=i.g=r[c],o,!1,i)&&a}function fi(s,i,r,o){if(!(i=s.i.g[String(i)]))return!0;i=i.concat();for(var a=!0,c=0;c<i.length;++c){var l=i[c];if(l&&!l.ca&&l.capture==r){var d=l.listener,f=l.ia||l.src;l.fa&&_(s.i,l),a=!1!==d.call(f,o)&&a}}return a&&!o.defaultPrevented}fe(oe,rt),oe.prototype[hn]=!0,oe.prototype.removeEventListener=function(s,i,r,o){U(this,s,i,r,o)},oe.prototype.M=function(){if(oe.Z.M.call(this),this.i){var i,s=this.i;for(i in s.g){for(var r=s.g[i],o=0;o<r.length;o++)qt(r[o]);delete s.g[i],s.h--}}this.I=null},oe.prototype.N=function(s,i,r,o){return this.i.add(String(s),i,!1,r,o)},oe.prototype.O=function(s,i,r,o){return this.i.add(String(s),i,!0,r,o)};var pi=j.JSON.stringify;function or(){var s=qc,i=null;return s.g&&(i=s.g,s.g=s.g.next,s.g||(s.h=null),i.next=null),i}var uo,rs=function(){function s(){this.h=this.g=null}return s.prototype.add=function(i,r){var o=Bc.get();o.set(i,r),this.h?this.h.next=o:this.g=o,this.h=o},s}(),Bc=new(function(){function s(i,r){this.i=i,this.j=r,this.h=0,this.g=null}return s.prototype.get=function(){var i;return 0<this.h?(this.h--,this.g=(i=this.g).next,i.next=null):i=this.i(),i},s}())(function(){return new Bd},function(s){return s.reset()}),Bd=function(){function s(){this.next=this.g=this.h=null}return s.prototype.set=function(i,r){this.h=i,this.g=r,this.next=null},s.prototype.reset=function(){this.next=this.g=this.h=null},s}();function qd(s){j.setTimeout(function(){throw s},0)}function lo(s,i){uo||function(){var s=j.Promise.resolve(void 0);uo=function(){s.then(zd)}}(),ho||(uo(),ho=!0),qc.add(s,i)}var ho=!1,qc=new rs;function zd(){for(var s;s=or();){try{s.h.call(s.g)}catch(r){qd(r)}var i=Bc;i.j(s),100>i.h&&(i.h++,s.next=i.g,i.g=s)}ho=!1}function ss(s,i){oe.call(this),this.h=s||1,this.g=i||j,this.j=de(this.kb,this),this.l=Date.now()}function fo(s){s.da=!1,s.S&&(s.g.clearTimeout(s.S),s.S=null)}function po(s,i,r){if("function"==typeof s)r&&(s=de(s,r));else{if(!s||"function"!=typeof s.handleEvent)throw Error("Invalid listener argument");s=de(s.handleEvent,s)}return 2147483647<Number(i)?-1:j.setTimeout(s,i||0)}function Gc(s){s.g=po(function(){s.g=null,s.i&&(s.i=!1,Gc(s))},s.j);var i=s.h;s.h=null,s.m.apply(null,i)}fe(ss,oe),(F=ss.prototype).da=!1,F.S=null,F.kb=function(){if(this.da){var s=Date.now()-this.l;0<s&&s<.8*this.h?this.S=this.g.setTimeout(this.j,this.h-s):(this.S&&(this.g.clearTimeout(this.S),this.S=null),ne(this,"tick"),this.da&&(fo(this),this.start()))}},F.start=function(){this.da=!0,this.S||(this.S=this.g.setTimeout(this.j,this.h),this.l=Date.now())},F.M=function(){ss.Z.M.call(this),fo(this),delete this.g};var jd=function(s){function i(r,o){var a=s.call(this)||this;return a.m=r,a.j=o,a.h=null,a.i=!1,a.g=null,a}return function(s,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=s}Lt(s,i),s.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}(i,s),i.prototype.l=function(r){this.h=arguments,this.g?this.i=!0:Gc(this)},i.prototype.M=function(){s.prototype.M.call(this),this.g&&(j.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)},i}(rt);function ar(s){rt.call(this),this.h=s,this.g={}}fe(ar,rt);var zc=[];function jc(s,i,r,o){Array.isArray(r)||(r&&(zc[0]=r.toString()),r=zc);for(var a=0;a<r.length;a++){var c=v(i,r[a],o||s.handleEvent,!1,s.h||s);if(!c)break;s.g[c.key]=c}}function $c(s){nn(s.g,function(i,r){this.g.hasOwnProperty(r)&&z(i)},s),s.g={}}function os(){this.g=!0}function gi(s,i,r,o){s.info(function(){return"XMLHTTP TEXT ("+i+"): "+function(s,i){if(!s.g)return i;if(!i)return null;try{var r=JSON.parse(i);if(r)for(s=0;s<r.length;s++)if(Array.isArray(r[s])){var o=r[s];if(!(2>o.length)){var a=o[1];if(Array.isArray(a)&&!(1>a.length)){var c=a[0];if("noop"!=c&&"stop"!=c&&"close"!=c)for(var l=1;l<a.length;l++)a[l]=""}}}return pi(r)}catch(d){return i}}(s,r)+(o?" "+o:"")})}ar.prototype.M=function(){ar.Z.M.call(this),$c(this)},ar.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},os.prototype.Aa=function(){this.g=!1},os.prototype.info=function(){};var Mn={},Kc=null;function as(){return Kc=Kc||new oe}function Zc(s){_e.call(this,Mn.Ma,s)}function cr(s){var i=as();ne(i,new Zc(i,s))}function Hc(s,i){_e.call(this,Mn.STAT_EVENT,s),this.stat=i}function je(s){var i=as();ne(i,new Hc(i,s))}function Yc(s,i){_e.call(this,Mn.Na,s),this.size=i}function lr(s,i){if("function"!=typeof s)throw Error("Fn must not be null and must be a function");return j.setTimeout(function(){s()},i)}Mn.Ma="serverreachability",fe(Zc,_e),Mn.STAT_EVENT="statevent",fe(Hc,_e),Mn.Na="timingevent",fe(Yc,_e);var cs={NO_ERROR:0,lb:1,yb:2,xb:3,sb:4,wb:5,zb:6,Ja:7,TIMEOUT:8,Cb:9},Qc={qb:"complete",Mb:"success",Ka:"error",Ja:"abort",Eb:"ready",Fb:"readystatechange",TIMEOUT:"timeout",Ab:"incrementaldata",Db:"progress",tb:"downloadprogress",Ub:"uploadprogress"};function go(){}function Xc(){}go.prototype.h=null;var vo,ur={OPEN:"a",pb:"b",Ka:"c",Bb:"d"};function mo(){_e.call(this,"d")}function yo(){_e.call(this,"c")}function ls(){}function hr(s,i,r,o){this.l=s,this.j=i,this.m=r,this.X=o||1,this.V=new ar(this),this.P=Yd,this.W=new ss(s=We?125:void 0),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.Y=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.N=-1,this.I=!1,this.O=0,this.L=null,this.aa=this.J=this.$=this.U=!1,this.h=new Jc}function Jc(){this.i=null,this.g="",this.h=!1}fe(mo,_e),fe(yo,_e),fe(ls,go),ls.prototype.g=function(){return new XMLHttpRequest},ls.prototype.i=function(){return{}},vo=new ls;var Yd=45e3,_o={},us={};function wo(s,i,r){s.K=1,s.v=gs(Gt(i)),s.s=r,s.U=!0,el(s,null)}function el(s,i){s.F=Date.now(),dr(s),s.A=Gt(s.v);var r=s.A,o=s.X;Array.isArray(o)||(o=[String(o)]),ll(r.h,"t",o),s.C=0,r=s.l.H,s.h=new Jc,s.g=Nl(s.l,r?i:null,!s.s),0<s.O&&(s.L=new jd(de(s.Ia,s,s.g),s.O)),jc(s.V,s.g,"readystatechange",s.gb),i=s.H?hi(s.H):{},s.s?(s.u||(s.u="POST"),i["Content-Type"]="application/x-www-form-urlencoded",s.g.ea(s.A,s.u,s.s,i)):(s.u="GET",s.g.ea(s.A,s.u,null,i)),cr(1),function(s,i,r,o,a,c){s.info(function(){if(s.g)if(c)for(var l="",d=c.split("&"),f=0;f<d.length;f++){var m=d[f].split("=");if(1<m.length){var w=m[0];m=m[1];var b=w.split("_");l=2<=b.length&&"type"==b[1]?l+(w+"=")+m+"&":l+(w+"=redacted&")}}else l=null;else l=c;return"XMLHTTP REQ ("+o+") [attempt "+a+"]: "+i+"\n"+r+"\n"+l})}(s.j,s.u,s.A,s.m,s.X,s.s)}function tl(s){return!!s.g&&"GET"==s.u&&2!=s.K&&s.l.Ba}function nl(s,i,r){for(var a,o=!0;!s.I&&s.C<r.length;){if((a=Qd(s,r))==us){4==i&&(s.o=4,je(14),o=!1),gi(s.j,s.m,null,"[Incomplete Response]");break}if(a==_o){s.o=4,je(15),gi(s.j,s.m,r,"[Invalid Chunk]"),o=!1;break}gi(s.j,s.m,a,null),bo(s,a)}tl(s)&&a!=us&&a!=_o&&(s.h.g="",s.C=0),4!=i||0!=r.length||s.h.h||(s.o=1,je(16),o=!1),s.i=s.i&&o,o?0<r.length&&!s.aa&&(s.aa=!0,(i=s.l).g==s&&i.$&&!i.L&&(i.h.info("Great, no buffering proxy detected. Bytes received: "+r.length),No(i),i.L=!0,je(11))):(gi(s.j,s.m,r,"[Invalid Chunked Response]"),Fn(s),fr(s))}function Qd(s,i){var r=s.C,o=i.indexOf("\n",r);return-1==o?us:(r=Number(i.substring(r,o)),isNaN(r)?_o:(o+=1)+r>i.length?us:(i=i.substr(o,r),s.C=o+r,i))}function dr(s){s.Y=Date.now()+s.P,il(s,s.P)}function il(s,i){if(null!=s.B)throw Error("WatchDog timer not null");s.B=lr(de(s.eb,s),i)}function hs(s){s.B&&(j.clearTimeout(s.B),s.B=null)}function fr(s){0==s.l.G||s.I||Cl(s.l,s)}function Fn(s){hs(s);var i=s.L;i&&"function"==typeof i.na&&i.na(),s.L=null,fo(s.W),$c(s.V),s.g&&(i=s.g,s.g=null,i.abort(),i.na())}function bo(s,i){try{var r=s.l;if(0!=r.G&&(r.g==s||Io(r.i,s)))if(r.I=s.N,!s.J&&Io(r.i,s)&&3==r.G){try{var o=r.Ca.g.parse(i)}catch(H){o=null}if(Array.isArray(o)&&3==o.length){var a=o;if(0==a[0])e:if(r.u)r.ta=a[1],0<r.ta-r.U&&37500>a[2]&&r.N&&0==r.A&&!r.v&&(r.v=lr(de(r.ab,r),6e3));else{if(r.g){if(!(r.g.F+3e3<s.F))break e;bs(r),_s(r)}Po(r),je(18)}if(1>=dl(r.i)&&r.ka){try{r.ka()}catch(H){}r.ka=void 0}}else Bn(r,11)}else if((s.J||r.g==s)&&bs(r),!Vt(i))for(a=r.Ca.g.parse(i),i=0;i<a.length;i++){var c=a[i];if(r.U=c[0],c=c[1],2==r.G)if("c"==c[0]){r.J=c[1],r.la=c[2];var l=c[3];null!=l&&(r.ma=l,r.h.info("VER="+r.ma));var d=c[4];null!=d&&(r.za=d,r.h.info("SVER="+r.za));var f=c[5];null!=f&&"number"==typeof f&&0<f&&(r.K=o=1.5*f,r.h.info("backChannelRequestTimeoutMs_="+o)),o=r;var m=s.g;if(m){var w=m.g?m.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(w){var b=o.i;!b.g&&(De(w,"spdy")||De(w,"quic")||De(w,"h2"))&&(b.j=b.l,b.g=new Set,b.h&&(So(b,b.h),b.h=null))}if(o.D){var x=m.g?m.g.getResponseHeader("X-HTTP-Session-Id"):null;x&&(o.sa=x,le(o.F,o.D,x))}}r.G=3,r.j&&r.j.xa(),r.$&&(r.O=Date.now()-s.F,r.h.info("Handshake RTT: "+r.O+"ms"));var P=s;if((o=r).oa=Pl(o,o.H?o.la:null,o.W),P.J){fl(o.i,P);var O=P,q=o.K;q&&O.setTimeout(q),O.B&&(hs(O),dr(O)),o.g=P}else Dl(o);0<r.l.length&&ws(r)}else"stop"!=c[0]&&"close"!=c[0]||Bn(r,7);else 3==r.G&&("stop"==c[0]||"close"==c[0]?"stop"==c[0]?Bn(r,7):Ao(r):"noop"!=c[0]&&r.j&&r.j.wa(c),r.A=0)}cr(4)}catch(H){}}function To(s,i){if(s.forEach&&"function"==typeof s.forEach)s.forEach(i,void 0);else if(Ot(s)||"string"==typeof s)Ft(s,i,void 0);else{if(s.T&&"function"==typeof s.T)var r=s.T();else if(s.R&&"function"==typeof s.R)r=void 0;else if(Ot(s)||"string"==typeof s){r=[];for(var o=s.length,a=0;a<o;a++)r.push(a)}else for(a in r=[],o=0,s)r[o++]=a;a=(o=function(s){if(s.R&&"function"==typeof s.R)return s.R();if("string"==typeof s)return s.split("");if(Ot(s)){for(var i=[],r=s.length,o=0;o<r;o++)i.push(s[o]);return i}for(o in i=[],r=0,s)i[r++]=s[o];return i}(s)).length;for(var c=0;c<a;c++)i.call(void 0,o[c],r&&r[c],s)}}function mi(s,i){this.h={},this.g=[],this.i=0;var r=arguments.length;if(1<r){if(r%2)throw Error("Uneven number of arguments");for(var o=0;o<r;o+=2)this.set(arguments[o],arguments[o+1])}else if(s)if(s instanceof mi)for(r=s.T(),o=0;o<r.length;o++)this.set(r[o],s.get(r[o]));else for(o in s)this.set(o,s[o])}function Eo(s){if(s.i!=s.g.length){for(var i=0,r=0;i<s.g.length;){var o=s.g[i];Un(s.h,o)&&(s.g[r++]=o),i++}s.g.length=r}if(s.i!=s.g.length){var a={};for(r=i=0;i<s.g.length;)Un(a,o=s.g[i])||(s.g[r++]=o,a[o]=1),i++;s.g.length=r}}function Un(s,i){return Object.prototype.hasOwnProperty.call(s,i)}(F=hr.prototype).setTimeout=function(s){this.P=s},F.gb=function(s){s=s.target;var i=this.L;i&&3==zt(s)?i.l():this.Ia(s)},F.Ia=function(s){try{if(s==this.g)e:{var i=zt(this.g),r=this.g.Da(),o=this.g.ba();if(!(3>i)&&(3!=i||We||this.g&&(this.h.h||this.g.ga()||bl(this.g)))){this.I||4!=i||7==r||cr(8==r||0>=o?3:2),hs(this);var a=this.g.ba();this.N=a;t:if(tl(this)){var c=bl(this.g);s="";var l=c.length,d=4==zt(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){Fn(this),fr(this);var f="";break t}this.h.i=new j.TextDecoder}for(r=0;r<l;r++)this.h.h=!0,s+=this.h.i.decode(c[r],{stream:d&&r==l-1});c.splice(0,l),this.h.g+=s,this.C=0,f=this.h.g}else f=this.g.ga();if(this.i=200==a,function(s,i,r,o,a,c,l){s.info(function(){return"XMLHTTP RESP ("+o+") [ attempt "+a+"]: "+i+"\n"+r+"\n"+c+" "+l})}(this.j,this.u,this.A,this.m,this.X,i,a),this.i){if(this.$&&!this.J){t:{if(this.g){var m,w=this.g;if((m=w.g?w.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Vt(m)){var b=m;break t}}b=null}if(!(a=b)){this.i=!1,this.o=3,je(12),Fn(this),fr(this);break e}gi(this.j,this.m,a,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,bo(this,a)}this.U?(nl(this,i,f),We&&this.i&&3==i&&(jc(this.V,this.W,"tick",this.fb),this.W.start())):(gi(this.j,this.m,f,null),bo(this,f)),4==i&&Fn(this),this.i&&!this.I&&(4==i?Cl(this.l,this):(this.i=!1,dr(this)))}else 400==a&&0<f.indexOf("Unknown SID")?(this.o=3,je(12)):(this.o=0,je(13)),Fn(this),fr(this)}}}catch(x){}},F.fb=function(){if(this.g){var s=zt(this.g),i=this.g.ga();this.C<i.length&&(hs(this),nl(this,s,i),this.i&&4!=s&&dr(this))}},F.cancel=function(){this.I=!0,Fn(this)},F.eb=function(){this.B=null;var s=Date.now();0<=s-this.Y?(function(s,i){s.info(function(){return"TIMEOUT: "+i})}(this.j,this.A),2!=this.K&&(cr(3),je(17)),Fn(this),this.o=2,fr(this)):il(this,this.Y-s)},(F=mi.prototype).R=function(){Eo(this);for(var s=[],i=0;i<this.g.length;i++)s.push(this.h[this.g[i]]);return s},F.T=function(){return Eo(this),this.g.concat()},F.get=function(s,i){return Un(this.h,s)?this.h[s]:i},F.set=function(s,i){Un(this.h,s)||(this.i++,this.g.push(s)),this.h[s]=i},F.forEach=function(s,i){for(var r=this.T(),o=0;o<r.length;o++){var a=r[o],c=this.get(a);s.call(i,c,a,this)}};var rl=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Vn(s,i){if(this.i=this.s=this.j="",this.m=null,this.o=this.l="",this.g=!1,s instanceof Vn){this.g=void 0!==i?i:s.g,ds(this,s.j),this.s=s.s,fs(this,s.i),ps(this,s.m),this.l=s.l,i=s.h;var r=new mr;r.i=i.i,i.g&&(r.g=new mi(i.g),r.h=i.h),sl(this,r),this.o=s.o}else s&&(r=String(s).match(rl))?(this.g=!!i,ds(this,r[1]||"",!0),this.s=pr(r[2]||""),fs(this,r[3]||"",!0),ps(this,r[4]),this.l=pr(r[5]||"",!0),sl(this,r[6]||"",!0),this.o=pr(r[7]||"")):(this.g=!!i,this.h=new mr(null,this.g))}function Gt(s){return new Vn(s)}function ds(s,i,r){s.j=r?pr(i,!0):i,s.j&&(s.j=s.j.replace(/:$/,""))}function fs(s,i,r){s.i=r?pr(i,!0):i}function ps(s,i){if(i){if(i=Number(i),isNaN(i)||0>i)throw Error("Bad port number "+i);s.m=i}else s.m=null}function sl(s,i,r){i instanceof mr?(s.h=i,function(s,i){i&&!s.j&&(dn(s),s.i=null,s.g.forEach(function(r,o){var a=o.toLowerCase();o!=a&&(al(this,o),ll(this,a,r))},s)),s.j=i}(s.h,s.g)):(r||(i=gr(i,sf)),s.h=new mr(i,s.g))}function le(s,i,r){s.h.set(i,r)}function gs(s){return le(s,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),s}function pr(s,i){return s?i?decodeURI(s.replace(/%25/g,"%2525")):decodeURIComponent(s):""}function gr(s,i,r){return"string"==typeof s?(s=encodeURI(s).replace(i,tf),r&&(s=s.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),s):null}function tf(s){return"%"+((s=s.charCodeAt(0))>>4&15).toString(16)+(15&s).toString(16)}Vn.prototype.toString=function(){var s=[],i=this.j;i&&s.push(gr(i,ol,!0),":");var r=this.i;return(r||"file"==i)&&(s.push("//"),(i=this.s)&&s.push(gr(i,ol,!0),"@"),s.push(encodeURIComponent(String(r)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(r=this.m)&&s.push(":",String(r))),(r=this.l)&&(this.i&&"/"!=r.charAt(0)&&s.push("/"),s.push(gr(r,"/"==r.charAt(0)?rf:nf,!0))),(r=this.h.toString())&&s.push("?",r),(r=this.o)&&s.push("#",gr(r,of)),s.join("")};var ol=/[#\/\?@]/g,nf=/[#\?:]/g,rf=/[#\?]/g,sf=/[#\?@]/g,of=/#/g;function mr(s,i){this.h=this.g=null,this.i=s||null,this.j=!!i}function dn(s){s.g||(s.g=new mi,s.h=0,s.i&&function(s,i){if(s){s=s.split("&");for(var r=0;r<s.length;r++){var o=s[r].indexOf("="),a=null;if(0<=o){var c=s[r].substring(0,o);a=s[r].substring(o+1)}else c=s[r];i(c,a?decodeURIComponent(a.replace(/\+/g," ")):"")}}}(s.i,function(i,r){s.add(decodeURIComponent(i.replace(/\+/g," ")),r)}))}function al(s,i){dn(s),i=yi(s,i),Un(s.g.h,i)&&(s.i=null,s.h-=s.g.get(i).length,Un((s=s.g).h,i)&&(delete s.h[i],s.i--,s.g.length>2*s.i&&Eo(s)))}function cl(s,i){return dn(s),i=yi(s,i),Un(s.g.h,i)}function ll(s,i,r){al(s,i),0<r.length&&(s.i=null,s.g.set(yi(s,i),mt(r)),s.h+=r.length)}function yi(s,i){return i=String(i),s.j&&(i=i.toLowerCase()),i}(F=mr.prototype).add=function(s,i){dn(this),this.i=null,s=yi(this,s);var r=this.g.get(s);return r||this.g.set(s,r=[]),r.push(i),this.h+=1,this},F.forEach=function(s,i){dn(this),this.g.forEach(function(r,o){Ft(r,function(a){s.call(i,a,o,this)},this)},this)},F.T=function(){dn(this);for(var s=this.g.R(),i=this.g.T(),r=[],o=0;o<i.length;o++)for(var a=s[o],c=0;c<a.length;c++)r.push(i[o]);return r},F.R=function(s){dn(this);var i=[];if("string"==typeof s)cl(this,s)&&(i=Ut(i,this.g.get(yi(this,s))));else{s=this.g.R();for(var r=0;r<s.length;r++)i=Ut(i,s[r])}return i},F.set=function(s,i){return dn(this),this.i=null,cl(this,s=yi(this,s))&&(this.h-=this.g.get(s).length),this.g.set(s,[i]),this.h+=1,this},F.get=function(s,i){return s&&0<(s=this.R(s)).length?String(s[0]):i},F.toString=function(){if(this.i)return this.i;if(!this.g)return"";for(var s=[],i=this.g.T(),r=0;r<i.length;r++){var o=i[r],a=encodeURIComponent(String(o));o=this.R(o);for(var c=0;c<o.length;c++){var l=a;""!==o[c]&&(l+="="+encodeURIComponent(String(o[c]))),s.push(l)}}return this.i=s.join("&")};var cf=function(i,r){this.h=i,this.g=r};function ul(s){this.l=s||lf,s=j.PerformanceNavigationTiming?0<(s=j.performance.getEntriesByType("navigation")).length&&("hq"==s[0].nextHopProtocol||"h2"==s[0].nextHopProtocol):!!(j.g&&j.g.Ea&&j.g.Ea()&&j.g.Ea().Zb),this.j=s?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var lf=10;function hl(s){return!!s.h||!!s.g&&s.g.size>=s.j}function dl(s){return s.h?1:s.g?s.g.size:0}function Io(s,i){return s.h?s.h==i:!!s.g&&s.g.has(i)}function So(s,i){s.g?s.g.add(i):s.h=i}function fl(s,i){s.h&&s.h==i?s.h=null:s.g&&s.g.has(i)&&s.g.delete(i)}function pl(s){var i,r;if(null!=s.h)return s.i.concat(s.h.D);if(null!=s.g&&0!==s.g.size){var o=s.i;try{for(var a=Cn(s.g.values()),c=a.next();!c.done;c=a.next())o=o.concat(c.value.D)}catch(d){i={error:d}}finally{try{c&&!c.done&&(r=a.return)&&r.call(a)}finally{if(i)throw i.error}}return o}return mt(s.i)}function Do(){}function uf(){this.g=new Do}function hf(s,i,r){var o=r||"";try{To(s,function(a,c){var l=a;Qe(a)&&(l=pi(a)),i.push(o+c+"="+encodeURIComponent(l))})}catch(a){throw i.push(o+"type="+encodeURIComponent("_badmap")),a}}function ms(s,i,r,o,a){try{i.onload=null,i.onerror=null,i.onabort=null,i.ontimeout=null,a(o)}catch(c){}}function yr(s){this.l=s.$b||null,this.j=s.ib||!1}function ys(s,i){oe.call(this),this.D=s,this.u=i,this.m=void 0,this.readyState=xo,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}ul.prototype.cancel=function(){var s,i;if(this.i=pl(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){try{for(var r=Cn(this.g.values()),o=r.next();!o.done;o=r.next())o.value.cancel()}catch(c){s={error:c}}finally{try{o&&!o.done&&(i=r.return)&&i.call(r)}finally{if(s)throw s.error}}this.g.clear()}},Do.prototype.stringify=function(s){return j.JSON.stringify(s,void 0)},Do.prototype.parse=function(s){return j.JSON.parse(s,void 0)},fe(yr,go),yr.prototype.g=function(){return new ys(this.l,this.j)},yr.prototype.i=function(s){return function(){return s}}({}),fe(ys,oe);var xo=0;function gl(s){s.j.read().then(s.Sa.bind(s)).catch(s.ha.bind(s))}function vr(s){s.readyState=4,s.l=null,s.j=null,s.A=null,_r(s)}function _r(s){s.onreadystatechange&&s.onreadystatechange.call(s)}(F=ys.prototype).open=function(s,i){if(this.readyState!=xo)throw this.abort(),Error("Error reopening a connection");this.C=s,this.B=i,this.readyState=1,_r(this)},F.send=function(s){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;var i={headers:this.v,method:this.C,credentials:this.m,cache:void 0};s&&(i.body=s),(this.D||j).fetch(new Request(this.B,i)).then(this.Va.bind(this),this.ha.bind(this))},F.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted."),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,vr(this)),this.readyState=xo},F.Va=function(s){if(this.g&&(this.l=s,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=s.headers,this.readyState=2,_r(this)),this.g&&(this.readyState=3,_r(this),this.g)))if("arraybuffer"===this.responseType)s.arrayBuffer().then(this.Ta.bind(this),this.ha.bind(this));else if(void 0!==j.ReadableStream&&"body"in s){if(this.j=s.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;gl(this)}else s.text().then(this.Ua.bind(this),this.ha.bind(this))},F.Sa=function(s){if(this.g){if(this.u&&s.value)this.response.push(s.value);else if(!this.u){var i=s.value?s.value:new Uint8Array(0);(i=this.A.decode(i,{stream:!s.done}))&&(this.response=this.responseText+=i)}s.done?vr(this):_r(this),3==this.readyState&&gl(this)}},F.Ua=function(s){this.g&&(this.response=this.responseText=s,vr(this))},F.Ta=function(s){this.g&&(this.response=s,vr(this))},F.ha=function(){this.g&&vr(this)},F.setRequestHeader=function(s,i){this.v.append(s,i)},F.getResponseHeader=function(s){return this.h&&this.h.get(s.toLowerCase())||""},F.getAllResponseHeaders=function(){if(!this.h)return"";for(var s=[],i=this.h.entries(),r=i.next();!r.done;)s.push((r=r.value)[0]+": "+r[1]),r=i.next();return s.join("\r\n")},Object.defineProperty(ys.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(s){this.m=s?"include":"same-origin"}});var ff=j.JSON.parse;function be(s){oe.call(this),this.headers=new mi,this.u=s||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=ml,this.K=this.L=!1}fe(be,oe);var ml="",pf=/^https?$/i,gf=["POST","PUT"];function yf(s){return"content-type"==s.toLowerCase()}function yl(s,i){s.h=!1,s.g&&(s.l=!0,s.g.abort(),s.l=!1),s.j=i,s.m=5,vl(s),vs(s)}function vl(s){s.D||(s.D=!0,ne(s,"complete"),ne(s,"error"))}function _l(s){if(s.h&&void 0!==An&&(!s.C[1]||4!=zt(s)||2!=s.ba()))if(s.v&&4==zt(s))po(s.Fa,0,s);else if(ne(s,"readystatechange"),4==zt(s)){s.h=!1;try{var o,i=s.ba();e:switch(i){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break e;default:r=!1}if(!(o=r)){var a;if(a=0===i){var c=String(s.H).match(rl)[1]||null;if(!c&&j.self&&j.self.location){var l=j.self.location.protocol;c=l.substr(0,l.length-1)}a=!pf.test(c?c.toLowerCase():"")}o=a}if(o)ne(s,"complete"),ne(s,"success");else{s.m=6;try{var d=2<zt(s)?s.g.statusText:""}catch(f){d=""}s.j=d+" ["+s.ba()+"]",vl(s)}}finally{vs(s)}}}function vs(s,i){if(s.g){wl(s);var r=s.g,o=s.C[0]?It:null;s.g=null,s.C=null,i||ne(s,"ready");try{r.onreadystatechange=o}catch(a){}}}function wl(s){s.g&&s.K&&(s.g.ontimeout=null),s.A&&(j.clearTimeout(s.A),s.A=null)}function zt(s){return s.g?s.g.readyState:0}function bl(s){try{if(!s.g)return null;if("response"in s.g)return s.g.response;switch(s.J){case ml:case"text":return s.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in s.g)return s.g.mozResponseArrayBuffer}return null}catch(i){return null}}function Co(s,i,r){e:{for(o in r){var o=!1;break e}o=!0}o||(r=function(s){var i="";return nn(s,function(r,o){i+=o,i+=":",i+=r,i+="\r\n"}),i}(r),"string"==typeof s?null!=r&&encodeURIComponent(String(r)):le(s,i,r))}function wr(s,i,r){return r&&r.internalChannelParams&&r.internalChannelParams[s]||i}function Tl(s){this.za=0,this.l=[],this.h=new os,this.la=this.oa=this.F=this.W=this.g=this.sa=this.D=this.aa=this.o=this.P=this.s=null,this.Za=this.V=0,this.Xa=wr("failFast",!1,s),this.N=this.v=this.u=this.m=this.j=null,this.X=!0,this.I=this.ta=this.U=-1,this.Y=this.A=this.C=0,this.Pa=wr("baseRetryDelayMs",5e3,s),this.$a=wr("retryDelaySeedMs",1e4,s),this.Ya=wr("forwardChannelMaxRetries",2,s),this.ra=wr("forwardChannelRequestTimeoutMs",2e4,s),this.qa=s&&s.xmlHttpFactory||void 0,this.Ba=s&&s.Yb||!1,this.K=void 0,this.H=s&&s.supportsCrossDomainXhr||!1,this.J="",this.i=new ul(s&&s.concurrentRequestLimit),this.Ca=new uf,this.ja=s&&s.fastHandshake||!1,this.Ra=s&&s.Wb||!1,s&&s.Aa&&this.h.Aa(),s&&s.forceLongPolling&&(this.X=!1),this.$=!this.ja&&this.X&&s&&s.detectBufferingProxy||!1,this.ka=void 0,this.O=0,this.L=!1,this.B=null,this.Wa=!s||!1!==s.Xb}function Ao(s){if(El(s),3==s.G){var i=s.V++,r=Gt(s.F);le(r,"SID",s.J),le(r,"RID",i),le(r,"TYPE","terminate"),br(s,r),(i=new hr(s,s.h,i,void 0)).K=2,i.v=gs(Gt(r)),r=!1,j.navigator&&j.navigator.sendBeacon&&(r=j.navigator.sendBeacon(i.v.toString(),"")),!r&&j.Image&&((new Image).src=i.v,r=!0),r||(i.g=Nl(i.l,null),i.g.ea(i.v)),i.F=Date.now(),dr(i)}Rl(s)}function _s(s){s.g&&(No(s),s.g.cancel(),s.g=null)}function El(s){_s(s),s.u&&(j.clearTimeout(s.u),s.u=null),bs(s),s.i.cancel(),s.m&&("number"==typeof s.m&&j.clearTimeout(s.m),s.m=null)}function Ro(s,i){s.l.push(new cf(s.Za++,i)),3==s.G&&ws(s)}function ws(s){hl(s.i)||s.m||(s.m=!0,lo(s.Ha,s),s.C=0)}function Il(s,i){var r;r=i?i.m:s.V++;var o=Gt(s.F);le(o,"SID",s.J),le(o,"RID",r),le(o,"AID",s.U),br(s,o),s.o&&s.s&&Co(o,s.o,s.s),r=new hr(s,s.h,r,s.C+1),null===s.o&&(r.H=s.s),i&&(s.l=i.D.concat(s.l)),i=Sl(s,r,1e3),r.setTimeout(Math.round(.5*s.ra)+Math.round(.5*s.ra*Math.random())),So(s.i,r),wo(r,o,i)}function br(s,i){s.j&&To({},function(r,o){le(i,o,r)})}function Sl(s,i,r){r=Math.min(s.l.length,r);var o=s.j?de(s.j.Oa,s.j,s):null;e:for(var a=s.l,c=-1;;){var l=["count="+r];-1==c?0<r?l.push("ofs="+(c=a[0].h)):c=0:l.push("ofs="+c);for(var d=!0,f=0;f<r;f++){var m=a[f].h,w=a[f].g;if(0>(m-=c))c=Math.max(0,a[f].h-100),d=!1;else try{hf(w,l,"req"+m+"_")}catch(b){o&&o(w)}}if(d){o=l.join("&");break e}}return s=s.l.splice(0,r),i.D=s,o}function Dl(s){s.g||s.u||(s.Y=1,lo(s.Ga,s),s.A=0)}function Po(s){return!(s.g||s.u||3<=s.A||(s.Y++,s.u=lr(de(s.Ga,s),Al(s,s.A)),s.A++,0))}function No(s){null!=s.B&&(j.clearTimeout(s.B),s.B=null)}function xl(s){s.g=new hr(s,s.h,"rpc",s.Y),null===s.o&&(s.g.H=s.s),s.g.O=0;var i=Gt(s.oa);le(i,"RID","rpc"),le(i,"SID",s.J),le(i,"CI",s.N?"0":"1"),le(i,"AID",s.U),br(s,i),le(i,"TYPE","xmlhttp"),s.o&&s.s&&Co(i,s.o,s.s),s.K&&s.g.setTimeout(s.K);var r=s.g;s=s.la,r.K=1,r.v=gs(Gt(i)),r.s=null,r.U=!0,el(r,s)}function bs(s){null!=s.v&&(j.clearTimeout(s.v),s.v=null)}function Cl(s,i){var r=null;if(s.g==i){bs(s),No(s),s.g=null;var o=2}else{if(!Io(s.i,i))return;r=i.D,fl(s.i,i),o=1}if(s.I=i.N,0!=s.G)if(i.i)if(1==o){r=i.s?i.s.length:0,i=Date.now()-i.F;var a=s.C;ne(o=as(),new Yc(o,r,i,a)),ws(s)}else Dl(s);else if(3==(a=i.o)||0==a&&0<s.I||!(1==o&&function(s,i){return!(dl(s.i)>=s.i.j-(s.m?1:0)||(s.m?(s.l=i.D.concat(s.l),0):1==s.G||2==s.G||s.C>=(s.Xa?0:s.Ya)||(s.m=lr(de(s.Ha,s,i),Al(s,s.C)),s.C++,0)))}(s,i)||2==o&&Po(s)))switch(r&&0<r.length&&(i=s.i,i.i=i.i.concat(r)),a){case 1:Bn(s,5);break;case 4:Bn(s,10);break;case 3:Bn(s,6);break;default:Bn(s,2)}}function Al(s,i){var r=s.Pa+Math.floor(Math.random()*s.$a);return s.j||(r*=2),r*i}function Bn(s,i){if(s.h.info("Error code "+i),2==i){var r=null;s.j&&(r=null);var o=de(s.jb,s);r||(r=new Vn("//www.google.com/images/cleardot.gif"),j.location&&"http"==j.location.protocol||ds(r,"https"),gs(r)),function(s,i){var r=new os;if(j.Image){var o=new Image;o.onload=St(ms,r,o,"TestLoadImage: loaded",!0,i),o.onerror=St(ms,r,o,"TestLoadImage: error",!1,i),o.onabort=St(ms,r,o,"TestLoadImage: abort",!1,i),o.ontimeout=St(ms,r,o,"TestLoadImage: timeout",!1,i),j.setTimeout(function(){o.ontimeout&&o.ontimeout()},1e4),o.src=s}else i(!1)}(r.toString(),o)}else je(2);s.G=0,s.j&&s.j.va(i),Rl(s),El(s)}function Rl(s){s.G=0,s.I=-1,s.j&&((0!=pl(s.i).length||0!=s.l.length)&&(s.i.i.length=0,mt(s.l),s.l.length=0),s.j.ua())}function Pl(s,i,r){var o=function(s){return s instanceof Vn?Gt(s):new Vn(s,void 0)}(r);if(""!=o.i)i&&fs(o,i+"."+o.i),ps(o,o.m);else{var a=j.location;o=function(s,i,r,o){var a=new Vn(null,void 0);return s&&ds(a,s),i&&fs(a,i),r&&ps(a,r),o&&(a.l=o),a}(a.protocol,i?i+"."+a.hostname:a.hostname,+a.port,r)}return s.aa&&nn(s.aa,function(c,l){le(o,l,c)}),r=s.sa,(i=s.D)&&r&&le(o,i,r),le(o,"VER",s.ma),br(s,o),o}function Nl(s,i,r){if(i&&!s.H)throw Error("Can't create secondary domain capable XhrIo object.");return(i=new be(r&&s.Ba&&!s.qa?new yr({ib:!0}):s.qa)).L=s.H,i}function kl(){}function Ts(){if(yt&&!(10<=Number(On)))throw Error("Environmental error: no available transport.")}function st(s,i){oe.call(this),this.g=new Tl(i),this.l=s,this.h=i&&i.messageUrlParams||null,s=i&&i.messageHeaders||null,i&&i.clientProtocolHeaderRequired&&(s?s["X-Client-Protocol"]="webchannel":s={"X-Client-Protocol":"webchannel"}),this.g.s=s,s=i&&i.initMessageHeaders||null,i&&i.messageContentType&&(s?s["X-WebChannel-Content-Type"]=i.messageContentType:s={"X-WebChannel-Content-Type":i.messageContentType}),i&&i.ya&&(s?s["X-WebChannel-Client-Profile"]=i.ya:s={"X-WebChannel-Client-Profile":i.ya}),this.g.P=s,(s=i&&i.httpHeadersOverwriteParam)&&!Vt(s)&&(this.g.o=s),this.A=i&&i.supportsCrossDomainXhr||!1,this.v=i&&i.sendRawJson||!1,(i=i&&i.httpSessionIdParam)&&!Vt(i)&&(this.g.D=i,null!==(s=this.h)&&i in s&&i in(s=this.h)&&delete s[i]),this.j=new vi(this)}function Ll(s){mo.call(this);var i=s.__sm__;if(i){e:{for(var r in i){s=r;break e}s=void 0}(this.i=s)&&(s=this.i,i=null!==i&&s in i?i[s]:void 0),this.data=i}else this.data=s}function Ol(){yo.call(this),this.status=1}function vi(s){this.g=s}(F=be.prototype).ea=function(s,i,r,o){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+s);i=i?i.toUpperCase():"GET",this.H=s,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():vo.g(),this.C=function(s){return s.h||(s.h=s.i())}(this.u?this.u:vo),this.g.onreadystatechange=de(this.Fa,this);try{this.F=!0,this.g.open(i,String(s),!0),this.F=!1}catch(c){return void yl(this,c)}s=r||"";var a=new mi(this.headers);o&&To(o,function(c,l){a.set(l,c)}),o=function(s){e:{for(var i=yf,r=s.length,o="string"==typeof s?s.split(""):s,a=0;a<r;a++)if(a in o&&i.call(void 0,o[a],a,s)){i=a;break e}i=-1}return 0>i?null:"string"==typeof s?s.charAt(i):s[i]}(a.T()),r=j.FormData&&s instanceof j.FormData,!(0<=ht(gf,i))||o||r||a.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),a.forEach(function(c,l){this.g.setRequestHeader(l,c)},this),this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{wl(this),0<this.B&&((this.K=function(s){return yt&&nr()&&"number"==typeof s.timeout&&void 0!==s.ontimeout}(this.g))?(this.g.timeout=this.B,this.g.ontimeout=de(this.pa,this)):this.A=po(this.pa,this.B,this)),this.v=!0,this.g.send(s),this.v=!1}catch(c){yl(this,c)}},F.pa=function(){void 0!==An&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,ne(this,"timeout"),this.abort(8))},F.abort=function(s){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=s||7,ne(this,"complete"),ne(this,"abort"),vs(this))},F.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),vs(this,!0)),be.Z.M.call(this)},F.Fa=function(){this.s||(this.F||this.v||this.l?_l(this):this.cb())},F.cb=function(){_l(this)},F.ba=function(){try{return 2<zt(this)?this.g.status:-1}catch(s){return-1}},F.ga=function(){try{return this.g?this.g.responseText:""}catch(s){return""}},F.Qa=function(s){if(this.g){var i=this.g.responseText;return s&&0==i.indexOf(s)&&(i=i.substring(s.length)),ff(i)}},F.Da=function(){return this.m},F.La=function(){return"string"==typeof this.j?this.j:String(this.j)},(F=Tl.prototype).ma=8,F.G=1,F.hb=function(s){try{this.h.info("Origin Trials invoked: "+s)}catch(i){}},F.Ha=function(s){if(this.m)if(this.m=null,1==this.G){if(!s){this.V=Math.floor(1e5*Math.random()),s=this.V++;var i=new hr(this,this.h,s,void 0),r=this.s;if(this.P&&(r?Nn(r=hi(r),this.P):r=this.P),null===this.o&&(i.H=r),this.ja)e:{for(var o=0,a=0;a<this.l.length;a++){var c=this.l[a];if(void 0===(c="__data__"in c.g&&"string"==typeof(c=c.g.__data__)?c.length:void 0))break;if(4096<(o+=c)){o=a;break e}if(4096===o||a===this.l.length-1){o=a+1;break e}}o=1e3}else o=1e3;o=Sl(this,i,o),le(a=Gt(this.F),"RID",s),le(a,"CVER",22),this.D&&le(a,"X-HTTP-Session-Id",this.D),br(this,a),this.o&&r&&Co(a,this.o,r),So(this.i,i),this.Ra&&le(a,"TYPE","init"),this.ja?(le(a,"$req",o),le(a,"SID","null"),i.$=!0,wo(i,a,null)):wo(i,a,o),this.G=2}}else 3==this.G&&(s?Il(this,s):0==this.l.length||hl(this.i)||Il(this))},F.Ga=function(){if(this.u=null,xl(this),this.$&&!(this.L||null==this.g||0>=this.O)){var s=2*this.O;this.h.info("BP detection timer enabled: "+s),this.B=lr(de(this.bb,this),s)}},F.bb=function(){this.B&&(this.B=null,this.h.info("BP detection timeout reached."),this.h.info("Buffering proxy detected and switch to long-polling!"),this.N=!1,this.L=!0,je(10),_s(this),xl(this))},F.ab=function(){null!=this.v&&(this.v=null,_s(this),Po(this),je(19))},F.jb=function(s){s?(this.h.info("Successfully pinged google.com"),je(2)):(this.h.info("Failed to ping google.com"),je(1))},(F=kl.prototype).xa=function(){},F.wa=function(){},F.va=function(){},F.ua=function(){},F.Oa=function(){},Ts.prototype.g=function(s,i){return new st(s,i)},fe(st,oe),st.prototype.m=function(){this.g.j=this.j,this.A&&(this.g.H=!0);var s=this.g,i=this.l,r=this.h||void 0;s.Wa&&(s.h.info("Origin Trials enabled."),lo(de(s.hb,s,i))),je(0),s.W=i,s.aa=r||{},s.N=s.X,s.F=Pl(s,null,s.W),ws(s)},st.prototype.close=function(){Ao(this.g)},st.prototype.u=function(s){if("string"==typeof s){var i={};i.__data__=s,Ro(this.g,i)}else this.v?((i={}).__data__=pi(s),Ro(this.g,i)):Ro(this.g,s)},st.prototype.M=function(){this.g.j=null,delete this.j,Ao(this.g),delete this.g,st.Z.M.call(this)},fe(Ll,mo),fe(Ol,yo),fe(vi,kl),vi.prototype.xa=function(){ne(this.g,"a")},vi.prototype.wa=function(s){ne(this.g,new Ll(s))},vi.prototype.va=function(s){ne(this.g,new Ol(s))},vi.prototype.ua=function(){ne(this.g,"b")},Ts.prototype.createWebChannel=Ts.prototype.g,st.prototype.send=st.prototype.u,st.prototype.open=st.prototype.m,st.prototype.close=st.prototype.close,cs.NO_ERROR=0,cs.TIMEOUT=8,cs.HTTP_ERROR=6,Qc.COMPLETE="complete",Xc.EventType=ur,ur.OPEN="a",ur.CLOSE="b",ur.ERROR="c",ur.MESSAGE="d",oe.prototype.listen=oe.prototype.N,be.prototype.listenOnce=be.prototype.O,be.prototype.getLastError=be.prototype.La,be.prototype.getLastErrorCode=be.prototype.Da,be.prototype.getStatus=be.prototype.ba,be.prototype.getResponseJson=be.prototype.Qa,be.prototype.getResponseText=be.prototype.ga,be.prototype.send=be.prototype.ea;var Es=cs,Ul=Qc,Vl=Mn,ko_PROXY=10,ko_NOPROXY=11,Bl=yr,Tr=Xc,ql=be;class Fe{constructor(i){this.uid=i}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(i){return i.uid===this.uid}}Fe.UNAUTHENTICATED=new Fe(null),Fe.GOOGLE_CREDENTIALS=new Fe("google-credentials-uid"),Fe.FIRST_PARTY=new Fe("first-party-uid"),Fe.MOCK_USER=new Fe("mock-user");let _i="9.0.1";const fn=new Ye.Yd("@firebase/firestore");function Lo(){return fn.logLevel}function L(s,...i){if(fn.logLevel<=Ye.in.DEBUG){const r=i.map(Oo);fn.debug(`Firestore (${_i}): ${s}`,...r)}}function Te(s,...i){if(fn.logLevel<=Ye.in.ERROR){const r=i.map(Oo);fn.error(`Firestore (${_i}): ${s}`,...r)}}function Er(s,...i){if(fn.logLevel<=Ye.in.WARN){const r=i.map(Oo);fn.warn(`Firestore (${_i}): ${s}`,...r)}}function Oo(s){if("string"==typeof s)return s;try{return JSON.stringify(s)}catch(r){return s}}function B(s="Unexpected state"){const i=`FIRESTORE (${_i}) INTERNAL ASSERTION FAILED: `+s;throw Te(i),new Error(i)}function K(s,i){s||B()}function M(s,i){return s}const D={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class k extends Error{constructor(i,r){super(r),this.code=i,this.message=r,this.name="FirebaseError",this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class Pe{constructor(){this.promise=new Promise((i,r)=>{this.resolve=i,this.reject=r})}}class Gl{constructor(i,r){this.user=r,this.type="OAuth",this.authHeaders={},this.authHeaders.Authorization=`Bearer ${i}`}}class Tf{getToken(){return Promise.resolve(null)}invalidateToken(){}start(i,r){i.enqueueRetryable(()=>r(Fe.UNAUTHENTICATED))}shutdown(){}}class Ef{constructor(i){this.token=i,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(i,r){this.changeListener=r,i.enqueueRetryable(()=>r(this.token.user))}shutdown(){this.changeListener=null}}class If{constructor(i){this.t=i,this.currentUser=Fe.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(i,r){var o=this;let a=this.i;const c=f=>this.i!==a?(a=this.i,r(f)):Promise.resolve();let l=new Pe;this.o=()=>{this.i++,this.currentUser=this.u(),l.resolve(),l=new Pe,i.enqueueRetryable(()=>c(this.currentUser))};const d=f=>{i.enqueueRetryable((0,C.Z)(function*(){L("FirebaseCredentialsProvider","Auth detected"),o.auth=f,o.auth.addAuthTokenListener(o.o),yield l.promise,yield c(o.currentUser)}))};this.t.onInit(f=>d(f)),setTimeout(()=>{if(!this.auth){const f=this.t.getImmediate({optional:!0});f?d(f):(L("FirebaseCredentialsProvider","Auth not yet detected"),l.resolve(),l=new Pe)}},0),i.enqueueRetryable((0,C.Z)(function*(){0===o.i&&(yield l.promise,yield c(o.currentUser))}))}getToken(){const i=this.i,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(o=>this.i!==i?(L("FirebaseCredentialsProvider","getToken aborted due to token change."),this.getToken()):o?(K("string"==typeof o.accessToken),new Gl(o.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const i=this.auth&&this.auth.getUid();return K(null===i||"string"==typeof i),new Fe(i)}}class Sf{constructor(i,r,o){this.h=i,this.l=r,this.m=o,this.type="FirstParty",this.user=Fe.FIRST_PARTY}get authHeaders(){const i={"X-Goog-AuthUser":this.l},r=this.h.auth.getAuthHeaderValueForFirstParty([]);return r&&(i.Authorization=r),this.m&&(i["X-Goog-Iam-Authorization-Token"]=this.m),i}}class Df{constructor(i,r,o){this.h=i,this.l=r,this.m=o}getToken(){return Promise.resolve(new Sf(this.h,this.l,this.m))}start(i,r){i.enqueueRetryable(()=>r(Fe.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class ot{constructor(i,r){this.previousValue=i,r&&(r.sequenceNumberHandler=o=>this.g(o),this.p=o=>r.writeSequenceNumber(o))}g(i){return this.previousValue=Math.max(i,this.previousValue),this.previousValue}next(){const i=++this.previousValue;return this.p&&this.p(i),i}}function xf(s){const i="undefined"!=typeof self&&(self.crypto||self.msCrypto),r=new Uint8Array(s);if(i&&"function"==typeof i.getRandomValues)i.getRandomValues(r);else for(let o=0;o<s;o++)r[o]=Math.floor(256*Math.random());return r}ot.T=-1;class zl{static I(){const i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=Math.floor(256/i.length)*i.length;let o="";for(;o.length<20;){const a=xf(40);for(let c=0;c<a.length;++c)o.length<20&&a[c]<r&&(o+=i.charAt(a[c]%i.length))}return o}}function X(s,i){return s<i?-1:s>i?1:0}function wi(s,i,r){return s.length===i.length&&s.every((o,a)=>r(o,i[a]))}function jl(s){return s+"\0"}class Ne{constructor(i,r){if(this.seconds=i,this.nanoseconds=r,r<0)throw new k(D.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(r>=1e9)throw new k(D.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+r);if(i<-62135596800)throw new k(D.INVALID_ARGUMENT,"Timestamp seconds out of range: "+i);if(i>=253402300800)throw new k(D.INVALID_ARGUMENT,"Timestamp seconds out of range: "+i)}static now(){return Ne.fromMillis(Date.now())}static fromDate(i){return Ne.fromMillis(i.getTime())}static fromMillis(i){const r=Math.floor(i/1e3),o=Math.floor(1e6*(i-1e3*r));return new Ne(r,o)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(i){return this.seconds===i.seconds?X(this.nanoseconds,i.nanoseconds):X(this.seconds,i.seconds)}isEqual(i){return i.seconds===this.seconds&&i.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){return String(this.seconds- -62135596800).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class Y{constructor(i){this.timestamp=i}static fromTimestamp(i){return new Y(i)}static min(){return new Y(new Ne(0,0))}compareTo(i){return this.timestamp._compareTo(i.timestamp)}isEqual(i){return this.timestamp.isEqual(i.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}function $l(s){let i=0;for(const r in s)Object.prototype.hasOwnProperty.call(s,r)&&i++;return i}function qn(s,i){for(const r in s)Object.prototype.hasOwnProperty.call(s,r)&&i(r,s[r])}function Kl(s){for(const i in s)if(Object.prototype.hasOwnProperty.call(s,i))return!1;return!0}class Ir{constructor(i,r,o){void 0===r?r=0:r>i.length&&B(),void 0===o?o=i.length-r:o>i.length-r&&B(),this.segments=i,this.offset=r,this.len=o}get length(){return this.len}isEqual(i){return 0===Ir.comparator(this,i)}child(i){const r=this.segments.slice(this.offset,this.limit());return i instanceof Ir?i.forEach(o=>{r.push(o)}):r.push(i),this.construct(r)}limit(){return this.offset+this.length}popFirst(i){return this.construct(this.segments,this.offset+(i=void 0===i?1:i),this.length-i)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(i){return this.segments[this.offset+i]}isEmpty(){return 0===this.length}isPrefixOf(i){if(i.length<this.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==i.get(r))return!1;return!0}isImmediateParentOf(i){if(this.length+1!==i.length)return!1;for(let r=0;r<this.length;r++)if(this.get(r)!==i.get(r))return!1;return!0}forEach(i){for(let r=this.offset,o=this.limit();r<o;r++)i(this.segments[r])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(i,r){const o=Math.min(i.length,r.length);for(let a=0;a<o;a++){const c=i.get(a),l=r.get(a);if(c<l)return-1;if(c>l)return 1}return i.length<r.length?-1:i.length>r.length?1:0}}class te extends Ir{construct(i,r,o){return new te(i,r,o)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...i){const r=[];for(const o of i){if(o.indexOf("//")>=0)throw new k(D.INVALID_ARGUMENT,`Invalid segment (${o}). Paths must not contain // in them.`);r.push(...o.split("/").filter(a=>a.length>0))}return new te(r)}static emptyPath(){return new te([])}}const Cf=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Ue extends Ir{construct(i,r,o){return new Ue(i,r,o)}static isValidIdentifier(i){return Cf.test(i)}canonicalString(){return this.toArray().map(i=>(i=i.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Ue.isValidIdentifier(i)||(i="`"+i+"`"),i)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new Ue(["__name__"])}static fromServerFormat(i){const r=[];let o="",a=0;const c=()=>{if(0===o.length)throw new k(D.INVALID_ARGUMENT,`Invalid field path (${i}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);r.push(o),o=""};let l=!1;for(;a<i.length;){const d=i[a];if("\\"===d){if(a+1===i.length)throw new k(D.INVALID_ARGUMENT,"Path has trailing escape character: "+i);const f=i[a+1];if("\\"!==f&&"."!==f&&"`"!==f)throw new k(D.INVALID_ARGUMENT,"Path has invalid escape sequence: "+i);o+=f,a+=2}else"`"===d?(l=!l,a++):"."!==d||l?(o+=d,a++):(c(),a++)}if(c(),l)throw new k(D.INVALID_ARGUMENT,"Unterminated ` in path: "+i);return new Ue(r)}static emptyPath(){return new Ue([])}}class bi{constructor(i){this.fields=i,i.sort(Ue.comparator)}covers(i){for(const r of this.fields)if(r.isPrefixOf(i))return!0;return!1}isEqual(i){return wi(this.fields,i.fields,(r,o)=>r.isEqual(o))}}class ke{constructor(i){this.binaryString=i}static fromBase64String(i){const r=atob(i);return new ke(r)}static fromUint8Array(i){const r=function(o){let a="";for(let c=0;c<o.length;++c)a+=String.fromCharCode(o[c]);return a}(i);return new ke(r)}toBase64(){return btoa(this.binaryString)}toUint8Array(){return function(i){const r=new Uint8Array(i.length);for(let o=0;o<i.length;o++)r[o]=i.charCodeAt(o);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(i){return X(this.binaryString,i.binaryString)}isEqual(i){return this.binaryString===i.binaryString}}ke.EMPTY_BYTE_STRING=new ke("");const Rf=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function pn(s){if(K(!!s),"string"==typeof s){let i=0;const r=Rf.exec(s);if(K(!!r),r[1]){let a=r[1];a=(a+"000000000").substr(0,9),i=Number(a)}const o=new Date(s);return{seconds:Math.floor(o.getTime()/1e3),nanos:i}}return{seconds:Ee(s.seconds),nanos:Ee(s.nanos)}}function Ee(s){return"number"==typeof s?s:"string"==typeof s?Number(s):0}function Ti(s){return"string"==typeof s?ke.fromBase64String(s):ke.fromUint8Array(s)}function Mo(s){var i,r;return"server_timestamp"===(null===(r=((null===(i=null==s?void 0:s.mapValue)||void 0===i?void 0:i.fields)||{}).__type__)||void 0===r?void 0:r.stringValue)}function Zl(s){const i=s.mapValue.fields.__previous_value__;return Mo(i)?Zl(i):i}function Sr(s){const i=pn(s.mapValue.fields.__local_write_time__.timestampValue);return new Ne(i.seconds,i.nanos)}function Gn(s){return null==s}function Is(s){return 0===s&&1/s==-1/0}function Hl(s){return"number"==typeof s&&Number.isInteger(s)&&!Is(s)&&s<=Number.MAX_SAFE_INTEGER&&s>=Number.MIN_SAFE_INTEGER}class V{constructor(i){this.path=i}static fromPath(i){return new V(te.fromString(i))}static fromName(i){return new V(te.fromString(i).popFirst(5))}hasCollectionId(i){return this.path.length>=2&&this.path.get(this.path.length-2)===i}isEqual(i){return null!==i&&0===te.comparator(this.path,i.path)}toString(){return this.path.toString()}static comparator(i,r){return te.comparator(i.path,r.path)}static isDocumentKey(i){return i.length%2==0}static fromSegments(i){return new V(new te(i.slice()))}}function zn(s){return"nullValue"in s?0:"booleanValue"in s?1:"integerValue"in s||"doubleValue"in s?2:"timestampValue"in s?3:"stringValue"in s?5:"bytesValue"in s?6:"referenceValue"in s?7:"geoPointValue"in s?8:"arrayValue"in s?9:"mapValue"in s?Mo(s)?4:10:B()}function At(s,i){const r=zn(s);if(r!==zn(i))return!1;switch(r){case 0:return!0;case 1:return s.booleanValue===i.booleanValue;case 4:return Sr(s).isEqual(Sr(i));case 3:return function(o,a){if("string"==typeof o.timestampValue&&"string"==typeof a.timestampValue&&o.timestampValue.length===a.timestampValue.length)return o.timestampValue===a.timestampValue;const c=pn(o.timestampValue),l=pn(a.timestampValue);return c.seconds===l.seconds&&c.nanos===l.nanos}(s,i);case 5:return s.stringValue===i.stringValue;case 6:return a=i,Ti(s.bytesValue).isEqual(Ti(a.bytesValue));case 7:return s.referenceValue===i.referenceValue;case 8:return function(o,a){return Ee(o.geoPointValue.latitude)===Ee(a.geoPointValue.latitude)&&Ee(o.geoPointValue.longitude)===Ee(a.geoPointValue.longitude)}(s,i);case 2:return function(o,a){if("integerValue"in o&&"integerValue"in a)return Ee(o.integerValue)===Ee(a.integerValue);if("doubleValue"in o&&"doubleValue"in a){const c=Ee(o.doubleValue),l=Ee(a.doubleValue);return c===l?Is(c)===Is(l):isNaN(c)&&isNaN(l)}return!1}(s,i);case 9:return wi(s.arrayValue.values||[],i.arrayValue.values||[],At);case 10:return function(o,a){const c=o.mapValue.fields||{},l=a.mapValue.fields||{};if($l(c)!==$l(l))return!1;for(const d in c)if(c.hasOwnProperty(d)&&(void 0===l[d]||!At(c[d],l[d])))return!1;return!0}(s,i);default:return B()}var a}function Dr(s,i){return void 0!==(s.values||[]).find(r=>At(r,i))}function Ei(s,i){const r=zn(s),o=zn(i);if(r!==o)return X(r,o);switch(r){case 0:return 0;case 1:return X(s.booleanValue,i.booleanValue);case 2:return function(a,c){const l=Ee(a.integerValue||a.doubleValue),d=Ee(c.integerValue||c.doubleValue);return l<d?-1:l>d?1:l===d?0:isNaN(l)?isNaN(d)?0:-1:1}(s,i);case 3:return Yl(s.timestampValue,i.timestampValue);case 4:return Yl(Sr(s),Sr(i));case 5:return X(s.stringValue,i.stringValue);case 6:return function(a,c){const l=Ti(a),d=Ti(c);return l.compareTo(d)}(s.bytesValue,i.bytesValue);case 7:return function(a,c){const l=a.split("/"),d=c.split("/");for(let f=0;f<l.length&&f<d.length;f++){const m=X(l[f],d[f]);if(0!==m)return m}return X(l.length,d.length)}(s.referenceValue,i.referenceValue);case 8:return function(a,c){const l=X(Ee(a.latitude),Ee(c.latitude));return 0!==l?l:X(Ee(a.longitude),Ee(c.longitude))}(s.geoPointValue,i.geoPointValue);case 9:return function(a,c){const l=a.values||[],d=c.values||[];for(let f=0;f<l.length&&f<d.length;++f){const m=Ei(l[f],d[f]);if(m)return m}return X(l.length,d.length)}(s.arrayValue,i.arrayValue);case 10:return function(a,c){const l=a.fields||{},d=Object.keys(l),f=c.fields||{},m=Object.keys(f);d.sort(),m.sort();for(let w=0;w<d.length&&w<m.length;++w){const b=X(d[w],m[w]);if(0!==b)return b;const x=Ei(l[d[w]],f[m[w]]);if(0!==x)return x}return X(d.length,m.length)}(s.mapValue,i.mapValue);default:throw B()}}function Yl(s,i){if("string"==typeof s&&"string"==typeof i&&s.length===i.length)return X(s,i);const r=pn(s),o=pn(i),a=X(r.seconds,o.seconds);return 0!==a?a:X(r.nanos,o.nanos)}function Fo(s){return Uo(s)}function Uo(s){return"nullValue"in s?"null":"booleanValue"in s?""+s.booleanValue:"integerValue"in s?""+s.integerValue:"doubleValue"in s?""+s.doubleValue:"timestampValue"in s?function(o){const a=pn(o);return`time(${a.seconds},${a.nanos})`}(s.timestampValue):"stringValue"in s?s.stringValue:"bytesValue"in s?Ti(s.bytesValue).toBase64():"referenceValue"in s?V.fromName(s.referenceValue).toString():"geoPointValue"in s?`geo(${(i=s.geoPointValue).latitude},${i.longitude})`:"arrayValue"in s?function(o){let a="[",c=!0;for(const l of o.values||[])c?c=!1:a+=",",a+=Uo(l);return a+"]"}(s.arrayValue):"mapValue"in s?function(o){const a=Object.keys(o.fields||{}).sort();let c="{",l=!0;for(const d of a)l?l=!1:c+=",",c+=`${d}:${Uo(o.fields[d])}`;return c+"}"}(s.mapValue):B();var i}function Ss(s,i){return{referenceValue:`projects/${s.projectId}/databases/${s.database}/documents/${i.path.canonicalString()}`}}function Vo(s){return!!s&&"integerValue"in s}function Bo(s){return!!s&&"arrayValue"in s}function Ql(s){return!!s&&"nullValue"in s}function Wl(s){return!!s&&"doubleValue"in s&&isNaN(Number(s.doubleValue))}function Ds(s){return!!s&&"mapValue"in s}function xr(s){if(s.geoPointValue)return{geoPointValue:Object.assign({},s.geoPointValue)};if(s.timestampValue&&"object"==typeof s.timestampValue)return{timestampValue:Object.assign({},s.timestampValue)};if(s.mapValue){const i={mapValue:{fields:{}}};return qn(s.mapValue.fields,(r,o)=>i.mapValue.fields[r]=xr(o)),i}if(s.arrayValue){const i={arrayValue:{values:[]}};for(let r=0;r<(s.arrayValue.values||[]).length;++r)i.arrayValue.values[r]=xr(s.arrayValue.values[r]);return i}return Object.assign({},s)}class qe{constructor(i){this.value=i}static empty(){return new qe({mapValue:{}})}field(i){if(i.isEmpty())return this.value;{let r=this.value;for(let o=0;o<i.length-1;++o)if(r=(r.mapValue.fields||{})[i.get(o)],!Ds(r))return null;return r=(r.mapValue.fields||{})[i.lastSegment()],r||null}}set(i,r){this.getFieldsMap(i.popLast())[i.lastSegment()]=xr(r)}setAll(i){let r=Ue.emptyPath(),o={},a=[];i.forEach((l,d)=>{if(!r.isImmediateParentOf(d)){const f=this.getFieldsMap(r);this.applyChanges(f,o,a),o={},a=[],r=d.popLast()}l?o[d.lastSegment()]=xr(l):a.push(d.lastSegment())});const c=this.getFieldsMap(r);this.applyChanges(c,o,a)}delete(i){const r=this.field(i.popLast());Ds(r)&&r.mapValue.fields&&delete r.mapValue.fields[i.lastSegment()]}isEqual(i){return At(this.value,i.value)}getFieldsMap(i){let r=this.value;r.mapValue.fields||(r.mapValue={fields:{}});for(let o=0;o<i.length;++o){let a=r.mapValue.fields[i.get(o)];Ds(a)&&a.mapValue.fields||(a={mapValue:{fields:{}}},r.mapValue.fields[i.get(o)]=a),r=a}return r.mapValue.fields}applyChanges(i,r,o){qn(r,(a,c)=>i[a]=c);for(const a of o)delete i[a]}clone(){return new qe(xr(this.value))}}function Xl(s){const i=[];return qn(s.fields,(r,o)=>{const a=new Ue([r]);if(Ds(o)){const c=Xl(o.mapValue).fields;if(0===c.length)i.push(a);else for(const l of c)i.push(a.child(l))}else i.push(a)}),new bi(i)}class ue{constructor(i,r,o,a,c){this.key=i,this.documentType=r,this.version=o,this.data=a,this.documentState=c}static newInvalidDocument(i){return new ue(i,0,Y.min(),qe.empty(),0)}static newFoundDocument(i,r,o){return new ue(i,1,r,o,0)}static newNoDocument(i,r){return new ue(i,2,r,qe.empty(),0)}static newUnknownDocument(i,r){return new ue(i,3,r,qe.empty(),2)}convertToFoundDocument(i,r){return this.version=i,this.documentType=1,this.data=r,this.documentState=0,this}convertToNoDocument(i){return this.version=i,this.documentType=2,this.data=qe.empty(),this.documentState=0,this}convertToUnknownDocument(i){return this.version=i,this.documentType=3,this.data=qe.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(i){return i instanceof ue&&this.key.isEqual(i.key)&&this.version.isEqual(i.version)&&this.documentType===i.documentType&&this.documentState===i.documentState&&this.data.isEqual(i.data)}clone(){return new ue(this.key,this.documentType,this.version,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Pf{constructor(i,r=null,o=[],a=[],c=null,l=null,d=null){this.path=i,this.collectionGroup=r,this.orderBy=o,this.filters=a,this.limit=c,this.startAt=l,this.endAt=d,this.A=null}}function Jl(s,i=null,r=[],o=[],a=null,c=null,l=null){return new Pf(s,i,r,o,a,c,l)}function Cr(s){const i=M(s);if(null===i.A){let r=i.path.canonicalString();null!==i.collectionGroup&&(r+="|cg:"+i.collectionGroup),r+="|f:",r+=i.filters.map(o=>function(s){return s.field.canonicalString()+s.op.toString()+Fo(s.value)}(o)).join(","),r+="|ob:",r+=i.orderBy.map(o=>{return(a=o).field.canonicalString()+a.dir;var a}).join(","),Gn(i.limit)||(r+="|l:",r+=i.limit),i.startAt&&(r+="|lb:",r+=As(i.startAt)),i.endAt&&(r+="|ub:",r+=As(i.endAt)),i.A=r}return i.A}function xs(s,i){if(s.limit!==i.limit||s.orderBy.length!==i.orderBy.length)return!1;for(let a=0;a<s.orderBy.length;a++)if(!qf(s.orderBy[a],i.orderBy[a]))return!1;if(s.filters.length!==i.filters.length)return!1;for(let a=0;a<s.filters.length;a++)if((r=s.filters[a]).op!==(o=i.filters[a]).op||!r.field.isEqual(o.field)||!At(r.value,o.value))return!1;var r,o;return s.collectionGroup===i.collectionGroup&&!!s.path.isEqual(i.path)&&!!nu(s.startAt,i.startAt)&&nu(s.endAt,i.endAt)}function Cs(s){return V.isDocumentKey(s.path)&&null===s.collectionGroup&&0===s.filters.length}class $e extends class{}{constructor(i,r,o){super(),this.field=i,this.op=r,this.value=o}static create(i,r,o){return i.isKeyField()?"in"===r||"not-in"===r?this.R(i,r,o):new Lf(i,r,o):"array-contains"===r?new Ff(i,o):"in"===r?new Uf(i,o):"not-in"===r?new Vf(i,o):"array-contains-any"===r?new Bf(i,o):new $e(i,r,o)}static R(i,r,o){return"in"===r?new Of(i,o):new Mf(i,o)}matches(i){const r=i.data.field(this.field);return"!="===this.op?null!==r&&this.P(Ei(r,this.value)):null!==r&&zn(this.value)===zn(r)&&this.P(Ei(r,this.value))}P(i){switch(this.op){case"<":return i<0;case"<=":return i<=0;case"==":return 0===i;case"!=":return 0!==i;case">":return i>0;case">=":return i>=0;default:return B()}}v(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}}class Lf extends $e{constructor(i,r,o){super(i,r,o),this.key=V.fromName(o.referenceValue)}matches(i){const r=V.comparator(i.key,this.key);return this.P(r)}}class Of extends $e{constructor(i,r){super(i,"in",r),this.keys=eu(0,r)}matches(i){return this.keys.some(r=>r.isEqual(i.key))}}class Mf extends $e{constructor(i,r){super(i,"not-in",r),this.keys=eu(0,r)}matches(i){return!this.keys.some(r=>r.isEqual(i.key))}}function eu(s,i){var r;return((null===(r=i.arrayValue)||void 0===r?void 0:r.values)||[]).map(o=>V.fromName(o.referenceValue))}class Ff extends $e{constructor(i,r){super(i,"array-contains",r)}matches(i){const r=i.data.field(this.field);return Bo(r)&&Dr(r.arrayValue,this.value)}}class Uf extends $e{constructor(i,r){super(i,"in",r)}matches(i){const r=i.data.field(this.field);return null!==r&&Dr(this.value.arrayValue,r)}}class Vf extends $e{constructor(i,r){super(i,"not-in",r)}matches(i){if(Dr(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const r=i.data.field(this.field);return null!==r&&!Dr(this.value.arrayValue,r)}}class Bf extends $e{constructor(i,r){super(i,"array-contains-any",r)}matches(i){const r=i.data.field(this.field);return!(!Bo(r)||!r.arrayValue.values)&&r.arrayValue.values.some(o=>Dr(this.value.arrayValue,o))}}class Ar{constructor(i,r){this.position=i,this.before=r}}function As(s){return`${s.before?"b":"a"}:${s.position.map(i=>Fo(i)).join(",")}`}class Ii{constructor(i,r="asc"){this.field=i,this.dir=r}}function qf(s,i){return s.dir===i.dir&&s.field.isEqual(i.field)}function tu(s,i,r){let o=0;for(let a=0;a<s.position.length;a++){const c=i[a],l=s.position[a];if(o=c.field.isKeyField()?V.comparator(V.fromName(l.referenceValue),r.key):Ei(l,r.data.field(c.field)),"desc"===c.dir&&(o*=-1),0!==o)break}return s.before?o<=0:o<0}function nu(s,i){if(null===s)return null===i;if(null===i||s.before!==i.before||s.position.length!==i.position.length)return!1;for(let r=0;r<s.position.length;r++)if(!At(s.position[r],i.position[r]))return!1;return!0}class jt{constructor(i,r=null,o=[],a=[],c=null,l="F",d=null,f=null){this.path=i,this.collectionGroup=r,this.explicitOrderBy=o,this.filters=a,this.limit=c,this.limitType=l,this.startAt=d,this.endAt=f,this.V=null,this.S=null}}function iu(s,i,r,o,a,c,l,d){return new jt(s,i,r,o,a,c,l,d)}function Si(s){return new jt(s)}function Rs(s){return!Gn(s.limit)&&"F"===s.limitType}function Ps(s){return!Gn(s.limit)&&"L"===s.limitType}function qo(s){return s.explicitOrderBy.length>0?s.explicitOrderBy[0].field:null}function Go(s){for(const i of s.filters)if(i.v())return i.field;return null}function zo(s){return null!==s.collectionGroup}function Di(s){const i=M(s);if(null===i.V){i.V=[];const r=Go(i),o=qo(i);if(null!==r&&null===o)r.isKeyField()||i.V.push(new Ii(r)),i.V.push(new Ii(Ue.keyField(),"asc"));else{let a=!1;for(const c of i.explicitOrderBy)i.V.push(c),c.field.isKeyField()&&(a=!0);if(!a){const c=i.explicitOrderBy.length>0?i.explicitOrderBy[i.explicitOrderBy.length-1].dir:"asc";i.V.push(new Ii(Ue.keyField(),c))}}}return i.V}function dt(s){const i=M(s);if(!i.S)if("F"===i.limitType)i.S=Jl(i.path,i.collectionGroup,Di(i),i.filters,i.limit,i.startAt,i.endAt);else{const r=[];for(const c of Di(i))r.push(new Ii(c.field,"desc"===c.dir?"asc":"desc"));const o=i.endAt?new Ar(i.endAt.position,!i.endAt.before):null,a=i.startAt?new Ar(i.startAt.position,!i.startAt.before):null;i.S=Jl(i.path,i.collectionGroup,r,i.filters,i.limit,o,a)}return i.S}function ru(s,i,r){return new jt(s.path,s.collectionGroup,s.explicitOrderBy.slice(),s.filters.slice(),i,r,s.startAt,s.endAt)}function Rr(s,i){return xs(dt(s),dt(i))&&s.limitType===i.limitType}function su(s){return`${Cr(dt(s))}|lt:${s.limitType}`}function jo(s){return`Query(target=${function(s){let i=s.path.canonicalString();return null!==s.collectionGroup&&(i+=" collectionGroup="+s.collectionGroup),s.filters.length>0&&(i+=`, filters: [${s.filters.map(r=>{return`${(o=r).field.canonicalString()} ${o.op} ${Fo(o.value)}`;var o}).join(", ")}]`),Gn(s.limit)||(i+=", limit: "+s.limit),s.orderBy.length>0&&(i+=`, orderBy: [${s.orderBy.map(r=>{return`${(o=r).field.canonicalString()} (${o.dir})`;var o}).join(", ")}]`),s.startAt&&(i+=", startAt: "+As(s.startAt)),s.endAt&&(i+=", endAt: "+As(s.endAt)),`Target(${i})`}(dt(s))}; limitType=${s.limitType})`}function Pr(s,i){return i.isFoundDocument()&&function(r,o){const a=o.key.path;return null!==r.collectionGroup?o.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(a):V.isDocumentKey(r.path)?r.path.isEqual(a):r.path.isImmediateParentOf(a)}(s,i)&&function(r,o){for(const a of r.explicitOrderBy)if(!a.field.isKeyField()&&null===o.data.field(a.field))return!1;return!0}(s,i)&&function(r,o){for(const a of r.filters)if(!a.matches(o))return!1;return!0}(s,i)&&(o=i,!((r=s).startAt&&!tu(r.startAt,Di(r),o)||r.endAt&&tu(r.endAt,Di(r),o)));var r,o}function ou(s){return(i,r)=>{let o=!1;for(const a of Di(s)){const c=Gf(a,i,r);if(0!==c)return c;o=o||a.field.isKeyField()}return 0}}function Gf(s,i,r){const o=s.field.isKeyField()?V.comparator(i.key,r.key):function(a,c,l){const d=c.data.field(a),f=l.data.field(a);return null!==d&&null!==f?Ei(d,f):B()}(s.field,i,r);switch(s.dir){case"asc":return o;case"desc":return-1*o;default:return B()}}function au(s,i){if(s.D){if(isNaN(i))return{doubleValue:"NaN"};if(i===1/0)return{doubleValue:"Infinity"};if(i===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Is(i)?"-0":i}}function cu(s){return{integerValue:""+s}}function lu(s,i){return Hl(i)?cu(i):au(s,i)}class Ns{constructor(){this._=void 0}}function zf(s,i,r){return s instanceof xi?function(o,a){const c={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:o.seconds,nanos:o.nanoseconds}}}};return a&&(c.fields.__previous_value__=a),{mapValue:c}}(r,i):s instanceof jn?hu(s,i):s instanceof $n?du(s,i):function(o,a){const c=uu(o,a),l=fu(c)+fu(o.C);return Vo(c)&&Vo(o.C)?cu(l):au(o.N,l)}(s,i)}function jf(s,i,r){return s instanceof jn?hu(s,i):s instanceof $n?du(s,i):r}function uu(s,i){return s instanceof Ci?Vo(r=i)||(o=r)&&"doubleValue"in o?i:{integerValue:0}:null;var o,r}class xi extends Ns{}class jn extends Ns{constructor(i){super(),this.elements=i}}function hu(s,i){const r=pu(i);for(const o of s.elements)r.some(a=>At(a,o))||r.push(o);return{arrayValue:{values:r}}}class $n extends Ns{constructor(i){super(),this.elements=i}}function du(s,i){let r=pu(i);for(const o of s.elements)r=r.filter(a=>!At(a,o));return{arrayValue:{values:r}}}class Ci extends Ns{constructor(i,r){super(),this.N=i,this.C=r}}function fu(s){return Ee(s.integerValue||s.doubleValue)}function pu(s){return Bo(s)&&s.arrayValue.values?s.arrayValue.values.slice():[]}class Nr{constructor(i,r){this.field=i,this.transform=r}}class Kf{constructor(i,r){this.version=i,this.transformResults=r}}class Ie{constructor(i,r){this.updateTime=i,this.exists=r}static none(){return new Ie}static exists(i){return new Ie(void 0,i)}static updateTime(i){return new Ie(i)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(i){return this.exists===i.exists&&(this.updateTime?!!i.updateTime&&this.updateTime.isEqual(i.updateTime):!i.updateTime)}}function ks(s,i){return void 0!==s.updateTime?i.isFoundDocument()&&i.version.isEqual(s.updateTime):void 0===s.exists||s.exists===i.isFoundDocument()}class Ls{}function Zf(s,i,r){s instanceof kr?function(o,a,c){const l=o.value.clone(),d=vu(o.fieldTransforms,a,c.transformResults);l.setAll(d),a.convertToFoundDocument(c.version,l).setHasCommittedMutations()}(s,i,r):s instanceof gn?function(o,a,c){if(!ks(o.precondition,a))return void a.convertToUnknownDocument(c.version);const l=vu(o.fieldTransforms,a,c.transformResults),d=a.data;d.setAll(yu(o)),d.setAll(l),a.convertToFoundDocument(c.version,d).setHasCommittedMutations()}(s,i,r):i.convertToNoDocument(r.version).setHasCommittedMutations()}function $o(s,i,r){var a;s instanceof kr?function(o,a,c){if(!ks(o.precondition,a))return;const l=o.value.clone(),d=_u(o.fieldTransforms,c,a);l.setAll(d),a.convertToFoundDocument(mu(a),l).setHasLocalMutations()}(s,i,r):s instanceof gn?function(o,a,c){if(!ks(o.precondition,a))return;const l=_u(o.fieldTransforms,c,a),d=a.data;d.setAll(yu(o)),d.setAll(l),a.convertToFoundDocument(mu(a),d).setHasLocalMutations()}(s,i,r):ks(s.precondition,a=i)&&a.convertToNoDocument(Y.min())}function Hf(s,i){let r=null;for(const o of s.fieldTransforms){const a=i.data.field(o.field),c=uu(o.transform,a||null);null!=c&&(null==r&&(r=qe.empty()),r.set(o.field,c))}return r||null}function gu(s,i){return s.type===i.type&&!!s.key.isEqual(i.key)&&!!s.precondition.isEqual(i.precondition)&&(o=i.fieldTransforms,!!(void 0===(r=s.fieldTransforms)&&void 0===o||r&&o&&wi(r,o,(a,c)=>function(s,i){return s.field.isEqual(i.field)&&(o=i.transform,(r=s.transform)instanceof jn&&o instanceof jn||r instanceof $n&&o instanceof $n?wi(r.elements,o.elements,At):r instanceof Ci&&o instanceof Ci?At(r.C,o.C):r instanceof xi&&o instanceof xi);var r,o}(a,c))))&&(0===s.type?s.value.isEqual(i.value):1!==s.type||s.data.isEqual(i.data)&&s.fieldMask.isEqual(i.fieldMask));var r,o}function mu(s){return s.isFoundDocument()?s.version:Y.min()}class kr extends Ls{constructor(i,r,o,a=[]){super(),this.key=i,this.value=r,this.precondition=o,this.fieldTransforms=a,this.type=0}}class gn extends Ls{constructor(i,r,o,a,c=[]){super(),this.key=i,this.data=r,this.fieldMask=o,this.precondition=a,this.fieldTransforms=c,this.type=1}}function yu(s){const i=new Map;return s.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){const o=s.data.field(r);i.set(r,o)}}),i}function vu(s,i,r){const o=new Map;K(s.length===r.length);for(let a=0;a<r.length;a++){const c=s[a],l=c.transform,d=i.data.field(c.field);o.set(c.field,jf(l,d,r[a]))}return o}function _u(s,i,r){const o=new Map;for(const a of s){const c=a.transform,l=r.data.field(a.field);o.set(a.field,zf(c,l,i))}return o}class Lr extends Ls{constructor(i,r){super(),this.key=i,this.precondition=r,this.type=2,this.fieldTransforms=[]}}class Ko extends Ls{constructor(i,r){super(),this.key=i,this.precondition=r,this.type=3,this.fieldTransforms=[]}}class Yf{constructor(i){this.count=i}}var Se,J;function wu(s){switch(s){case D.OK:return B();case D.CANCELLED:case D.UNKNOWN:case D.DEADLINE_EXCEEDED:case D.RESOURCE_EXHAUSTED:case D.INTERNAL:case D.UNAVAILABLE:case D.UNAUTHENTICATED:return!1;case D.INVALID_ARGUMENT:case D.NOT_FOUND:case D.ALREADY_EXISTS:case D.PERMISSION_DENIED:case D.FAILED_PRECONDITION:case D.ABORTED:case D.OUT_OF_RANGE:case D.UNIMPLEMENTED:case D.DATA_LOSS:return!0;default:return B()}}function bu(s){if(void 0===s)return Te("GRPC error has no .code"),D.UNKNOWN;switch(s){case Se.OK:return D.OK;case Se.CANCELLED:return D.CANCELLED;case Se.UNKNOWN:return D.UNKNOWN;case Se.DEADLINE_EXCEEDED:return D.DEADLINE_EXCEEDED;case Se.RESOURCE_EXHAUSTED:return D.RESOURCE_EXHAUSTED;case Se.INTERNAL:return D.INTERNAL;case Se.UNAVAILABLE:return D.UNAVAILABLE;case Se.UNAUTHENTICATED:return D.UNAUTHENTICATED;case Se.INVALID_ARGUMENT:return D.INVALID_ARGUMENT;case Se.NOT_FOUND:return D.NOT_FOUND;case Se.ALREADY_EXISTS:return D.ALREADY_EXISTS;case Se.PERMISSION_DENIED:return D.PERMISSION_DENIED;case Se.FAILED_PRECONDITION:return D.FAILED_PRECONDITION;case Se.ABORTED:return D.ABORTED;case Se.OUT_OF_RANGE:return D.OUT_OF_RANGE;case Se.UNIMPLEMENTED:return D.UNIMPLEMENTED;case Se.DATA_LOSS:return D.DATA_LOSS;default:return B()}}(J=Se||(Se={}))[J.OK=0]="OK",J[J.CANCELLED=1]="CANCELLED",J[J.UNKNOWN=2]="UNKNOWN",J[J.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",J[J.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",J[J.NOT_FOUND=5]="NOT_FOUND",J[J.ALREADY_EXISTS=6]="ALREADY_EXISTS",J[J.PERMISSION_DENIED=7]="PERMISSION_DENIED",J[J.UNAUTHENTICATED=16]="UNAUTHENTICATED",J[J.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",J[J.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",J[J.ABORTED=10]="ABORTED",J[J.OUT_OF_RANGE=11]="OUT_OF_RANGE",J[J.UNIMPLEMENTED=12]="UNIMPLEMENTED",J[J.INTERNAL=13]="INTERNAL",J[J.UNAVAILABLE=14]="UNAVAILABLE",J[J.DATA_LOSS=15]="DATA_LOSS";class Ce{constructor(i,r){this.comparator=i,this.root=r||Ve.EMPTY}insert(i,r){return new Ce(this.comparator,this.root.insert(i,r,this.comparator).copy(null,null,Ve.BLACK,null,null))}remove(i){return new Ce(this.comparator,this.root.remove(i,this.comparator).copy(null,null,Ve.BLACK,null,null))}get(i){let r=this.root;for(;!r.isEmpty();){const o=this.comparator(i,r.key);if(0===o)return r.value;o<0?r=r.left:o>0&&(r=r.right)}return null}indexOf(i){let r=0,o=this.root;for(;!o.isEmpty();){const a=this.comparator(i,o.key);if(0===a)return r+o.left.size;a<0?o=o.left:(r+=o.left.size+1,o=o.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(i){return this.root.inorderTraversal(i)}forEach(i){this.inorderTraversal((r,o)=>(i(r,o),!1))}toString(){const i=[];return this.inorderTraversal((r,o)=>(i.push(`${r}:${o}`),!1)),`{${i.join(", ")}}`}reverseTraversal(i){return this.root.reverseTraversal(i)}getIterator(){return new Os(this.root,null,this.comparator,!1)}getIteratorFrom(i){return new Os(this.root,i,this.comparator,!1)}getReverseIterator(){return new Os(this.root,null,this.comparator,!0)}getReverseIteratorFrom(i){return new Os(this.root,i,this.comparator,!0)}}class Os{constructor(i,r,o,a){this.isReverse=a,this.nodeStack=[];let c=1;for(;!i.isEmpty();)if(c=r?o(i.key,r):1,a&&(c*=-1),c<0)i=this.isReverse?i.left:i.right;else{if(0===c){this.nodeStack.push(i);break}this.nodeStack.push(i),i=this.isReverse?i.right:i.left}}getNext(){let i=this.nodeStack.pop();const r={key:i.key,value:i.value};if(this.isReverse)for(i=i.left;!i.isEmpty();)this.nodeStack.push(i),i=i.right;else for(i=i.right;!i.isEmpty();)this.nodeStack.push(i),i=i.left;return r}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const i=this.nodeStack[this.nodeStack.length-1];return{key:i.key,value:i.value}}}class Ve{constructor(i,r,o,a,c){this.key=i,this.value=r,this.color=null!=o?o:Ve.RED,this.left=null!=a?a:Ve.EMPTY,this.right=null!=c?c:Ve.EMPTY,this.size=this.left.size+1+this.right.size}copy(i,r,o,a,c){return new Ve(null!=i?i:this.key,null!=r?r:this.value,null!=o?o:this.color,null!=a?a:this.left,null!=c?c:this.right)}isEmpty(){return!1}inorderTraversal(i){return this.left.inorderTraversal(i)||i(this.key,this.value)||this.right.inorderTraversal(i)}reverseTraversal(i){return this.right.reverseTraversal(i)||i(this.key,this.value)||this.left.reverseTraversal(i)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(i,r,o){let a=this;const c=o(i,a.key);return a=c<0?a.copy(null,null,null,a.left.insert(i,r,o),null):0===c?a.copy(null,r,null,null,null):a.copy(null,null,null,null,a.right.insert(i,r,o)),a.fixUp()}removeMin(){if(this.left.isEmpty())return Ve.EMPTY;let i=this;return i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.removeMin(),null),i.fixUp()}remove(i,r){let o,a=this;if(r(i,a.key)<0)a.left.isEmpty()||a.left.isRed()||a.left.left.isRed()||(a=a.moveRedLeft()),a=a.copy(null,null,null,a.left.remove(i,r),null);else{if(a.left.isRed()&&(a=a.rotateRight()),a.right.isEmpty()||a.right.isRed()||a.right.left.isRed()||(a=a.moveRedRight()),0===r(i,a.key)){if(a.right.isEmpty())return Ve.EMPTY;o=a.right.min(),a=a.copy(o.key,o.value,null,null,a.right.removeMin())}a=a.copy(null,null,null,null,a.right.remove(i,r))}return a.fixUp()}isRed(){return this.color}fixUp(){let i=this;return i.right.isRed()&&!i.left.isRed()&&(i=i.rotateLeft()),i.left.isRed()&&i.left.left.isRed()&&(i=i.rotateRight()),i.left.isRed()&&i.right.isRed()&&(i=i.colorFlip()),i}moveRedLeft(){let i=this.colorFlip();return i.right.left.isRed()&&(i=i.copy(null,null,null,null,i.right.rotateRight()),i=i.rotateLeft(),i=i.colorFlip()),i}moveRedRight(){let i=this.colorFlip();return i.left.left.isRed()&&(i=i.rotateRight(),i=i.colorFlip()),i}rotateLeft(){const i=this.copy(null,null,Ve.RED,null,this.right.left);return this.right.copy(null,null,this.color,i,null)}rotateRight(){const i=this.copy(null,null,Ve.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,i)}colorFlip(){const i=this.left.copy(null,null,!this.left.color,null,null),r=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,i,r)}checkMaxDepth(){const i=this.check();return Math.pow(2,i)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw B();const i=this.left.check();if(i!==this.right.check())throw B();return i+(this.isRed()?0:1)}}Ve.EMPTY=null,Ve.RED=!0,Ve.BLACK=!1,Ve.EMPTY=new class{constructor(){this.size=0}get key(){throw B()}get value(){throw B()}get color(){throw B()}get left(){throw B()}get right(){throw B()}copy(s,i,r,o,a){return this}insert(s,i,r){return new Ve(s,i)}remove(s,i){return this}isEmpty(){return!0}inorderTraversal(s){return!1}reverseTraversal(s){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class pe{constructor(i){this.comparator=i,this.data=new Ce(this.comparator)}has(i){return null!==this.data.get(i)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(i){return this.data.indexOf(i)}forEach(i){this.data.inorderTraversal((r,o)=>(i(r),!1))}forEachInRange(i,r){const o=this.data.getIteratorFrom(i[0]);for(;o.hasNext();){const a=o.getNext();if(this.comparator(a.key,i[1])>=0)return;r(a.key)}}forEachWhile(i,r){let o;for(o=void 0!==r?this.data.getIteratorFrom(r):this.data.getIterator();o.hasNext();)if(!i(o.getNext().key))return}firstAfterOrEqual(i){const r=this.data.getIteratorFrom(i);return r.hasNext()?r.getNext().key:null}getIterator(){return new Tu(this.data.getIterator())}getIteratorFrom(i){return new Tu(this.data.getIteratorFrom(i))}add(i){return this.copy(this.data.remove(i).insert(i,!0))}delete(i){return this.has(i)?this.copy(this.data.remove(i)):this}isEmpty(){return this.data.isEmpty()}unionWith(i){let r=this;return r.size<i.size&&(r=i,i=this),i.forEach(o=>{r=r.add(o)}),r}isEqual(i){if(!(i instanceof pe)||this.size!==i.size)return!1;const r=this.data.getIterator(),o=i.data.getIterator();for(;r.hasNext();){const a=r.getNext().key,c=o.getNext().key;if(0!==this.comparator(a,c))return!1}return!0}toArray(){const i=[];return this.forEach(r=>{i.push(r)}),i}toString(){const i=[];return this.forEach(r=>i.push(r)),"SortedSet("+i.toString()+")"}copy(i){const r=new pe(this.comparator);return r.data=i,r}}class Tu{constructor(i){this.iter=i}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}const Qf=new Ce(V.comparator);function ft(){return Qf}const Wf=new Ce(V.comparator);function Zo(){return Wf}const Xf=new Ce(V.comparator);function Eu(){return Xf}const Jf=new pe(V.comparator);function ie(...s){let i=Jf;for(const r of s)i=i.add(r);return i}const ep=new pe(X);function Ms(){return ep}class Or{constructor(i,r,o,a,c){this.snapshotVersion=i,this.targetChanges=r,this.targetMismatches=o,this.documentUpdates=a,this.resolvedLimboDocuments=c}static createSynthesizedRemoteEventForCurrentChange(i,r){const o=new Map;return o.set(i,Mr.createSynthesizedTargetChangeForCurrentChange(i,r)),new Or(Y.min(),o,Ms(),ft(),ie())}}class Mr{constructor(i,r,o,a,c){this.resumeToken=i,this.current=r,this.addedDocuments=o,this.modifiedDocuments=a,this.removedDocuments=c}static createSynthesizedTargetChangeForCurrentChange(i,r){return new Mr(ke.EMPTY_BYTE_STRING,r,ie(),ie(),ie())}}class Fs{constructor(i,r,o,a){this.k=i,this.removedTargetIds=r,this.key=o,this.$=a}}class Iu{constructor(i,r){this.targetId=i,this.O=r}}class Su{constructor(i,r,o=ke.EMPTY_BYTE_STRING,a=null){this.state=i,this.targetIds=r,this.resumeToken=o,this.cause=a}}class Du{constructor(){this.F=0,this.M=Cu(),this.L=ke.EMPTY_BYTE_STRING,this.B=!1,this.U=!0}get current(){return this.B}get resumeToken(){return this.L}get q(){return 0!==this.F}get K(){return this.U}j(i){i.approximateByteSize()>0&&(this.U=!0,this.L=i)}W(){let i=ie(),r=ie(),o=ie();return this.M.forEach((a,c)=>{switch(c){case 0:i=i.add(a);break;case 2:r=r.add(a);break;case 1:o=o.add(a);break;default:B()}}),new Mr(this.L,this.B,i,r,o)}G(){this.U=!1,this.M=Cu()}H(i,r){this.U=!0,this.M=this.M.insert(i,r)}J(i){this.U=!0,this.M=this.M.remove(i)}Y(){this.F+=1}X(){this.F-=1}Z(){this.U=!0,this.B=!0}}class tp{constructor(i){this.tt=i,this.et=new Map,this.nt=ft(),this.st=xu(),this.it=new pe(X)}rt(i){for(const r of i.k)i.$&&i.$.isFoundDocument()?this.ot(r,i.$):this.at(r,i.key,i.$);for(const r of i.removedTargetIds)this.at(r,i.key,i.$)}ct(i){this.forEachTarget(i,r=>{const o=this.ut(r);switch(i.state){case 0:this.ht(r)&&o.j(i.resumeToken);break;case 1:o.X(),o.q||o.G(),o.j(i.resumeToken);break;case 2:o.X(),o.q||this.removeTarget(r);break;case 3:this.ht(r)&&(o.Z(),o.j(i.resumeToken));break;case 4:this.ht(r)&&(this.lt(r),o.j(i.resumeToken));break;default:B()}})}forEachTarget(i,r){i.targetIds.length>0?i.targetIds.forEach(r):this.et.forEach((o,a)=>{this.ht(a)&&r(a)})}ft(i){const r=i.targetId,o=i.O.count,a=this.dt(r);if(a){const c=a.target;if(Cs(c))if(0===o){const l=new V(c.path);this.at(r,l,ue.newNoDocument(l,Y.min()))}else K(1===o);else this.wt(r)!==o&&(this.lt(r),this.it=this.it.add(r))}}_t(i){const r=new Map;this.et.forEach((c,l)=>{const d=this.dt(l);if(d){if(c.current&&Cs(d.target)){const f=new V(d.target.path);null!==this.nt.get(f)||this.gt(l,f)||this.at(l,f,ue.newNoDocument(f,i))}c.K&&(r.set(l,c.W()),c.G())}});let o=ie();this.st.forEach((c,l)=>{let d=!0;l.forEachWhile(f=>{const m=this.dt(f);return!m||2===m.purpose||(d=!1,!1)}),d&&(o=o.add(c))});const a=new Or(i,r,this.it,this.nt,o);return this.nt=ft(),this.st=xu(),this.it=new pe(X),a}ot(i,r){if(!this.ht(i))return;const o=this.gt(i,r.key)?2:0;this.ut(i).H(r.key,o),this.nt=this.nt.insert(r.key,r),this.st=this.st.insert(r.key,this.yt(r.key).add(i))}at(i,r,o){if(!this.ht(i))return;const a=this.ut(i);this.gt(i,r)?a.H(r,1):a.J(r),this.st=this.st.insert(r,this.yt(r).delete(i)),o&&(this.nt=this.nt.insert(r,o))}removeTarget(i){this.et.delete(i)}wt(i){const r=this.ut(i).W();return this.tt.getRemoteKeysForTarget(i).size+r.addedDocuments.size-r.removedDocuments.size}Y(i){this.ut(i).Y()}ut(i){let r=this.et.get(i);return r||(r=new Du,this.et.set(i,r)),r}yt(i){let r=this.st.get(i);return r||(r=new pe(X),this.st=this.st.insert(i,r)),r}ht(i){const r=null!==this.dt(i);return r||L("WatchChangeAggregator","Detected inactive target",i),r}dt(i){const r=this.et.get(i);return r&&r.q?null:this.tt.Et(i)}lt(i){this.et.set(i,new Du),this.tt.getRemoteKeysForTarget(i).forEach(r=>{this.at(i,r,null)})}gt(i,r){return this.tt.getRemoteKeysForTarget(i).has(r)}}function xu(){return new Ce(V.comparator)}function Cu(){return new Ce(V.comparator)}const np={asc:"ASCENDING",desc:"DESCENDING"},ip={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"};class rp{constructor(i,r){this.databaseId=i,this.D=r}}function Fr(s,i){return s.D?`${new Date(1e3*i.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+i.nanoseconds).slice(-9)}Z`:{seconds:""+i.seconds,nanos:i.nanoseconds}}function Au(s,i){return s.D?i.toBase64():i.toUint8Array()}function sp(s,i){return Fr(s,i.toTimestamp())}function Le(s){return K(!!s),Y.fromTimestamp(function(i){const r=pn(i);return new Ne(r.seconds,r.nanos)}(s))}function Ho(s,i){return(r=s,new te(["projects",r.projectId,"databases",r.database])).child("documents").child(i).canonicalString();var r}function Ru(s){const i=te.fromString(s);return K(Gu(i)),i}function Ur(s,i){return Ho(s.databaseId,i.path)}function Rt(s,i){const r=Ru(i);if(r.get(1)!==s.databaseId.projectId)throw new k(D.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+r.get(1)+" vs "+s.databaseId.projectId);if(r.get(3)!==s.databaseId.database)throw new k(D.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+r.get(3)+" vs "+s.databaseId.database);return new V(Nu(r))}function Yo(s,i){return Ho(s.databaseId,i)}function Pu(s){const i=Ru(s);return 4===i.length?te.emptyPath():Nu(i)}function Vr(s){return new te(["projects",s.databaseId.projectId,"databases",s.databaseId.database]).canonicalString()}function Nu(s){return K(s.length>4&&"documents"===s.get(4)),s.popFirst(5)}function ku(s,i,r){return{name:Ur(s,i),fields:r.value.mapValue.fields}}function Lu(s,i,r){const o=Rt(s,i.name),a=Le(i.updateTime),c=new qe({mapValue:{fields:i.fields}}),l=ue.newFoundDocument(o,a,c);return r&&l.setHasCommittedMutations(),r?l.setHasCommittedMutations():l}function Us(s,i){let r;if(i instanceof kr)r={update:ku(s,i.key,i.value)};else if(i instanceof Lr)r={delete:Ur(s,i.key)};else if(i instanceof gn)r={update:ku(s,i.key,i.data),updateMask:pp(i.fieldMask)};else{if(!(i instanceof Ko))return B();r={verify:Ur(s,i.key)}}return i.fieldTransforms.length>0&&(r.updateTransforms=i.fieldTransforms.map(o=>function(a,c){const l=c.transform;if(l instanceof xi)return{fieldPath:c.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof jn)return{fieldPath:c.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof $n)return{fieldPath:c.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof Ci)return{fieldPath:c.field.canonicalString(),increment:l.C};throw B()}(0,o))),i.precondition.isNone||(r.currentDocument=void 0!==(a=i.precondition).updateTime?{updateTime:sp(s,a.updateTime)}:void 0!==a.exists?{exists:a.exists}:B()),r;var a}function Ou(s,i){const r=i.currentDocument?void 0!==(a=i.currentDocument).updateTime?Ie.updateTime(Le(a.updateTime)):void 0!==a.exists?Ie.exists(a.exists):Ie.none():Ie.none(),o=i.updateTransforms?i.updateTransforms.map(a=>function(c,l){let d=null;"setToServerValue"in l?(K("REQUEST_TIME"===l.setToServerValue),d=new xi):"appendMissingElements"in l?d=new jn(l.appendMissingElements.values||[]):"removeAllFromArray"in l?d=new $n(l.removeAllFromArray.values||[]):"increment"in l?d=new Ci(c,l.increment):B();const f=Ue.fromServerFormat(l.fieldPath);return new Nr(f,d)}(s,a)):[];var a;if(i.update){const a=Rt(s,i.update.name),c=new qe({mapValue:{fields:i.update.fields}});if(i.updateMask){const l=new bi((i.updateMask.fieldPaths||[]).map(m=>Ue.fromServerFormat(m)));return new gn(a,c,l,r,o)}return new kr(a,c,r,o)}if(i.delete){const a=Rt(s,i.delete);return new Lr(a,r)}if(i.verify){const a=Rt(s,i.verify);return new Ko(a,r)}return B()}function Mu(s,i){return{documents:[Yo(s,i.path)]}}function Fu(s,i){const r={structuredQuery:{}},o=i.path;null!==i.collectionGroup?(r.parent=Yo(s,o),r.structuredQuery.from=[{collectionId:i.collectionGroup,allDescendants:!0}]):(r.parent=Yo(s,o.popLast()),r.structuredQuery.from=[{collectionId:o.lastSegment()}]);const a=function(d){if(0===d.length)return;const f=d.map(m=>function(w){if("=="===w.op){if(Wl(w.value))return{unaryFilter:{field:Ai(w.field),op:"IS_NAN"}};if(Ql(w.value))return{unaryFilter:{field:Ai(w.field),op:"IS_NULL"}}}else if("!="===w.op){if(Wl(w.value))return{unaryFilter:{field:Ai(w.field),op:"IS_NOT_NAN"}};if(Ql(w.value))return{unaryFilter:{field:Ai(w.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ai(w.field),op:hp(w.op),value:w.value}}}(m));return 1===f.length?f[0]:{compositeFilter:{op:"AND",filters:f}}}(i.filters);a&&(r.structuredQuery.where=a);const c=function(d){if(0!==d.length)return d.map(f=>{return{field:Ai((m=f).field),direction:up(m.dir)};var m})}(i.orderBy);c&&(r.structuredQuery.orderBy=c);const l=(f=i.limit,s.D||Gn(f)?f:{value:f});var f;return null!==l&&(r.structuredQuery.limit=l),i.startAt&&(r.structuredQuery.startAt=Bu(i.startAt)),i.endAt&&(r.structuredQuery.endAt=Bu(i.endAt)),r}function Uu(s){let i=Pu(s.parent);const r=s.structuredQuery,o=r.from?r.from.length:0;let a=null;if(o>0){K(1===o);const w=r.from[0];w.allDescendants?a=w.collectionId:i=i.child(w.collectionId)}let c=[];r.where&&(c=Vu(r.where));let l=[];r.orderBy&&(l=r.orderBy.map(w=>{return new Ii(Ri((b=w).field),function(x){switch(x){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(b.direction));var b}));let d=null;r.limit&&(d=function(w){let b;return b="object"==typeof w?w.value:w,Gn(b)?null:b}(r.limit));let f=null;r.startAt&&(f=qu(r.startAt));let m=null;return r.endAt&&(m=qu(r.endAt)),iu(i,a,l,c,d,"F",f,m)}function Vu(s){return s?void 0!==s.unaryFilter?[fp(s)]:void 0!==s.fieldFilter?[dp(s)]:void 0!==s.compositeFilter?s.compositeFilter.filters.map(i=>Vu(i)).reduce((i,r)=>i.concat(r)):B():[]}function Bu(s){return{before:s.before,values:s.position}}function qu(s){return new Ar(s.values||[],!!s.before)}function up(s){return np[s]}function hp(s){return ip[s]}function Ai(s){return{fieldPath:s.canonicalString()}}function Ri(s){return Ue.fromServerFormat(s.fieldPath)}function dp(s){return $e.create(Ri(s.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return B()}}(s.fieldFilter.op),s.fieldFilter.value)}function fp(s){switch(s.unaryFilter.op){case"IS_NAN":const i=Ri(s.unaryFilter.field);return $e.create(i,"==",{doubleValue:NaN});case"IS_NULL":const r=Ri(s.unaryFilter.field);return $e.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const o=Ri(s.unaryFilter.field);return $e.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const a=Ri(s.unaryFilter.field);return $e.create(a,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return B()}}function pp(s){const i=[];return s.fields.forEach(r=>i.push(r.canonicalString())),{fieldPaths:i}}function Gu(s){return s.length>=4&&"projects"===s.get(0)&&"databases"===s.get(2)}function wt(s){let i="";for(let r=0;r<s.length;r++)i.length>0&&(i=zu(i)),i=gp(s.get(r),i);return zu(i)}function gp(s,i){let r=i;const o=s.length;for(let a=0;a<o;a++){const c=s.charAt(a);switch(c){case"\0":r+="\x01\x10";break;case"\x01":r+="\x01\x11";break;default:r+=c}}return r}function zu(s){return s+"\x01\x01"}function $t(s){const i=s.length;if(K(i>=2),2===i)return K("\x01"===s.charAt(0)&&"\x01"===s.charAt(1)),te.emptyPath();const r=i-2,o=[];let a="";for(let c=0;c<i;){const l=s.indexOf("\x01",c);switch((l<0||l>r)&&B(),s.charAt(l+1)){case"\x01":const d=s.substring(c,l);let f;0===a.length?f=d:(a+=d,f=a,a=""),o.push(f);break;case"\x10":a+=s.substring(c,l),a+="\0";break;case"\x11":a+=s.substring(c,l+1);break;default:B()}c=l+2}return new te(o)}class mp{constructor(i,r){this.seconds=i,this.nanoseconds=r}}class at{constructor(i,r,o){this.ownerId=i,this.allowTabSynchronization=r,this.leaseTimestampMs=o}}at.store="owner",at.key="owner";class mn{constructor(i,r,o){this.userId=i,this.lastAcknowledgedBatchId=r,this.lastStreamToken=o}}mn.store="mutationQueues",mn.keyPath="userId";class ae{constructor(i,r,o,a,c){this.userId=i,this.batchId=r,this.localWriteTimeMs=o,this.baseMutations=a,this.mutations=c}}ae.store="mutations",ae.keyPath="batchId",ae.userMutationsIndex="userMutationsIndex",ae.userMutationsKeyPath=["userId","batchId"];class Ge{constructor(){}static prefixForUser(i){return[i]}static prefixForPath(i,r){return[i,wt(r)]}static key(i,r,o){return[i,wt(r),o]}}Ge.store="documentMutations",Ge.PLACEHOLDER=new Ge;class yp{constructor(i,r){this.path=i,this.readTime=r}}class vp{constructor(i,r){this.path=i,this.version=r}}class ge{constructor(i,r,o,a,c,l){this.unknownDocument=i,this.noDocument=r,this.document=o,this.hasCommittedMutations=a,this.readTime=c,this.parentPath=l}}ge.store="remoteDocuments",ge.readTimeIndex="readTimeIndex",ge.readTimeIndexPath="readTime",ge.collectionReadTimeIndex="collectionReadTimeIndex",ge.collectionReadTimeIndexPath=["parentPath","readTime"];class Pt{constructor(i){this.byteSize=i}}Pt.store="remoteDocumentGlobal",Pt.key="remoteDocumentGlobalKey";class Je{constructor(i,r,o,a,c,l,d){this.targetId=i,this.canonicalId=r,this.readTime=o,this.resumeToken=a,this.lastListenSequenceNumber=c,this.lastLimboFreeSnapshotVersion=l,this.query=d}}Je.store="targets",Je.keyPath="targetId",Je.queryTargetsIndexName="queryTargetsIndex",Je.queryTargetsKeyPath=["canonicalId","targetId"];class Be{constructor(i,r,o){this.targetId=i,this.path=r,this.sequenceNumber=o}}Be.store="targetDocuments",Be.keyPath=["targetId","path"],Be.documentTargetsIndex="documentTargetsIndex",Be.documentTargetsKeyPath=["path","targetId"];class ct{constructor(i,r,o,a){this.highestTargetId=i,this.highestListenSequenceNumber=r,this.lastRemoteSnapshotVersion=o,this.targetCount=a}}ct.key="targetGlobalKey",ct.store="targetGlobal";class Kn{constructor(i,r){this.collectionId=i,this.parent=r}}Kn.store="collectionParents",Kn.keyPath=["collectionId","parent"];class Kt{constructor(i,r,o,a){this.clientId=i,this.updateTimeMs=r,this.networkEnabled=o,this.inForeground=a}}Kt.store="clientMetadata",Kt.keyPath="clientId";class Pi{constructor(i,r,o){this.bundleId=i,this.createTime=r,this.version=o}}Pi.store="bundles",Pi.keyPath="bundleId";class Ni{constructor(i,r,o){this.name=i,this.readTime=r,this.bundledQuery=o}}Ni.store="namedQueries",Ni.keyPath="name";const _p=[mn.store,ae.store,Ge.store,ge.store,Je.store,at.store,ct.store,Be.store,Kt.store,Pt.store,Kn.store,Pi.store,Ni.store],ju="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class $u{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(i){this.onCommittedListeners.push(i)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(i=>i())}}class N{constructor(i){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,i(r=>{this.isDone=!0,this.result=r,this.nextCallback&&this.nextCallback(r)},r=>{this.isDone=!0,this.error=r,this.catchCallback&&this.catchCallback(r)})}catch(i){return this.next(void 0,i)}next(i,r){return this.callbackAttached&&B(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(r,this.error):this.wrapSuccess(i,this.result):new N((o,a)=>{this.nextCallback=c=>{this.wrapSuccess(i,c).next(o,a)},this.catchCallback=c=>{this.wrapFailure(r,c).next(o,a)}})}toPromise(){return new Promise((i,r)=>{this.next(i,r)})}wrapUserFunction(i){try{const r=i();return r instanceof N?r:N.resolve(r)}catch(r){return N.reject(r)}}wrapSuccess(i,r){return i?this.wrapUserFunction(()=>i(r)):N.resolve(r)}wrapFailure(i,r){return i?this.wrapUserFunction(()=>i(r)):N.reject(r)}static resolve(i){return new N((r,o)=>{r(i)})}static reject(i){return new N((r,o)=>{o(i)})}static waitFor(i){return new N((r,o)=>{let a=0,c=0,l=!1;i.forEach(d=>{++a,d.next(()=>{++c,l&&c===a&&r()},f=>o(f))}),l=!0,c===a&&r()})}static or(i){let r=N.resolve(!1);for(const o of i)r=r.next(a=>a?N.resolve(a):o());return r}static forEach(i,r){const o=[];return i.forEach((a,c)=>{o.push(r.call(this,a,c))}),this.waitFor(o)}}class Vs{constructor(i,r){this.action=i,this.transaction=r,this.aborted=!1,this.Tt=new Pe,this.transaction.oncomplete=()=>{this.Tt.resolve()},this.transaction.onabort=()=>{r.error?this.Tt.reject(new Br(i,r.error)):this.Tt.resolve()},this.transaction.onerror=o=>{const a=Qo(o.target.error);this.Tt.reject(new Br(i,a))}}static open(i,r,o,a){try{return new Vs(r,i.transaction(a,o))}catch(c){throw new Br(r,c)}}get It(){return this.Tt.promise}abort(i){i&&this.Tt.reject(i),this.aborted||(L("SimpleDb","Aborting transaction:",i?i.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}store(i){const r=this.transaction.objectStore(i);return new bp(r)}}class bt{constructor(i,r,o){this.name=i,this.version=r,this.At=o,12.2===bt.Rt((0,W.z$)())&&Te("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(i){return L("SimpleDb","Removing database:",i),Hn(window.indexedDB.deleteDatabase(i)).toPromise()}static Pt(){if("undefined"==typeof indexedDB)return!1;if(bt.bt())return!0;const i=(0,W.z$)(),r=bt.Rt(i),o=0<r&&r<10,a=bt.vt(i),c=0<a&&a<4.5;return!(i.indexOf("MSIE ")>0||i.indexOf("Trident/")>0||i.indexOf("Edge/")>0||o||c)}static bt(){var i;return"undefined"!=typeof process&&"YES"===(null===(i=process.env)||void 0===i?void 0:i.Vt)}static St(i,r){return i.store(r)}static Rt(i){const r=i.match(/i(?:phone|pad|pod) os ([\d_]+)/i),o=r?r[1].split("_").slice(0,2).join("."):"-1";return Number(o)}static vt(i){const r=i.match(/Android ([\d.]+)/i),o=r?r[1].split(".").slice(0,2).join("."):"-1";return Number(o)}Dt(i){var r=this;return(0,C.Z)(function*(){return r.db||(L("SimpleDb","Opening database:",r.name),r.db=yield new Promise((o,a)=>{const c=indexedDB.open(r.name,r.version);c.onsuccess=l=>{o(l.target.result)},c.onblocked=()=>{a(new Br(i,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},c.onerror=l=>{const d=l.target.error;a("VersionError"===d.name?new k(D.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh."):new Br(i,d))},c.onupgradeneeded=l=>{L("SimpleDb",'Database "'+r.name+'" requires upgrade from version:',l.oldVersion),r.At.Ct(l.target.result,c.transaction,l.oldVersion,r.version).next(()=>{L("SimpleDb","Database upgrade to version "+r.version+" complete")})}})),r.Nt&&(r.db.onversionchange=o=>r.Nt(o)),r.db})()}xt(i){this.Nt=i,this.db&&(this.db.onversionchange=r=>i(r))}runTransaction(i,r,o,a){var c=this;return(0,C.Z)(function*(){const l="readonly"===r;let d=0;for(;;){++d;try{c.db=yield c.Dt(i);const f=Vs.open(c.db,i,l?"readonly":"readwrite",o),m=a(f).catch(w=>(f.abort(w),N.reject(w))).toPromise();return m.catch(()=>{}),yield f.It,m}catch(f){const m="FirebaseError"!==f.name&&d<3;if(L("SimpleDb","Transaction failed with error:",f.message,"Retrying:",m),c.close(),!m)return Promise.reject(f)}}})()}close(){this.db&&this.db.close(),this.db=void 0}}class wp{constructor(i){this.kt=i,this.$t=!1,this.Ot=null}get isDone(){return this.$t}get Ft(){return this.Ot}set cursor(i){this.kt=i}done(){this.$t=!0}Mt(i){this.Ot=i}delete(){return Hn(this.kt.delete())}}class Br extends k{constructor(i,r){super(D.UNAVAILABLE,`IndexedDB transaction '${i}' failed: ${r}`),this.name="IndexedDbTransactionError"}}function Zn(s){return"IndexedDbTransactionError"===s.name}class bp{constructor(i){this.store=i}put(i,r){let o;return void 0!==r?(L("SimpleDb","PUT",this.store.name,i,r),o=this.store.put(r,i)):(L("SimpleDb","PUT",this.store.name,"<auto-key>",i),o=this.store.put(i)),Hn(o)}add(i){return L("SimpleDb","ADD",this.store.name,i,i),Hn(this.store.add(i))}get(i){return Hn(this.store.get(i)).next(r=>(void 0===r&&(r=null),L("SimpleDb","GET",this.store.name,i,r),r))}delete(i){return L("SimpleDb","DELETE",this.store.name,i),Hn(this.store.delete(i))}count(){return L("SimpleDb","COUNT",this.store.name),Hn(this.store.count())}Lt(i,r){const o=this.cursor(this.options(i,r)),a=[];return this.Bt(o,(c,l)=>{a.push(l)}).next(()=>a)}Ut(i,r){L("SimpleDb","DELETE ALL",this.store.name);const o=this.options(i,r);o.qt=!1;const a=this.cursor(o);return this.Bt(a,(c,l,d)=>d.delete())}Kt(i,r){let o;r?o=i:(o={},r=i);const a=this.cursor(o);return this.Bt(a,r)}jt(i){const r=this.cursor({});return new N((o,a)=>{r.onerror=c=>{const l=Qo(c.target.error);a(l)},r.onsuccess=c=>{const l=c.target.result;l?i(l.primaryKey,l.value).next(d=>{d?l.continue():o()}):o()}})}Bt(i,r){const o=[];return new N((a,c)=>{i.onerror=l=>{c(l.target.error)},i.onsuccess=l=>{const d=l.target.result;if(!d)return void a();const f=new wp(d),m=r(d.primaryKey,d.value,f);if(m instanceof N){const w=m.catch(b=>(f.done(),N.reject(b)));o.push(w)}f.isDone?a():null===f.Ft?d.continue():d.continue(f.Ft)}}).next(()=>N.waitFor(o))}options(i,r){let o;return void 0!==i&&("string"==typeof i?o=i:r=i),{index:o,range:r}}cursor(i){let r="next";if(i.reverse&&(r="prev"),i.index){const o=this.store.index(i.index);return i.qt?o.openKeyCursor(i.range,r):o.openCursor(i.range,r)}return this.store.openCursor(i.range,r)}}function Hn(s){return new N((i,r)=>{s.onsuccess=o=>{i(o.target.result)},s.onerror=o=>{const a=Qo(o.target.error);r(a)}})}let Ku=!1;function Qo(s){const i=bt.Rt((0,W.z$)());if(i>=12.2&&i<13){const r="An internal error was encountered in the Indexed Database server";if(s.message.indexOf(r)>=0){const o=new k("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${r}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return Ku||(Ku=!0,setTimeout(()=>{throw o},0)),o}}return s}class Zu extends $u{constructor(i,r){super(),this.Qt=i,this.currentSequenceNumber=r}}function et(s,i){const r=M(s);return bt.St(r.Qt,i)}class Wo{constructor(i,r,o,a){this.batchId=i,this.localWriteTime=r,this.baseMutations=o,this.mutations=a}applyToRemoteDocument(i,r){const o=r.mutationResults;for(let a=0;a<this.mutations.length;a++){const c=this.mutations[a];c.key.isEqual(i.key)&&Zf(c,i,o[a])}}applyToLocalView(i){for(const r of this.baseMutations)r.key.isEqual(i.key)&&$o(r,i,this.localWriteTime);for(const r of this.mutations)r.key.isEqual(i.key)&&$o(r,i,this.localWriteTime)}applyToLocalDocumentSet(i){this.mutations.forEach(r=>{const o=i.get(r.key),a=o;this.applyToLocalView(a),o.isValidDocument()||a.convertToNoDocument(Y.min())})}keys(){return this.mutations.reduce((i,r)=>i.add(r.key),ie())}isEqual(i){return this.batchId===i.batchId&&wi(this.mutations,i.mutations,(r,o)=>gu(r,o))&&wi(this.baseMutations,i.baseMutations,(r,o)=>gu(r,o))}}class Xo{constructor(i,r,o,a){this.batch=i,this.commitVersion=r,this.mutationResults=o,this.docVersions=a}static from(i,r,o){K(i.mutations.length===o.length);let a=Eu();const c=i.mutations;for(let l=0;l<c.length;l++)a=a.insert(c[l].key,o[l].version);return new Xo(i,r,o,a)}}class yn{constructor(i,r,o,a,c=Y.min(),l=Y.min(),d=ke.EMPTY_BYTE_STRING){this.target=i,this.targetId=r,this.purpose=o,this.sequenceNumber=a,this.snapshotVersion=c,this.lastLimboFreeSnapshotVersion=l,this.resumeToken=d}withSequenceNumber(i){return new yn(this.target,this.targetId,this.purpose,i,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)}withResumeToken(i,r){return new yn(this.target,this.targetId,this.purpose,this.sequenceNumber,r,this.lastLimboFreeSnapshotVersion,i)}withLastLimboFreeSnapshotVersion(i){return new yn(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,i,this.resumeToken)}}class Hu{constructor(i){this.Wt=i}}function Jo(s,i){if(i.document)return Lu(s.Wt,i.document,!!i.hasCommittedMutations);if(i.noDocument){const r=V.fromSegments(i.noDocument.path),o=Li(i.noDocument.readTime),a=ue.newNoDocument(r,o);return i.hasCommittedMutations?a.setHasCommittedMutations():a}if(i.unknownDocument){const r=V.fromSegments(i.unknownDocument.path),o=Li(i.unknownDocument.version);return ue.newUnknownDocument(r,o)}return B()}function Yu(s,i,r){const o=ea(r),a=i.key.path.popLast().toArray();if(i.isFoundDocument()){const c={name:Ur(d=s.Wt,(f=i).key),fields:f.data.value.mapValue.fields,updateTime:Fr(d,f.version.toTimestamp())};return new ge(null,null,c,i.hasCommittedMutations,o,a)}var d,f;if(i.isNoDocument()){const c=i.key.path.toArray(),l=ki(i.version),d=i.hasCommittedMutations;return new ge(null,new yp(c,l),null,d,o,a)}if(i.isUnknownDocument()){const c=i.key.path.toArray(),l=ki(i.version);return new ge(new vp(c,l),null,null,!0,o,a)}return B()}function ea(s){const i=s.toTimestamp();return[i.seconds,i.nanoseconds]}function Qu(s){const i=new Ne(s[0],s[1]);return Y.fromTimestamp(i)}function ki(s){const i=s.toTimestamp();return new mp(i.seconds,i.nanoseconds)}function Li(s){const i=new Ne(s.seconds,s.nanoseconds);return Y.fromTimestamp(i)}function Oi(s,i){const r=(i.baseMutations||[]).map(c=>Ou(s.Wt,c));for(let c=0;c<i.mutations.length-1;++c){const l=i.mutations[c];c+1<i.mutations.length&&void 0!==i.mutations[c+1].transform&&(l.updateTransforms=i.mutations[c+1].transform.fieldTransforms,i.mutations.splice(c+1,1),++c)}const o=i.mutations.map(c=>Ou(s.Wt,c)),a=Ne.fromMillis(i.localWriteTimeMs);return new Wo(i.batchId,a,r,o)}function qr(s){const i=Li(s.readTime),r=void 0!==s.lastLimboFreeSnapshotVersion?Li(s.lastLimboFreeSnapshotVersion):Y.min();let o;var a;return void 0!==s.query.documents?(K(1===(a=s.query).documents.length),o=dt(Si(Pu(a.documents[0])))):o=dt(Uu(s.query)),new yn(o,s.targetId,0,s.lastListenSequenceNumber,i,r,ke.fromBase64String(s.resumeToken))}function Wu(s,i){const r=ki(i.snapshotVersion),o=ki(i.lastLimboFreeSnapshotVersion);let a;a=Cs(i.target)?Mu(s.Wt,i.target):Fu(s.Wt,i.target);const c=i.resumeToken.toBase64();return new Je(i.targetId,Cr(i.target),r,c,i.sequenceNumber,o,a)}function ta(s){const i=Uu({parent:s.parent,structuredQuery:s.structuredQuery});return"LAST"===s.limitType?ru(i,i.limit,"L"):i}class Tp{getBundleMetadata(i,r){return Xu(i).get(r).next(o=>{if(o)return{id:(a=o).bundleId,createTime:Li(a.createTime),version:a.version};var a})}saveBundleMetadata(i,r){return Xu(i).put({bundleId:(o=r).id,createTime:ki(Le(o.createTime)),version:o.version});var o}getNamedQuery(i,r){return Ju(i).get(r).next(o=>{if(o)return{name:(a=o).name,query:ta(a.bundledQuery),readTime:Li(a.readTime)};var a})}saveNamedQuery(i,r){return Ju(i).put({name:(o=r).name,readTime:ki(Le(o.readTime)),bundledQuery:o.bundledQuery});var o}}function Xu(s){return et(s,Pi.store)}function Ju(s){return et(s,Ni.store)}class Ep{constructor(){this.Gt=new na}addToCollectionParentIndex(i,r){return this.Gt.add(r),N.resolve()}getCollectionParents(i,r){return N.resolve(this.Gt.getEntries(r))}}class na{constructor(){this.index={}}add(i){const r=i.lastSegment(),o=i.popLast(),a=this.index[r]||new pe(te.comparator),c=!a.has(o);return this.index[r]=a.add(o),c}has(i){const r=i.lastSegment(),o=i.popLast(),a=this.index[r];return a&&a.has(o)}getEntries(i){return(this.index[i]||new pe(te.comparator)).toArray()}}class Ip{constructor(){this.zt=new na}addToCollectionParentIndex(i,r){if(!this.zt.has(r)){const o=r.lastSegment(),a=r.popLast();i.addOnCommittedListener(()=>{this.zt.add(r)});const c={collectionId:o,parent:wt(a)};return eh(i).put(c)}return N.resolve()}getCollectionParents(i,r){const o=[],a=IDBKeyRange.bound([r,""],[jl(r),""],!1,!0);return eh(i).Lt(a).next(c=>{for(const l of c){if(l.collectionId!==r)break;o.push($t(l.parent))}return o})}}function eh(s){return et(s,Kn.store)}const th={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class tt{constructor(i,r,o){this.cacheSizeCollectionThreshold=i,this.percentileToCollect=r,this.maximumSequenceNumbersToCollect=o}static withCacheSize(i){return new tt(i,tt.DEFAULT_COLLECTION_PERCENTILE,tt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}function nh(s,i,r){const o=s.store(ae.store),a=s.store(Ge.store),c=[],l=IDBKeyRange.only(r.batchId);let d=0;const f=o.Kt({range:l},(w,b,x)=>(d++,x.delete()));c.push(f.next(()=>{K(1===d)}));const m=[];for(const w of r.mutations){const b=Ge.key(i,w.key.path,r.batchId);c.push(a.delete(b)),m.push(w.key)}return N.waitFor(c).next(()=>m)}function Bs(s){if(!s)return 0;let i;if(s.document)i=s.document;else if(s.unknownDocument)i=s.unknownDocument;else{if(!s.noDocument)throw B();i=s.noDocument}return JSON.stringify(i).length}tt.DEFAULT_COLLECTION_PERCENTILE=10,tt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,tt.DEFAULT=new tt(41943040,tt.DEFAULT_COLLECTION_PERCENTILE,tt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),tt.DISABLED=new tt(-1,0,0);class ia{constructor(i,r,o,a){this.userId=i,this.N=r,this.Ht=o,this.referenceDelegate=a,this.Jt={}}static Yt(i,r,o,a){K(""!==i.uid);const c=i.isAuthenticated()?i.uid:"";return new ia(c,r,o,a)}checkEmpty(i){let r=!0;const o=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return vn(i).Kt({index:ae.userMutationsIndex,range:o},(a,c,l)=>{r=!1,l.done()}).next(()=>r)}addMutationBatch(i,r,o,a){const c=Mi(i),l=vn(i);return l.add({}).next(d=>{K("number"==typeof d);const f=new Wo(d,r,o,a),m=function(x,P,O){const q=O.baseMutations.map(ye=>Us(x.Wt,ye)),H=O.mutations.map(ye=>Us(x.Wt,ye));return new ae(P,O.batchId,O.localWriteTime.toMillis(),q,H)}(this.N,this.userId,f),w=[];let b=new pe((x,P)=>X(x.canonicalString(),P.canonicalString()));for(const x of a){const P=Ge.key(this.userId,x.key.path,d);b=b.add(x.key.path.popLast()),w.push(l.put(m)),w.push(c.put(P,Ge.PLACEHOLDER))}return b.forEach(x=>{w.push(this.Ht.addToCollectionParentIndex(i,x))}),i.addOnCommittedListener(()=>{this.Jt[d]=f.keys()}),N.waitFor(w).next(()=>f)})}lookupMutationBatch(i,r){return vn(i).get(r).next(o=>o?(K(o.userId===this.userId),Oi(this.N,o)):null)}Xt(i,r){return this.Jt[r]?N.resolve(this.Jt[r]):this.lookupMutationBatch(i,r).next(o=>{if(o){const a=o.keys();return this.Jt[r]=a,a}return null})}getNextMutationBatchAfterBatchId(i,r){const o=r+1,a=IDBKeyRange.lowerBound([this.userId,o]);let c=null;return vn(i).Kt({index:ae.userMutationsIndex,range:a},(l,d,f)=>{d.userId===this.userId&&(K(d.batchId>=o),c=Oi(this.N,d)),f.done()}).next(()=>c)}getHighestUnacknowledgedBatchId(i){const r=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let o=-1;return vn(i).Kt({index:ae.userMutationsIndex,range:r,reverse:!0},(a,c,l)=>{o=c.batchId,l.done()}).next(()=>o)}getAllMutationBatches(i){const r=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return vn(i).Lt(ae.userMutationsIndex,r).next(o=>o.map(a=>Oi(this.N,a)))}getAllMutationBatchesAffectingDocumentKey(i,r){const o=Ge.prefixForPath(this.userId,r.path),a=IDBKeyRange.lowerBound(o),c=[];return Mi(i).Kt({range:a},(l,d,f)=>{const[m,w,b]=l,x=$t(w);if(m===this.userId&&r.path.isEqual(x))return vn(i).get(b).next(P=>{if(!P)throw B();K(P.userId===this.userId),c.push(Oi(this.N,P))});f.done()}).next(()=>c)}getAllMutationBatchesAffectingDocumentKeys(i,r){let o=new pe(X);const a=[];return r.forEach(c=>{const l=Ge.prefixForPath(this.userId,c.path),d=IDBKeyRange.lowerBound(l),f=Mi(i).Kt({range:d},(m,w,b)=>{const[x,P,O]=m,q=$t(P);x===this.userId&&c.path.isEqual(q)?o=o.add(O):b.done()});a.push(f)}),N.waitFor(a).next(()=>this.Zt(i,o))}getAllMutationBatchesAffectingQuery(i,r){const o=r.path,a=o.length+1,c=Ge.prefixForPath(this.userId,o),l=IDBKeyRange.lowerBound(c);let d=new pe(X);return Mi(i).Kt({range:l},(f,m,w)=>{const[b,x,P]=f,O=$t(x);b===this.userId&&o.isPrefixOf(O)?O.length===a&&(d=d.add(P)):w.done()}).next(()=>this.Zt(i,d))}Zt(i,r){const o=[],a=[];return r.forEach(c=>{a.push(vn(i).get(c).next(l=>{if(null===l)throw B();K(l.userId===this.userId),o.push(Oi(this.N,l))}))}),N.waitFor(a).next(()=>o)}removeMutationBatch(i,r){return nh(i.Qt,this.userId,r).next(o=>(i.addOnCommittedListener(()=>{this.te(r.batchId)}),N.forEach(o,a=>this.referenceDelegate.markPotentiallyOrphaned(i,a))))}te(i){delete this.Jt[i]}performConsistencyCheck(i){return this.checkEmpty(i).next(r=>{if(!r)return N.resolve();const o=IDBKeyRange.lowerBound(Ge.prefixForUser(this.userId)),a=[];return Mi(i).Kt({range:o},(c,l,d)=>{if(c[0]===this.userId){const f=$t(c[1]);a.push(f)}else d.done()}).next(()=>{K(0===a.length)})})}containsKey(i,r){return ih(i,this.userId,r)}ee(i){return rh(i).get(this.userId).next(r=>r||new mn(this.userId,-1,""))}}function ih(s,i,r){const o=Ge.prefixForPath(i,r.path),a=o[1],c=IDBKeyRange.lowerBound(o);let l=!1;return Mi(s).Kt({range:c,qt:!0},(d,f,m)=>{const[w,b,x]=d;w===i&&b===a&&(l=!0),m.done()}).next(()=>l)}function vn(s){return et(s,ae.store)}function Mi(s){return et(s,Ge.store)}function rh(s){return et(s,mn.store)}class Yn{constructor(i){this.ne=i}next(){return this.ne+=2,this.ne}static se(){return new Yn(0)}static ie(){return new Yn(-1)}}class Sp{constructor(i,r){this.referenceDelegate=i,this.N=r}allocateTargetId(i){return this.re(i).next(r=>{const o=new Yn(r.highestTargetId);return r.highestTargetId=o.next(),this.oe(i,r).next(()=>r.highestTargetId)})}getLastRemoteSnapshotVersion(i){return this.re(i).next(r=>Y.fromTimestamp(new Ne(r.lastRemoteSnapshotVersion.seconds,r.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(i){return this.re(i).next(r=>r.highestListenSequenceNumber)}setTargetsMetadata(i,r,o){return this.re(i).next(a=>(a.highestListenSequenceNumber=r,o&&(a.lastRemoteSnapshotVersion=o.toTimestamp()),r>a.highestListenSequenceNumber&&(a.highestListenSequenceNumber=r),this.oe(i,a)))}addTargetData(i,r){return this.ae(i,r).next(()=>this.re(i).next(o=>(o.targetCount+=1,this.ce(r,o),this.oe(i,o))))}updateTargetData(i,r){return this.ae(i,r)}removeTargetData(i,r){return this.removeMatchingKeysForTargetId(i,r.targetId).next(()=>Fi(i).delete(r.targetId)).next(()=>this.re(i)).next(o=>(K(o.targetCount>0),o.targetCount-=1,this.oe(i,o)))}removeTargets(i,r,o){let a=0;const c=[];return Fi(i).Kt((l,d)=>{const f=qr(d);f.sequenceNumber<=r&&null===o.get(f.targetId)&&(a++,c.push(this.removeTargetData(i,f)))}).next(()=>N.waitFor(c)).next(()=>a)}forEachTarget(i,r){return Fi(i).Kt((o,a)=>{const c=qr(a);r(c)})}re(i){return sh(i).get(ct.key).next(r=>(K(null!==r),r))}oe(i,r){return sh(i).put(ct.key,r)}ae(i,r){return Fi(i).put(Wu(this.N,r))}ce(i,r){let o=!1;return i.targetId>r.highestTargetId&&(r.highestTargetId=i.targetId,o=!0),i.sequenceNumber>r.highestListenSequenceNumber&&(r.highestListenSequenceNumber=i.sequenceNumber,o=!0),o}getTargetCount(i){return this.re(i).next(r=>r.targetCount)}getTargetData(i,r){const o=Cr(r),a=IDBKeyRange.bound([o,Number.NEGATIVE_INFINITY],[o,Number.POSITIVE_INFINITY]);let c=null;return Fi(i).Kt({range:a,index:Je.queryTargetsIndexName},(l,d,f)=>{const m=qr(d);xs(r,m.target)&&(c=m,f.done())}).next(()=>c)}addMatchingKeys(i,r,o){const a=[],c=_n(i);return r.forEach(l=>{const d=wt(l.path);a.push(c.put(new Be(o,d))),a.push(this.referenceDelegate.addReference(i,o,l))}),N.waitFor(a)}removeMatchingKeys(i,r,o){const a=_n(i);return N.forEach(r,c=>{const l=wt(c.path);return N.waitFor([a.delete([o,l]),this.referenceDelegate.removeReference(i,o,c)])})}removeMatchingKeysForTargetId(i,r){const o=_n(i),a=IDBKeyRange.bound([r],[r+1],!1,!0);return o.delete(a)}getMatchingKeysForTargetId(i,r){const o=IDBKeyRange.bound([r],[r+1],!1,!0),a=_n(i);let c=ie();return a.Kt({range:o,qt:!0},(l,d,f)=>{const m=$t(l[1]),w=new V(m);c=c.add(w)}).next(()=>c)}containsKey(i,r){const o=wt(r.path),a=IDBKeyRange.bound([o],[jl(o)],!1,!0);let c=0;return _n(i).Kt({index:Be.documentTargetsIndex,qt:!0,range:a},([l,d],f,m)=>{0!==l&&(c++,m.done())}).next(()=>c>0)}Et(i,r){return Fi(i).get(r).next(o=>o?qr(o):null)}}function Fi(s){return et(s,Je.store)}function sh(s){return et(s,ct.store)}function _n(s){return et(s,Be.store)}function Qn(s){return ra.apply(this,arguments)}function ra(){return(ra=(0,C.Z)(function*(s){if(s.code!==D.FAILED_PRECONDITION||s.message!==ju)throw s;L("LocalStore","Unexpectedly lost primary lease")})).apply(this,arguments)}function oh([s,i],[r,o]){const a=X(s,r);return 0===a?X(i,o):a}class Dp{constructor(i){this.ue=i,this.buffer=new pe(oh),this.he=0}le(){return++this.he}fe(i){const r=[i,this.le()];if(this.buffer.size<this.ue)this.buffer=this.buffer.add(r);else{const o=this.buffer.last();oh(r,o)<0&&(this.buffer=this.buffer.delete(o).add(r))}}get maxValue(){return this.buffer.last()[0]}}class xp{constructor(i,r){this.garbageCollector=i,this.asyncQueue=r,this.de=!1,this.we=null}start(i){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this._e(i)}stop(){this.we&&(this.we.cancel(),this.we=null)}get started(){return null!==this.we}_e(i){var r=this;const o=this.de?3e5:6e4;L("LruGarbageCollector",`Garbage collection scheduled in ${o}ms`),this.we=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",o,(0,C.Z)(function*(){r.we=null,r.de=!0;try{yield i.collectGarbage(r.garbageCollector)}catch(a){Zn(a)?L("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",a):yield Qn(a)}yield r._e(i)}))}}class Cp{constructor(i,r){this.me=i,this.params=r}calculateTargetCount(i,r){return this.me.ge(i).next(o=>Math.floor(r/100*o))}nthSequenceNumber(i,r){if(0===r)return N.resolve(ot.T);const o=new Dp(r);return this.me.forEachTarget(i,a=>o.fe(a.sequenceNumber)).next(()=>this.me.ye(i,a=>o.fe(a))).next(()=>o.maxValue)}removeTargets(i,r,o){return this.me.removeTargets(i,r,o)}removeOrphanedDocuments(i,r){return this.me.removeOrphanedDocuments(i,r)}collect(i,r){return-1===this.params.cacheSizeCollectionThreshold?(L("LruGarbageCollector","Garbage collection skipped; disabled"),N.resolve(th)):this.getCacheSize(i).next(o=>o<this.params.cacheSizeCollectionThreshold?(L("LruGarbageCollector",`Garbage collection skipped; Cache size ${o} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),th):this.pe(i,r))}getCacheSize(i){return this.me.getCacheSize(i)}pe(i,r){let o,a,c,l,d,f,m;const w=Date.now();return this.calculateTargetCount(i,this.params.percentileToCollect).next(b=>(b>this.params.maximumSequenceNumbersToCollect?(L("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${b}`),a=this.params.maximumSequenceNumbersToCollect):a=b,l=Date.now(),this.nthSequenceNumber(i,a))).next(b=>(o=b,d=Date.now(),this.removeTargets(i,o,r))).next(b=>(c=b,f=Date.now(),this.removeOrphanedDocuments(i,o))).next(b=>(m=Date.now(),Lo()<=Ye.in.DEBUG&&L("LruGarbageCollector",`LRU Garbage Collection\n\tCounted targets in ${l-w}ms\n\tDetermined least recently used ${a} in `+(d-l)+`ms\n\tRemoved ${c} targets in `+(f-d)+`ms\n\tRemoved ${b} documents in `+(m-f)+`ms\nTotal Duration: ${m-w}ms`),N.resolve({didRun:!0,sequenceNumbersCollected:a,targetsRemoved:c,documentsRemoved:b})))}}class Ap{constructor(i,r){this.db=i,this.garbageCollector=new Cp(this,r)}ge(i){const r=this.Ee(i);return this.db.getTargetCache().getTargetCount(i).next(o=>r.next(a=>o+a))}Ee(i){let r=0;return this.ye(i,o=>{r++}).next(()=>r)}forEachTarget(i,r){return this.db.getTargetCache().forEachTarget(i,r)}ye(i,r){return this.Te(i,(o,a)=>r(a))}addReference(i,r,o){return qs(i,o)}removeReference(i,r,o){return qs(i,o)}removeTargets(i,r,o){return this.db.getTargetCache().removeTargets(i,r,o)}markPotentiallyOrphaned(i,r){return qs(i,r)}Ie(i,r){return function(o,a){let c=!1;return rh(o).jt(l=>ih(o,l,a).next(d=>(d&&(c=!0),N.resolve(!d)))).next(()=>c)}(i,r)}removeOrphanedDocuments(i,r){const o=this.db.getRemoteDocumentCache().newChangeBuffer(),a=[];let c=0;return this.Te(i,(l,d)=>{if(d<=r){const f=this.Ie(i,l).next(m=>{if(!m)return c++,o.getEntry(i,l).next(()=>(o.removeEntry(l),_n(i).delete([0,wt(l.path)])))});a.push(f)}}).next(()=>N.waitFor(a)).next(()=>o.apply(i)).next(()=>c)}removeTarget(i,r){const o=r.withSequenceNumber(i.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(i,o)}updateLimboDocument(i,r){return qs(i,r)}Te(i,r){const o=_n(i);let a,c=ot.T;return o.Kt({index:Be.documentTargetsIndex},([l,d],{path:f,sequenceNumber:m})=>{0===l?(c!==ot.T&&r(new V($t(a)),c),c=m,a=f):c=ot.T}).next(()=>{c!==ot.T&&r(new V($t(a)),c)})}getCacheSize(i){return this.db.getRemoteDocumentCache().getSize(i)}}function qs(s,i){return _n(s).put((o=s.currentSequenceNumber,new Be(0,wt(i.path),o)));var o}class Ui{constructor(i,r){this.mapKeyFn=i,this.equalsFn=r,this.inner={}}get(i){const r=this.mapKeyFn(i),o=this.inner[r];if(void 0!==o)for(const[a,c]of o)if(this.equalsFn(a,i))return c}has(i){return void 0!==this.get(i)}set(i,r){const o=this.mapKeyFn(i),a=this.inner[o];if(void 0!==a){for(let c=0;c<a.length;c++)if(this.equalsFn(a[c][0],i))return void(a[c]=[i,r]);a.push([i,r])}else this.inner[o]=[[i,r]]}delete(i){const r=this.mapKeyFn(i),o=this.inner[r];if(void 0===o)return!1;for(let a=0;a<o.length;a++)if(this.equalsFn(o[a][0],i))return 1===o.length?delete this.inner[r]:o.splice(a,1),!0;return!1}forEach(i){qn(this.inner,(r,o)=>{for(const[a,c]of o)i(a,c)})}isEmpty(){return Kl(this.inner)}}class ah{constructor(){this.changes=new Ui(i=>i.toString(),(i,r)=>i.isEqual(r)),this.changesApplied=!1}getReadTime(i){const r=this.changes.get(i);return r?r.readTime:Y.min()}addEntry(i,r){this.assertNotApplied(),this.changes.set(i.key,{document:i,readTime:r})}removeEntry(i,r=null){this.assertNotApplied(),this.changes.set(i,{document:ue.newInvalidDocument(i),readTime:r})}getEntry(i,r){this.assertNotApplied();const o=this.changes.get(r);return void 0!==o?N.resolve(o.document):this.getFromCache(i,r)}getEntries(i,r){return this.getAllFromCache(i,r)}apply(i){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(i)}assertNotApplied(){}}class Rp{constructor(i,r){this.N=i,this.Ht=r}addEntry(i,r,o){return wn(i).put(Gs(r),o)}removeEntry(i,r){const o=wn(i),a=Gs(r);return o.delete(a)}updateMetadata(i,r){return this.getMetadata(i).next(o=>(o.byteSize+=r,this.Ae(i,o)))}getEntry(i,r){return wn(i).get(Gs(r)).next(o=>this.Re(r,o))}Pe(i,r){return wn(i).get(Gs(r)).next(o=>({document:this.Re(r,o),size:Bs(o)}))}getEntries(i,r){let o=ft();return this.be(i,r,(a,c)=>{const l=this.Re(a,c);o=o.insert(a,l)}).next(()=>o)}ve(i,r){let o=ft(),a=new Ce(V.comparator);return this.be(i,r,(c,l)=>{const d=this.Re(c,l);o=o.insert(c,d),a=a.insert(c,Bs(l))}).next(()=>({documents:o,Ve:a}))}be(i,r,o){if(r.isEmpty())return N.resolve();const a=IDBKeyRange.bound(r.first().path.toArray(),r.last().path.toArray()),c=r.getIterator();let l=c.getNext();return wn(i).Kt({range:a},(d,f,m)=>{const w=V.fromSegments(d);for(;l&&V.comparator(l,w)<0;)o(l,null),l=c.getNext();l&&l.isEqual(w)&&(o(l,f),l=c.hasNext()?c.getNext():null),l?m.Mt(l.path.toArray()):m.done()}).next(()=>{for(;l;)o(l,null),l=c.hasNext()?c.getNext():null})}getDocumentsMatchingQuery(i,r,o){let a=ft();const c=r.path.length+1,l={};if(o.isEqual(Y.min())){const d=r.path.toArray();l.range=IDBKeyRange.lowerBound(d)}else{const d=r.path.toArray(),f=ea(o);l.range=IDBKeyRange.lowerBound([d,f],!0),l.index=ge.collectionReadTimeIndex}return wn(i).Kt(l,(d,f,m)=>{if(d.length!==c)return;const w=Jo(this.N,f);r.path.isPrefixOf(w.key.path)?Pr(r,w)&&(a=a.insert(w.key,w)):m.done()}).next(()=>a)}newChangeBuffer(i){return new Pp(this,!!i&&i.trackRemovals)}getSize(i){return this.getMetadata(i).next(r=>r.byteSize)}getMetadata(i){return ch(i).get(Pt.key).next(r=>(K(!!r),r))}Ae(i,r){return ch(i).put(Pt.key,r)}Re(i,r){if(r){const o=Jo(this.N,r);if(!o.isNoDocument()||!o.version.isEqual(Y.min()))return o}return ue.newInvalidDocument(i)}}class Pp extends ah{constructor(i,r){super(),this.Se=i,this.trackRemovals=r,this.De=new Ui(o=>o.toString(),(o,a)=>o.isEqual(a))}applyChanges(i){const r=[];let o=0,a=new pe((c,l)=>X(c.canonicalString(),l.canonicalString()));return this.changes.forEach((c,l)=>{const d=this.De.get(c);if(l.document.isValidDocument()){const f=Yu(this.Se.N,l.document,this.getReadTime(c));a=a.add(c.path.popLast()),o+=Bs(f)-d,r.push(this.Se.addEntry(i,c,f))}else if(o-=d,this.trackRemovals){const f=Yu(this.Se.N,ue.newNoDocument(c,Y.min()),this.getReadTime(c));r.push(this.Se.addEntry(i,c,f))}else r.push(this.Se.removeEntry(i,c))}),a.forEach(c=>{r.push(this.Se.Ht.addToCollectionParentIndex(i,c))}),r.push(this.Se.updateMetadata(i,o)),N.waitFor(r)}getFromCache(i,r){return this.Se.Pe(i,r).next(o=>(this.De.set(r,o.size),o.document))}getAllFromCache(i,r){return this.Se.ve(i,r).next(({documents:o,Ve:a})=>(a.forEach((c,l)=>{this.De.set(c,l)}),o))}}function ch(s){return et(s,Pt.store)}function wn(s){return et(s,ge.store)}function Gs(s){return s.path.toArray()}class Np{constructor(i){this.N=i}Ct(i,r,o,a){K(o<a&&o>=0&&a<=11);const c=new Vs("createOrUpgrade",r);var d;o<1&&a>=1&&(i.createObjectStore(at.store),(d=i).createObjectStore(mn.store,{keyPath:mn.keyPath}),d.createObjectStore(ae.store,{keyPath:ae.keyPath,autoIncrement:!0}).createIndex(ae.userMutationsIndex,ae.userMutationsKeyPath,{unique:!0}),d.createObjectStore(Ge.store),lh(i),function(d){d.createObjectStore(ge.store)}(i));let l=N.resolve();return o<3&&a>=3&&(0!==o&&(function(d){d.deleteObjectStore(Be.store),d.deleteObjectStore(Je.store),d.deleteObjectStore(ct.store)}(i),lh(i)),l=l.next(()=>function(d){const f=d.store(ct.store),m=new ct(0,0,Y.min().toTimestamp(),0);return f.put(ct.key,m)}(c))),o<4&&a>=4&&(0!==o&&(l=l.next(()=>function(d,f){return f.store(ae.store).Lt().next(m=>{d.deleteObjectStore(ae.store),d.createObjectStore(ae.store,{keyPath:ae.keyPath,autoIncrement:!0}).createIndex(ae.userMutationsIndex,ae.userMutationsKeyPath,{unique:!0});const w=f.store(ae.store),b=m.map(x=>w.put(x));return N.waitFor(b)})}(i,c))),l=l.next(()=>{!function(d){d.createObjectStore(Kt.store,{keyPath:Kt.keyPath})}(i)})),o<5&&a>=5&&(l=l.next(()=>this.Ce(c))),o<6&&a>=6&&(l=l.next(()=>(function(d){d.createObjectStore(Pt.store)}(i),this.Ne(c)))),o<7&&a>=7&&(l=l.next(()=>this.xe(c))),o<8&&a>=8&&(l=l.next(()=>this.ke(i,c))),o<9&&a>=9&&(l=l.next(()=>{(function(d){d.objectStoreNames.contains("remoteDocumentChanges")&&d.deleteObjectStore("remoteDocumentChanges")})(i),function(d){const f=d.objectStore(ge.store);f.createIndex(ge.readTimeIndex,ge.readTimeIndexPath,{unique:!1}),f.createIndex(ge.collectionReadTimeIndex,ge.collectionReadTimeIndexPath,{unique:!1})}(r)})),o<10&&a>=10&&(l=l.next(()=>this.$e(c))),o<11&&a>=11&&(l=l.next(()=>{(function(d){d.createObjectStore(Pi.store,{keyPath:Pi.keyPath})})(i),function(d){d.createObjectStore(Ni.store,{keyPath:Ni.keyPath})}(i)})),l}Ne(i){let r=0;return i.store(ge.store).Kt((o,a)=>{r+=Bs(a)}).next(()=>{const o=new Pt(r);return i.store(Pt.store).put(Pt.key,o)})}Ce(i){const r=i.store(mn.store),o=i.store(ae.store);return r.Lt().next(a=>N.forEach(a,c=>{const l=IDBKeyRange.bound([c.userId,-1],[c.userId,c.lastAcknowledgedBatchId]);return o.Lt(ae.userMutationsIndex,l).next(d=>N.forEach(d,f=>{K(f.userId===c.userId);const m=Oi(this.N,f);return nh(i,c.userId,m).next(()=>{})}))}))}xe(i){const r=i.store(Be.store),o=i.store(ge.store);return i.store(ct.store).get(ct.key).next(a=>{const c=[];return o.Kt((l,d)=>{const f=new te(l),m=[0,wt(f)];c.push(r.get(m).next(w=>w?N.resolve():r.put(new Be(0,wt(f),a.highestListenSequenceNumber))))}).next(()=>N.waitFor(c))})}ke(i,r){i.createObjectStore(Kn.store,{keyPath:Kn.keyPath});const o=r.store(Kn.store),a=new na,c=l=>{if(a.add(l)){const d=l.lastSegment(),f=l.popLast();return o.put({collectionId:d,parent:wt(f)})}};return r.store(ge.store).Kt({qt:!0},(l,d)=>{const f=new te(l);return c(f.popLast())}).next(()=>r.store(Ge.store).Kt({qt:!0},([l,d,f],m)=>{const w=$t(d);return c(w.popLast())}))}$e(i){const r=i.store(Je.store);return r.Kt((o,a)=>{const c=qr(a),l=Wu(this.N,c);return r.put(l)})}}function lh(s){s.createObjectStore(Be.store,{keyPath:Be.keyPath}).createIndex(Be.documentTargetsIndex,Be.documentTargetsKeyPath,{unique:!0}),s.createObjectStore(Je.store,{keyPath:Je.keyPath}).createIndex(Je.queryTargetsIndexName,Je.queryTargetsKeyPath,{unique:!0}),s.createObjectStore(ct.store)}const sa="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class oa{constructor(i,r,o,a,c,l,d,f,m,w){if(this.allowTabSynchronization=i,this.persistenceKey=r,this.clientId=o,this.Oe=c,this.window=l,this.document=d,this.Fe=m,this.Me=w,this.Le=null,this.Be=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Ue=null,this.inForeground=!1,this.qe=null,this.Ke=null,this.je=Number.NEGATIVE_INFINITY,this.Qe=b=>Promise.resolve(),!oa.Pt())throw new k(D.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new Ap(this,a),this.We=r+"main",this.N=new Hu(f),this.Ge=new bt(this.We,11,new Np(this.N)),this.ze=new Sp(this.referenceDelegate,this.N),this.Ht=new Ip,this.He=new Rp(this.N,this.Ht),this.Je=new Tp,this.window&&this.window.localStorage?this.Ye=this.window.localStorage:(this.Ye=null,!1===w&&Te("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Xe().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new k(D.FAILED_PRECONDITION,sa);return this.Ze(),this.tn(),this.en(),this.runTransaction("getHighestListenSequenceNumber","readonly",i=>this.ze.getHighestSequenceNumber(i))}).then(i=>{this.Le=new ot(i,this.Fe)}).then(()=>{this.Be=!0}).catch(i=>(this.Ge&&this.Ge.close(),Promise.reject(i)))}nn(i){var r=this;return this.Qe=function(){var o=(0,C.Z)(function*(a){if(r.started)return i(a)});return function(a){return o.apply(this,arguments)}}(),i(this.isPrimary)}setDatabaseDeletedListener(i){this.Ge.xt(function(){var r=(0,C.Z)(function*(o){null===o.newVersion&&(yield i())});return function(o){return r.apply(this,arguments)}}())}setNetworkEnabled(i){var r=this;this.networkEnabled!==i&&(this.networkEnabled=i,this.Oe.enqueueAndForget((0,C.Z)(function*(){r.started&&(yield r.Xe())})))}Xe(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",i=>zs(i).put(new Kt(this.clientId,Date.now(),this.networkEnabled,this.inForeground)).next(()=>{if(this.isPrimary)return this.sn(i).next(r=>{r||(this.isPrimary=!1,this.Oe.enqueueRetryable(()=>this.Qe(!1)))})}).next(()=>this.rn(i)).next(r=>this.isPrimary&&!r?this.on(i).next(()=>!1):!!r&&this.an(i).next(()=>!0))).catch(i=>{if(Zn(i))return L("IndexedDbPersistence","Failed to extend owner lease: ",i),this.isPrimary;if(!this.allowTabSynchronization)throw i;return L("IndexedDbPersistence","Releasing owner lease after error during lease refresh",i),!1}).then(i=>{this.isPrimary!==i&&this.Oe.enqueueRetryable(()=>this.Qe(i)),this.isPrimary=i})}sn(i){return Gr(i).get(at.key).next(r=>N.resolve(this.cn(r)))}un(i){return zs(i).delete(this.clientId)}hn(){var i=this;return(0,C.Z)(function*(){if(i.isPrimary&&!i.ln(i.je,18e5)){i.je=Date.now();const r=yield i.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",o=>{const a=et(o,Kt.store);return a.Lt().next(c=>{const l=i.fn(c,18e5),d=c.filter(f=>-1===l.indexOf(f));return N.forEach(d,f=>a.delete(f.clientId)).next(()=>d)})}).catch(()=>[]);if(i.Ye)for(const o of r)i.Ye.removeItem(i.dn(o.clientId))}})()}en(){this.Ke=this.Oe.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.Xe().then(()=>this.hn()).then(()=>this.en()))}cn(i){return!!i&&i.ownerId===this.clientId}rn(i){return this.Me?N.resolve(!0):Gr(i).get(at.key).next(r=>{if(null!==r&&this.ln(r.leaseTimestampMs,5e3)&&!this.wn(r.ownerId)){if(this.cn(r)&&this.networkEnabled)return!0;if(!this.cn(r)){if(!r.allowTabSynchronization)throw new k(D.FAILED_PRECONDITION,sa);return!1}}return!(!this.networkEnabled||!this.inForeground)||zs(i).Lt().next(o=>void 0===this.fn(o,5e3).find(a=>{if(this.clientId!==a.clientId){const l=!this.inForeground&&a.inForeground,d=this.networkEnabled===a.networkEnabled;if(!this.networkEnabled&&a.networkEnabled||l&&d)return!0}return!1}))}).next(r=>(this.isPrimary!==r&&L("IndexedDbPersistence",`Client ${r?"is":"is not"} eligible for a primary lease.`),r))}shutdown(){var i=this;return(0,C.Z)(function*(){i.Be=!1,i._n(),i.Ke&&(i.Ke.cancel(),i.Ke=null),i.mn(),i.gn(),yield i.Ge.runTransaction("shutdown","readwrite",[at.store,Kt.store],r=>{const o=new Zu(r,ot.T);return i.on(o).next(()=>i.un(o))}),i.Ge.close(),i.yn()})()}fn(i,r){return i.filter(o=>this.ln(o.updateTimeMs,r)&&!this.wn(o.clientId))}pn(){return this.runTransaction("getActiveClients","readonly",i=>zs(i).Lt().next(r=>this.fn(r,18e5).map(o=>o.clientId)))}get started(){return this.Be}getMutationQueue(i){return ia.Yt(i,this.N,this.Ht,this.referenceDelegate)}getTargetCache(){return this.ze}getRemoteDocumentCache(){return this.He}getIndexManager(){return this.Ht}getBundleCache(){return this.Je}runTransaction(i,r,o){let c;return L("IndexedDbPersistence","Starting transaction:",i),this.Ge.runTransaction(i,"readonly"===r?"readonly":"readwrite",_p,l=>(c=new Zu(l,this.Le?this.Le.next():ot.T),"readwrite-primary"===r?this.sn(c).next(d=>!!d||this.rn(c)).next(d=>{if(!d)throw Te(`Failed to obtain primary lease for action '${i}'.`),this.isPrimary=!1,this.Oe.enqueueRetryable(()=>this.Qe(!1)),new k(D.FAILED_PRECONDITION,ju);return o(c)}).next(d=>this.an(c).next(()=>d)):this.En(c).next(()=>o(c)))).then(l=>(c.raiseOnCommittedEvent(),l))}En(i){return Gr(i).get(at.key).next(r=>{if(null!==r&&this.ln(r.leaseTimestampMs,5e3)&&!this.wn(r.ownerId)&&!this.cn(r)&&!(this.Me||this.allowTabSynchronization&&r.allowTabSynchronization))throw new k(D.FAILED_PRECONDITION,sa)})}an(i){const r=new at(this.clientId,this.allowTabSynchronization,Date.now());return Gr(i).put(at.key,r)}static Pt(){return bt.Pt()}on(i){const r=Gr(i);return r.get(at.key).next(o=>this.cn(o)?(L("IndexedDbPersistence","Releasing primary lease."),r.delete(at.key)):N.resolve())}ln(i,r){const o=Date.now();return!(i<o-r||i>o&&(Te(`Detected an update time that is in the future: ${i} > ${o}`),1))}Ze(){null!==this.document&&"function"==typeof this.document.addEventListener&&(this.qe=()=>{this.Oe.enqueueAndForget(()=>(this.inForeground="visible"===this.document.visibilityState,this.Xe()))},this.document.addEventListener("visibilitychange",this.qe),this.inForeground="visible"===this.document.visibilityState)}mn(){this.qe&&(this.document.removeEventListener("visibilitychange",this.qe),this.qe=null)}tn(){var i;"function"==typeof(null===(i=this.window)||void 0===i?void 0:i.addEventListener)&&(this.Ue=()=>{this._n(),(0,W.G6)()&&navigator.appVersion.match("Version/14")&&this.Oe.enterRestrictedMode(!0),this.Oe.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Ue))}gn(){this.Ue&&(this.window.removeEventListener("pagehide",this.Ue),this.Ue=null)}wn(i){var r;try{const o=null!==(null===(r=this.Ye)||void 0===r?void 0:r.getItem(this.dn(i)));return L("IndexedDbPersistence",`Client '${i}' ${o?"is":"is not"} zombied in LocalStorage`),o}catch(o){return Te("IndexedDbPersistence","Failed to get zombied client id.",o),!1}}_n(){if(this.Ye)try{this.Ye.setItem(this.dn(this.clientId),String(Date.now()))}catch(i){Te("Failed to set zombie client id.",i)}}yn(){if(this.Ye)try{this.Ye.removeItem(this.dn(this.clientId))}catch(i){}}dn(i){return`firestore_zombie_${this.persistenceKey}_${i}`}}function Gr(s){return et(s,at.store)}function zs(s){return et(s,Kt.store)}function aa(s,i){let r=s.projectId;return s.isDefaultDatabase||(r+="."+s.database),"firestore/"+i+"/"+r+"/"}class kp{constructor(i,r){this.progress=i,this.Tn=r}}class uh{constructor(i,r,o){this.He=i,this.In=r,this.Ht=o}An(i,r){return this.In.getAllMutationBatchesAffectingDocumentKey(i,r).next(o=>this.Rn(i,r,o))}Rn(i,r,o){return this.He.getEntry(i,r).next(a=>{for(const c of o)c.applyToLocalView(a);return a})}Pn(i,r){i.forEach((o,a)=>{for(const c of r)c.applyToLocalView(a)})}bn(i,r){return this.He.getEntries(i,r).next(o=>this.vn(i,o).next(()=>o))}vn(i,r){return this.In.getAllMutationBatchesAffectingDocumentKeys(i,r).next(o=>this.Pn(r,o))}getDocumentsMatchingQuery(i,r,o){return V.isDocumentKey((a=r).path)&&null===a.collectionGroup&&0===a.filters.length?this.Vn(i,r.path):zo(r)?this.Sn(i,r,o):this.Dn(i,r,o);var a}Vn(i,r){return this.An(i,new V(r)).next(o=>{let a=Zo();return o.isFoundDocument()&&(a=a.insert(o.key,o)),a})}Sn(i,r,o){const a=r.collectionGroup;let c=Zo();return this.Ht.getCollectionParents(i,a).next(l=>N.forEach(l,d=>{const f=(m=r,w=d.child(a),new jt(w,null,m.explicitOrderBy.slice(),m.filters.slice(),m.limit,m.limitType,m.startAt,m.endAt));var m,w;return this.Dn(i,f,o).next(m=>{m.forEach((w,b)=>{c=c.insert(w,b)})})}).next(()=>c))}Dn(i,r,o){let a,c;return this.He.getDocumentsMatchingQuery(i,r,o).next(l=>(a=l,this.In.getAllMutationBatchesAffectingQuery(i,r))).next(l=>(c=l,this.Cn(i,c,a).next(d=>{a=d;for(const f of c)for(const m of f.mutations){const w=m.key;let b=a.get(w);null==b&&(b=ue.newInvalidDocument(w),a=a.insert(w,b)),$o(m,b,f.localWriteTime),b.isFoundDocument()||(a=a.remove(w))}}))).next(()=>(a.forEach((l,d)=>{Pr(r,d)||(a=a.remove(l))}),a))}Cn(i,r,o){let a=ie();for(const l of r)for(const d of l.mutations)d instanceof gn&&null===o.get(d.key)&&(a=a.add(d.key));let c=o;return this.He.getEntries(i,a).next(l=>(l.forEach((d,f)=>{f.isFoundDocument()&&(c=c.insert(d,f))}),c))}}class ca{constructor(i,r,o,a){this.targetId=i,this.fromCache=r,this.Nn=o,this.xn=a}static kn(i,r){let o=ie(),a=ie();for(const c of r.docChanges)switch(c.type){case 0:o=o.add(c.doc.key);break;case 1:a=a.add(c.doc.key)}return new ca(i,r.fromCache,o,a)}}class hh{$n(i){this.On=i}getDocumentsMatchingQuery(i,r,o,a){return 0===(c=r).filters.length&&null===c.limit&&null==c.startAt&&null==c.endAt&&(0===c.explicitOrderBy.length||1===c.explicitOrderBy.length&&c.explicitOrderBy[0].field.isKeyField())||o.isEqual(Y.min())?this.Fn(i,r):this.On.bn(i,a).next(c=>{const l=this.Mn(r,c);return(Rs(r)||Ps(r))&&this.Ln(r.limitType,l,a,o)?this.Fn(i,r):(Lo()<=Ye.in.DEBUG&&L("QueryEngine","Re-using previous result from %s to execute query: %s",o.toString(),jo(r)),this.On.getDocumentsMatchingQuery(i,r,o).next(d=>(l.forEach(f=>{d=d.insert(f.key,f)}),d)))});var c}Mn(i,r){let o=new pe(ou(i));return r.forEach((a,c)=>{Pr(i,c)&&(o=o.add(c))}),o}Ln(i,r,o,a){if(o.size!==r.size)return!0;const c="F"===i?r.last():r.first();return!!c&&(c.hasPendingWrites||c.version.compareTo(a)>0)}Fn(i,r){return Lo()<=Ye.in.DEBUG&&L("QueryEngine","Using full collection scan to execute query:",jo(r)),this.On.getDocumentsMatchingQuery(i,r,Y.min())}}class Lp{constructor(i,r,o,a){this.persistence=i,this.Bn=r,this.N=a,this.Un=new Ce(X),this.qn=new Ui(c=>Cr(c),xs),this.Kn=Y.min(),this.In=i.getMutationQueue(o),this.jn=i.getRemoteDocumentCache(),this.ze=i.getTargetCache(),this.Qn=new uh(this.jn,this.In,this.persistence.getIndexManager()),this.Je=i.getBundleCache(),this.Bn.$n(this.Qn)}collectGarbage(i){return this.persistence.runTransaction("Collect garbage","readwrite-primary",r=>i.collect(r,this.Un))}}function dh(s,i,r,o){return new Lp(s,i,r,o)}function fh(s,i){return la.apply(this,arguments)}function la(){return(la=(0,C.Z)(function*(s,i){const r=M(s);let o=r.In,a=r.Qn;const c=yield r.persistence.runTransaction("Handle user change","readonly",l=>{let d;return r.In.getAllMutationBatches(l).next(f=>(d=f,o=r.persistence.getMutationQueue(i),a=new uh(r.jn,o,r.persistence.getIndexManager()),o.getAllMutationBatches(l))).next(f=>{const m=[],w=[];let b=ie();for(const x of d){m.push(x.batchId);for(const P of x.mutations)b=b.add(P.key)}for(const x of f){w.push(x.batchId);for(const P of x.mutations)b=b.add(P.key)}return a.bn(l,b).next(x=>({Wn:x,removedBatchIds:m,addedBatchIds:w}))})});return r.In=o,r.Qn=a,r.Bn.$n(r.Qn),c})).apply(this,arguments)}function Op(s,i){const r=M(s);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",o=>{const a=i.batch.keys(),c=r.jn.newChangeBuffer({trackRemovals:!0});return function(l,d,f,m){const w=f.batch,b=w.keys();let x=N.resolve();return b.forEach(P=>{x=x.next(()=>m.getEntry(d,P)).next(O=>{const q=f.docVersions.get(P);K(null!==q),O.version.compareTo(q)<0&&(w.applyToRemoteDocument(O,f),O.isValidDocument()&&m.addEntry(O,f.commitVersion))})}),x.next(()=>l.In.removeMutationBatch(d,w))}(r,o,i,c).next(()=>c.apply(o)).next(()=>r.In.performConsistencyCheck(o)).next(()=>r.Qn.bn(o,a))})}function ph(s){const i=M(s);return i.persistence.runTransaction("Get last remote snapshot version","readonly",r=>i.ze.getLastRemoteSnapshotVersion(r))}function Mp(s,i){const r=M(s),o=i.snapshotVersion;let a=r.Un;return r.persistence.runTransaction("Apply remote event","readwrite-primary",c=>{const l=r.jn.newChangeBuffer({trackRemovals:!0});a=r.Un;const d=[];i.targetChanges.forEach((m,w)=>{const b=a.get(w);if(!b)return;d.push(r.ze.removeMatchingKeys(c,m.removedDocuments,w).next(()=>r.ze.addMatchingKeys(c,m.addedDocuments,w)));const x=m.resumeToken;if(x.approximateByteSize()>0){const P=b.withResumeToken(x,o).withSequenceNumber(c.currentSequenceNumber);a=a.insert(w,P),O=b,H=m,K((q=P).resumeToken.approximateByteSize()>0),(0===O.resumeToken.approximateByteSize()||q.snapshotVersion.toMicroseconds()-O.snapshotVersion.toMicroseconds()>=3e8||H.addedDocuments.size+H.modifiedDocuments.size+H.removedDocuments.size>0)&&d.push(r.ze.updateTargetData(c,P))}var O,q,H});let f=ft();if(i.documentUpdates.forEach((m,w)=>{i.resolvedLimboDocuments.has(m)&&d.push(r.persistence.referenceDelegate.updateLimboDocument(c,m))}),d.push(gh(c,l,i.documentUpdates,o,void 0).next(m=>{f=m})),!o.isEqual(Y.min())){const m=r.ze.getLastRemoteSnapshotVersion(c).next(w=>r.ze.setTargetsMetadata(c,c.currentSequenceNumber,o));d.push(m)}return N.waitFor(d).next(()=>l.apply(c)).next(()=>r.Qn.vn(c,f)).next(()=>f)}).then(c=>(r.Un=a,c))}function gh(s,i,r,o,a){let c=ie();return r.forEach(l=>c=c.add(l)),i.getEntries(s,c).next(l=>{let d=ft();return r.forEach((f,m)=>{const w=l.get(f),b=(null==a?void 0:a.get(f))||o;m.isNoDocument()&&m.version.isEqual(Y.min())?(i.removeEntry(f,b),d=d.insert(f,m)):!w.isValidDocument()||m.version.compareTo(w.version)>0||0===m.version.compareTo(w.version)&&w.hasPendingWrites?(i.addEntry(m,b),d=d.insert(f,m)):L("LocalStore","Ignoring outdated watch update for ",f,". Current version:",w.version," Watch version:",m.version)}),d})}function Fp(s,i){const r=M(s);return r.persistence.runTransaction("Get next mutation batch","readonly",o=>(void 0===i&&(i=-1),r.In.getNextMutationBatchAfterBatchId(o,i)))}function Vi(s,i){const r=M(s);return r.persistence.runTransaction("Allocate target","readwrite",o=>{let a;return r.ze.getTargetData(o,i).next(c=>c?(a=c,N.resolve(a)):r.ze.allocateTargetId(o).next(l=>(a=new yn(i,l,0,o.currentSequenceNumber),r.ze.addTargetData(o,a).next(()=>a))))}).then(o=>{const a=r.Un.get(o.targetId);return(null===a||o.snapshotVersion.compareTo(a.snapshotVersion)>0)&&(r.Un=r.Un.insert(o.targetId,o),r.qn.set(i,o.targetId)),o})}function Bi(s,i,r){return ua.apply(this,arguments)}function ua(){return(ua=(0,C.Z)(function*(s,i,r){const o=M(s),a=o.Un.get(i),c=r?"readwrite":"readwrite-primary";try{r||(yield o.persistence.runTransaction("Release target",c,l=>o.persistence.referenceDelegate.removeTarget(l,a)))}catch(l){if(!Zn(l))throw l;L("LocalStore",`Failed to update sequence numbers for target ${i}: ${l}`)}o.Un=o.Un.remove(i),o.qn.delete(a.target)})).apply(this,arguments)}function js(s,i,r){const o=M(s);let a=Y.min(),c=ie();return o.persistence.runTransaction("Execute query","readonly",l=>function(d,f,m){const w=M(d),b=w.qn.get(m);return void 0!==b?N.resolve(w.Un.get(b)):w.ze.getTargetData(f,m)}(o,l,dt(i)).next(d=>{if(d)return a=d.lastLimboFreeSnapshotVersion,o.ze.getMatchingKeysForTargetId(l,d.targetId).next(f=>{c=f})}).next(()=>o.Bn.getDocumentsMatchingQuery(l,i,r?a:Y.min(),r?c:ie())).next(d=>({documents:d,Gn:c})))}function mh(s,i){const r=M(s),o=M(r.ze),a=r.Un.get(i);return a?Promise.resolve(a.target):r.persistence.runTransaction("Get target data","readonly",c=>o.Et(c,i).next(l=>l?l.target:null))}function yh(s){const i=M(s);return i.persistence.runTransaction("Get new document changes","readonly",r=>function(o,a,c){const l=M(o);let d=ft(),f=ea(c);const m=wn(a),w=IDBKeyRange.lowerBound(f,!0);return m.Kt({index:ge.readTimeIndex,range:w},(b,x)=>{const P=Jo(l.N,x);d=d.insert(P.key,P),f=x.readTime}).next(()=>({Tn:d,readTime:Qu(f)}))}(i.jn,r,i.Kn)).then(({Tn:r,readTime:o})=>(i.Kn=o,r))}function ha(){return(ha=(0,C.Z)(function*(s){const i=M(s);return i.persistence.runTransaction("Synchronize last document change read time","readonly",r=>function(o){const a=wn(o);let c=Y.min();return a.Kt({index:ge.readTimeIndex,reverse:!0},(l,d,f)=>{d.readTime&&(c=Qu(d.readTime)),f.done()}).next(()=>c)}(r)).then(r=>{i.Kn=r})})).apply(this,arguments)}function da(){return(da=(0,C.Z)(function*(s,i,r,o){const a=M(s);let c=ie(),l=ft(),d=Eu();for(const w of r){const b=i.zn(w.metadata.name);w.document&&(c=c.add(b)),l=l.insert(b,i.Hn(w)),d=d.insert(b,i.Jn(w.metadata.readTime))}const f=a.jn.newChangeBuffer({trackRemovals:!0}),m=yield Vi(a,(w=o,dt(Si(te.fromString(`__bundle__/docs/${w}`)))));var w;return a.persistence.runTransaction("Apply bundle documents","readwrite",w=>gh(w,f,l,Y.min(),d).next(b=>(f.apply(w),b)).next(b=>a.ze.removeMatchingKeysForTargetId(w,m.targetId).next(()=>a.ze.addMatchingKeys(w,c,m.targetId)).next(()=>a.Qn.vn(w,b)).next(()=>b)))})).apply(this,arguments)}function Bp(s,i){return fa.apply(this,arguments)}function fa(){return(fa=(0,C.Z)(function*(s,i,r=ie()){const o=yield Vi(s,dt(ta(i.bundledQuery))),a=M(s);return a.persistence.runTransaction("Save named query","readwrite",c=>{const l=Le(i.readTime);if(o.snapshotVersion.compareTo(l)>=0)return a.Je.saveNamedQuery(c,i);const d=o.withResumeToken(ke.EMPTY_BYTE_STRING,l);return a.Un=a.Un.insert(d.targetId,d),a.ze.updateTargetData(c,d).next(()=>a.ze.removeMatchingKeysForTargetId(c,o.targetId)).next(()=>a.ze.addMatchingKeys(c,r,o.targetId)).next(()=>a.Je.saveNamedQuery(c,i))})})).apply(this,arguments)}class qp{constructor(i){this.N=i,this.Yn=new Map,this.Xn=new Map}getBundleMetadata(i,r){return N.resolve(this.Yn.get(r))}saveBundleMetadata(i,r){var o;return this.Yn.set(r.id,{id:(o=r).id,version:o.version,createTime:Le(o.createTime)}),N.resolve()}getNamedQuery(i,r){return N.resolve(this.Xn.get(r))}saveNamedQuery(i,r){return this.Xn.set(r.name,{name:(o=r).name,query:ta(o.bundledQuery),readTime:Le(o.readTime)}),N.resolve();var o}}class pa{constructor(){this.Zn=new pe(Oe.ts),this.es=new pe(Oe.ns)}isEmpty(){return this.Zn.isEmpty()}addReference(i,r){const o=new Oe(i,r);this.Zn=this.Zn.add(o),this.es=this.es.add(o)}ss(i,r){i.forEach(o=>this.addReference(o,r))}removeReference(i,r){this.rs(new Oe(i,r))}os(i,r){i.forEach(o=>this.removeReference(o,r))}cs(i){const r=new V(new te([])),o=new Oe(r,i),a=new Oe(r,i+1),c=[];return this.es.forEachInRange([o,a],l=>{this.rs(l),c.push(l.key)}),c}us(){this.Zn.forEach(i=>this.rs(i))}rs(i){this.Zn=this.Zn.delete(i),this.es=this.es.delete(i)}hs(i){const r=new V(new te([])),o=new Oe(r,i),a=new Oe(r,i+1);let c=ie();return this.es.forEachInRange([o,a],l=>{c=c.add(l.key)}),c}containsKey(i){const r=new Oe(i,0),o=this.Zn.firstAfterOrEqual(r);return null!==o&&i.isEqual(o.key)}}class Oe{constructor(i,r){this.key=i,this.ls=r}static ts(i,r){return V.comparator(i.key,r.key)||X(i.ls,r.ls)}static ns(i,r){return X(i.ls,r.ls)||V.comparator(i.key,r.key)}}class Gp{constructor(i,r){this.Ht=i,this.referenceDelegate=r,this.In=[],this.fs=1,this.ds=new pe(Oe.ts)}checkEmpty(i){return N.resolve(0===this.In.length)}addMutationBatch(i,r,o,a){const c=this.fs;this.fs++;const l=new Wo(c,r,o,a);this.In.push(l);for(const d of a)this.ds=this.ds.add(new Oe(d.key,c)),this.Ht.addToCollectionParentIndex(i,d.key.path.popLast());return N.resolve(l)}lookupMutationBatch(i,r){return N.resolve(this.ws(r))}getNextMutationBatchAfterBatchId(i,r){const a=this._s(r+1),c=a<0?0:a;return N.resolve(this.In.length>c?this.In[c]:null)}getHighestUnacknowledgedBatchId(){return N.resolve(0===this.In.length?-1:this.fs-1)}getAllMutationBatches(i){return N.resolve(this.In.slice())}getAllMutationBatchesAffectingDocumentKey(i,r){const o=new Oe(r,0),a=new Oe(r,Number.POSITIVE_INFINITY),c=[];return this.ds.forEachInRange([o,a],l=>{const d=this.ws(l.ls);c.push(d)}),N.resolve(c)}getAllMutationBatchesAffectingDocumentKeys(i,r){let o=new pe(X);return r.forEach(a=>{const c=new Oe(a,0),l=new Oe(a,Number.POSITIVE_INFINITY);this.ds.forEachInRange([c,l],d=>{o=o.add(d.ls)})}),N.resolve(this.gs(o))}getAllMutationBatchesAffectingQuery(i,r){const o=r.path,a=o.length+1;let c=o;V.isDocumentKey(c)||(c=c.child(""));const l=new Oe(new V(c),0);let d=new pe(X);return this.ds.forEachWhile(f=>{const m=f.key.path;return!!o.isPrefixOf(m)&&(m.length===a&&(d=d.add(f.ls)),!0)},l),N.resolve(this.gs(d))}gs(i){const r=[];return i.forEach(o=>{const a=this.ws(o);null!==a&&r.push(a)}),r}removeMutationBatch(i,r){K(0===this.ys(r.batchId,"removed")),this.In.shift();let o=this.ds;return N.forEach(r.mutations,a=>{const c=new Oe(a.key,r.batchId);return o=o.delete(c),this.referenceDelegate.markPotentiallyOrphaned(i,a.key)}).next(()=>{this.ds=o})}te(i){}containsKey(i,r){const o=new Oe(r,0),a=this.ds.firstAfterOrEqual(o);return N.resolve(r.isEqual(a&&a.key))}performConsistencyCheck(i){return N.resolve()}ys(i,r){return this._s(i)}_s(i){return 0===this.In.length?0:i-this.In[0].batchId}ws(i){const r=this._s(i);return r<0||r>=this.In.length?null:this.In[r]}}class zp{constructor(i,r){this.Ht=i,this.ps=r,this.docs=new Ce(V.comparator),this.size=0}addEntry(i,r,o){const a=r.key,c=this.docs.get(a),l=c?c.size:0,d=this.ps(r);return this.docs=this.docs.insert(a,{document:r.clone(),size:d,readTime:o}),this.size+=d-l,this.Ht.addToCollectionParentIndex(i,a.path.popLast())}removeEntry(i){const r=this.docs.get(i);r&&(this.docs=this.docs.remove(i),this.size-=r.size)}getEntry(i,r){const o=this.docs.get(r);return N.resolve(o?o.document.clone():ue.newInvalidDocument(r))}getEntries(i,r){let o=ft();return r.forEach(a=>{const c=this.docs.get(a);o=o.insert(a,c?c.document.clone():ue.newInvalidDocument(a))}),N.resolve(o)}getDocumentsMatchingQuery(i,r,o){let a=ft();const c=new V(r.path.child("")),l=this.docs.getIteratorFrom(c);for(;l.hasNext();){const{key:d,value:{document:f,readTime:m}}=l.getNext();if(!r.path.isPrefixOf(d.path))break;m.compareTo(o)<=0||Pr(r,f)&&(a=a.insert(f.key,f.clone()))}return N.resolve(a)}Es(i,r){return N.forEach(this.docs,o=>r(o))}newChangeBuffer(i){return new jp(this)}getSize(i){return N.resolve(this.size)}}class jp extends ah{constructor(i){super(),this.Se=i}applyChanges(i){const r=[];return this.changes.forEach((o,a)=>{a.document.isValidDocument()?r.push(this.Se.addEntry(i,a.document,this.getReadTime(o))):this.Se.removeEntry(o)}),N.waitFor(r)}getFromCache(i,r){return this.Se.getEntry(i,r)}getAllFromCache(i,r){return this.Se.getEntries(i,r)}}class $p{constructor(i){this.persistence=i,this.Ts=new Ui(r=>Cr(r),xs),this.lastRemoteSnapshotVersion=Y.min(),this.highestTargetId=0,this.Is=0,this.As=new pa,this.targetCount=0,this.Rs=Yn.se()}forEachTarget(i,r){return this.Ts.forEach((o,a)=>r(a)),N.resolve()}getLastRemoteSnapshotVersion(i){return N.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(i){return N.resolve(this.Is)}allocateTargetId(i){return this.highestTargetId=this.Rs.next(),N.resolve(this.highestTargetId)}setTargetsMetadata(i,r,o){return o&&(this.lastRemoteSnapshotVersion=o),r>this.Is&&(this.Is=r),N.resolve()}ae(i){this.Ts.set(i.target,i);const r=i.targetId;r>this.highestTargetId&&(this.Rs=new Yn(r),this.highestTargetId=r),i.sequenceNumber>this.Is&&(this.Is=i.sequenceNumber)}addTargetData(i,r){return this.ae(r),this.targetCount+=1,N.resolve()}updateTargetData(i,r){return this.ae(r),N.resolve()}removeTargetData(i,r){return this.Ts.delete(r.target),this.As.cs(r.targetId),this.targetCount-=1,N.resolve()}removeTargets(i,r,o){let a=0;const c=[];return this.Ts.forEach((l,d)=>{d.sequenceNumber<=r&&null===o.get(d.targetId)&&(this.Ts.delete(l),c.push(this.removeMatchingKeysForTargetId(i,d.targetId)),a++)}),N.waitFor(c).next(()=>a)}getTargetCount(i){return N.resolve(this.targetCount)}getTargetData(i,r){const o=this.Ts.get(r)||null;return N.resolve(o)}addMatchingKeys(i,r,o){return this.As.ss(r,o),N.resolve()}removeMatchingKeys(i,r,o){this.As.os(r,o);const a=this.persistence.referenceDelegate,c=[];return a&&r.forEach(l=>{c.push(a.markPotentiallyOrphaned(i,l))}),N.waitFor(c)}removeMatchingKeysForTargetId(i,r){return this.As.cs(r),N.resolve()}getMatchingKeysForTargetId(i,r){const o=this.As.hs(r);return N.resolve(o)}containsKey(i,r){return N.resolve(this.As.containsKey(r))}}class Kp{constructor(i,r){this.Ps={},this.Le=new ot(0),this.Be=!1,this.Be=!0,this.referenceDelegate=i(this),this.ze=new $p(this),this.Ht=new Ep,this.He=new zp(this.Ht,o=>this.referenceDelegate.bs(o)),this.N=new Hu(r),this.Je=new qp(this.N)}start(){return Promise.resolve()}shutdown(){return this.Be=!1,Promise.resolve()}get started(){return this.Be}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(){return this.Ht}getMutationQueue(i){let r=this.Ps[i.toKey()];return r||(r=new Gp(this.Ht,this.referenceDelegate),this.Ps[i.toKey()]=r),r}getTargetCache(){return this.ze}getRemoteDocumentCache(){return this.He}getBundleCache(){return this.Je}runTransaction(i,r,o){L("MemoryPersistence","Starting transaction:",i);const a=new Zp(this.Le.next());return this.referenceDelegate.vs(),o(a).next(c=>this.referenceDelegate.Vs(a).next(()=>c)).toPromise().then(c=>(a.raiseOnCommittedEvent(),c))}Ss(i,r){return N.or(Object.values(this.Ps).map(o=>()=>o.containsKey(i,r)))}}class Zp extends $u{constructor(i){super(),this.currentSequenceNumber=i}}class ga{constructor(i){this.persistence=i,this.Ds=new pa,this.Cs=null}static Ns(i){return new ga(i)}get xs(){if(this.Cs)return this.Cs;throw B()}addReference(i,r,o){return this.Ds.addReference(o,r),this.xs.delete(o.toString()),N.resolve()}removeReference(i,r,o){return this.Ds.removeReference(o,r),this.xs.add(o.toString()),N.resolve()}markPotentiallyOrphaned(i,r){return this.xs.add(r.toString()),N.resolve()}removeTarget(i,r){this.Ds.cs(r.targetId).forEach(a=>this.xs.add(a.toString()));const o=this.persistence.getTargetCache();return o.getMatchingKeysForTargetId(i,r.targetId).next(a=>{a.forEach(c=>this.xs.add(c.toString()))}).next(()=>o.removeTargetData(i,r))}vs(){this.Cs=new Set}Vs(i){const r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return N.forEach(this.xs,o=>{const a=V.fromPath(o);return this.ks(i,a).next(c=>{c||r.removeEntry(a)})}).next(()=>(this.Cs=null,r.apply(i)))}updateLimboDocument(i,r){return this.ks(i,r).next(o=>{o?this.xs.delete(r.toString()):this.xs.add(r.toString())})}bs(i){return 0}ks(i,r){return N.or([()=>N.resolve(this.Ds.containsKey(r)),()=>this.persistence.getTargetCache().containsKey(i,r),()=>this.persistence.Ss(i,r)])}}function vh(s,i){return`firestore_clients_${s}_${i}`}function _h(s,i,r){let o=`firestore_mutations_${s}_${r}`;return i.isAuthenticated()&&(o+=`_${i.uid}`),o}function ma(s,i){return`firestore_targets_${s}_${i}`}class $s{constructor(i,r,o,a){this.user=i,this.batchId=r,this.state=o,this.error=a}static $s(i,r,o){const a=JSON.parse(o);let c,l="object"==typeof a&&-1!==["pending","acknowledged","rejected"].indexOf(a.state)&&(void 0===a.error||"object"==typeof a.error);return l&&a.error&&(l="string"==typeof a.error.message&&"string"==typeof a.error.code,l&&(c=new k(a.error.code,a.error.message))),l?new $s(i,r,a.state,c):(Te("SharedClientState",`Failed to parse mutation state for ID '${r}': ${o}`),null)}Os(){const i={state:this.state,updateTimeMs:Date.now()};return this.error&&(i.error={code:this.error.code,message:this.error.message}),JSON.stringify(i)}}class zr{constructor(i,r,o){this.targetId=i,this.state=r,this.error=o}static $s(i,r){const o=JSON.parse(r);let a,c="object"==typeof o&&-1!==["not-current","current","rejected"].indexOf(o.state)&&(void 0===o.error||"object"==typeof o.error);return c&&o.error&&(c="string"==typeof o.error.message&&"string"==typeof o.error.code,c&&(a=new k(o.error.code,o.error.message))),c?new zr(i,o.state,a):(Te("SharedClientState",`Failed to parse target state for ID '${i}': ${r}`),null)}Os(){const i={state:this.state,updateTimeMs:Date.now()};return this.error&&(i.error={code:this.error.code,message:this.error.message}),JSON.stringify(i)}}class Ks{constructor(i,r){this.clientId=i,this.activeTargetIds=r}static $s(i,r){const o=JSON.parse(r);let a="object"==typeof o&&o.activeTargetIds instanceof Array,c=Ms();for(let l=0;a&&l<o.activeTargetIds.length;++l)a=Hl(o.activeTargetIds[l]),c=c.add(o.activeTargetIds[l]);return a?new Ks(i,c):(Te("SharedClientState",`Failed to parse client data for instance '${i}': ${r}`),null)}}class ya{constructor(i,r){this.clientId=i,this.onlineState=r}static $s(i){const r=JSON.parse(i);return"object"==typeof r&&-1!==["Unknown","Online","Offline"].indexOf(r.onlineState)&&"string"==typeof r.clientId?new ya(r.clientId,r.onlineState):(Te("SharedClientState",`Failed to parse online state: ${i}`),null)}}class va{constructor(){this.activeTargetIds=Ms()}Fs(i){this.activeTargetIds=this.activeTargetIds.add(i)}Ms(i){this.activeTargetIds=this.activeTargetIds.delete(i)}Os(){const i={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(i)}}class _a{constructor(i,r,o,a,c){this.window=i,this.Oe=r,this.persistenceKey=o,this.Ls=a,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.Bs=this.Us.bind(this),this.qs=new Ce(X),this.started=!1,this.Ks=[];const l=o.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=c,this.js=vh(this.persistenceKey,this.Ls),this.Qs=`firestore_sequence_number_${this.persistenceKey}`,this.qs=this.qs.insert(this.Ls,new va),this.Ws=new RegExp(`^firestore_clients_${l}_([^_]*)$`),this.Gs=new RegExp(`^firestore_mutations_${l}_(\\d+)(?:_(.*))?$`),this.zs=new RegExp(`^firestore_targets_${l}_(\\d+)$`),this.Hs=`firestore_online_state_${this.persistenceKey}`,this.Js=function(d){return`firestore_bundle_loaded_${d}`}(this.persistenceKey),this.window.addEventListener("storage",this.Bs)}static Pt(i){return!(!i||!i.localStorage)}start(){var i=this;return(0,C.Z)(function*(){const r=yield i.syncEngine.pn();for(const a of r){if(a===i.Ls)continue;const c=i.getItem(vh(i.persistenceKey,a));if(c){const l=Ks.$s(a,c);l&&(i.qs=i.qs.insert(l.clientId,l))}}i.Ys();const o=i.storage.getItem(i.Hs);if(o){const a=i.Xs(o);a&&i.Zs(a)}for(const a of i.Ks)i.Us(a);i.Ks=[],i.window.addEventListener("pagehide",()=>i.shutdown()),i.started=!0})()}writeSequenceNumber(i){this.setItem(this.Qs,JSON.stringify(i))}getAllActiveQueryTargets(){return this.ti(this.qs)}isActiveQueryTarget(i){let r=!1;return this.qs.forEach((o,a)=>{a.activeTargetIds.has(i)&&(r=!0)}),r}addPendingMutation(i){this.ei(i,"pending")}updateMutationState(i,r,o){this.ei(i,r,o),this.ni(i)}addLocalQueryTarget(i){let r="not-current";if(this.isActiveQueryTarget(i)){const o=this.storage.getItem(ma(this.persistenceKey,i));if(o){const a=zr.$s(i,o);a&&(r=a.state)}}return this.si.Fs(i),this.Ys(),r}removeLocalQueryTarget(i){this.si.Ms(i),this.Ys()}isLocalQueryTarget(i){return this.si.activeTargetIds.has(i)}clearQueryState(i){this.removeItem(ma(this.persistenceKey,i))}updateQueryState(i,r,o){this.ii(i,r,o)}handleUserChange(i,r,o){r.forEach(a=>{this.ni(a)}),this.currentUser=i,o.forEach(a=>{this.addPendingMutation(a)})}setOnlineState(i){this.ri(i)}notifyBundleLoaded(){this.oi()}shutdown(){this.started&&(this.window.removeEventListener("storage",this.Bs),this.removeItem(this.js),this.started=!1)}getItem(i){const r=this.storage.getItem(i);return L("SharedClientState","READ",i,r),r}setItem(i,r){L("SharedClientState","SET",i,r),this.storage.setItem(i,r)}removeItem(i){L("SharedClientState","REMOVE",i),this.storage.removeItem(i)}Us(i){var r=this;const o=i;if(o.storageArea===this.storage){if(L("SharedClientState","EVENT",o.key,o.newValue),o.key===this.js)return void Te("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Oe.enqueueRetryable((0,C.Z)(function*(){if(r.started){if(null!==o.key)if(r.Ws.test(o.key)){if(null==o.newValue){const a=r.ai(o.key);return r.ci(a,null)}{const a=r.ui(o.key,o.newValue);if(a)return r.ci(a.clientId,a)}}else if(r.Gs.test(o.key)){if(null!==o.newValue){const a=r.hi(o.key,o.newValue);if(a)return r.li(a)}}else if(r.zs.test(o.key)){if(null!==o.newValue){const a=r.fi(o.key,o.newValue);if(a)return r.di(a)}}else if(o.key===r.Hs){if(null!==o.newValue){const a=r.Xs(o.newValue);if(a)return r.Zs(a)}}else if(o.key===r.Qs){const a=function(c){let l=ot.T;if(null!=c)try{const d=JSON.parse(c);K("number"==typeof d),l=d}catch(d){Te("SharedClientState","Failed to read sequence number from WebStorage",d)}return l}(o.newValue);a!==ot.T&&r.sequenceNumberHandler(a)}else if(o.key===r.Js)return r.syncEngine.wi()}else r.Ks.push(o)}))}}get si(){return this.qs.get(this.Ls)}Ys(){this.setItem(this.js,this.si.Os())}ei(i,r,o){const a=new $s(this.currentUser,i,r,o),c=_h(this.persistenceKey,this.currentUser,i);this.setItem(c,a.Os())}ni(i){const r=_h(this.persistenceKey,this.currentUser,i);this.removeItem(r)}ri(i){this.storage.setItem(this.Hs,JSON.stringify({clientId:this.Ls,onlineState:i}))}ii(i,r,o){const a=ma(this.persistenceKey,i),c=new zr(i,r,o);this.setItem(a,c.Os())}oi(){this.setItem(this.Js,"value-not-used")}ai(i){const r=this.Ws.exec(i);return r?r[1]:null}ui(i,r){const o=this.ai(i);return Ks.$s(o,r)}hi(i,r){const o=this.Gs.exec(i),a=Number(o[1]);return $s.$s(new Fe(void 0!==o[2]?o[2]:null),a,r)}fi(i,r){const o=this.zs.exec(i),a=Number(o[1]);return zr.$s(a,r)}Xs(i){return ya.$s(i)}li(i){var r=this;return(0,C.Z)(function*(){if(i.user.uid===r.currentUser.uid)return r.syncEngine._i(i.batchId,i.state,i.error);L("SharedClientState",`Ignoring mutation for non-active user ${i.user.uid}`)})()}di(i){return this.syncEngine.mi(i.targetId,i.state,i.error)}ci(i,r){const o=r?this.qs.insert(i,r):this.qs.remove(i),a=this.ti(this.qs),c=this.ti(o),l=[],d=[];return c.forEach(f=>{a.has(f)||l.push(f)}),a.forEach(f=>{c.has(f)||d.push(f)}),this.syncEngine.gi(l,d).then(()=>{this.qs=o})}Zs(i){this.qs.get(i.clientId)&&this.onlineStateHandler(i.onlineState)}ti(i){let r=Ms();return i.forEach((o,a)=>{r=r.unionWith(a.activeTargetIds)}),r}}class wh{constructor(){this.yi=new va,this.pi={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(i){}updateMutationState(i,r,o){}addLocalQueryTarget(i){return this.yi.Fs(i),this.pi[i]||"not-current"}updateQueryState(i,r,o){this.pi[i]=r}removeLocalQueryTarget(i){this.yi.Ms(i)}isLocalQueryTarget(i){return this.yi.activeTargetIds.has(i)}clearQueryState(i){delete this.pi[i]}getAllActiveQueryTargets(){return this.yi.activeTargetIds}isActiveQueryTarget(i){return this.yi.activeTargetIds.has(i)}start(){return this.yi=new va,Promise.resolve()}handleUserChange(i,r,o){}setOnlineState(i){}shutdown(){}writeSequenceNumber(i){}notifyBundleLoaded(){}}class Hp{Ei(i){}shutdown(){}}class bh{constructor(){this.Ti=()=>this.Ii(),this.Ai=()=>this.Ri(),this.Pi=[],this.bi()}Ei(i){this.Pi.push(i)}shutdown(){window.removeEventListener("online",this.Ti),window.removeEventListener("offline",this.Ai)}bi(){window.addEventListener("online",this.Ti),window.addEventListener("offline",this.Ai)}Ii(){L("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const i of this.Pi)i(0)}Ri(){L("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const i of this.Pi)i(1)}static Pt(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}const Yp={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"};class Qp{constructor(i){this.vi=i.vi,this.Vi=i.Vi}Si(i){this.Di=i}Ci(i){this.Ni=i}onMessage(i){this.xi=i}close(){this.Vi()}send(i){this.vi(i)}ki(){this.Di()}$i(i){this.Ni(i)}Oi(i){this.xi(i)}}class Wp extends class{constructor(i){this.databaseInfo=i,this.databaseId=i.databaseId,this.Fi=(i.ssl?"https":"http")+"://"+i.host,this.Mi="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}Li(i,r,o,a){const c=this.Bi(i,r);L("RestConnection","Sending: ",c,o);const l={};return this.Ui(l,a),this.qi(i,c,l,o).then(d=>(L("RestConnection","Received: ",d),d),d=>{throw Er("RestConnection",`${i} failed with error: `,d,"url: ",c,"request:",o),d})}Ki(i,r,o,a){return this.Li(i,r,o,a)}Ui(i,r){if(i["X-Goog-Api-Client"]="gl-js/ fire/"+_i,i["Content-Type"]="text/plain",this.databaseInfo.appId&&(i["X-Firebase-GMPID"]=this.databaseInfo.appId),r)for(const o in r.authHeaders)r.authHeaders.hasOwnProperty(o)&&(i[o]=r.authHeaders[o])}Bi(i,r){return`${this.Fi}/v1/${r}:${Yp[i]}`}}{constructor(i){super(i),this.forceLongPolling=i.forceLongPolling,this.autoDetectLongPolling=i.autoDetectLongPolling,this.useFetchStreams=i.useFetchStreams}qi(i,r,o,a){return new Promise((c,l)=>{const d=new ql;d.listenOnce(Ul.COMPLETE,()=>{try{switch(d.getLastErrorCode()){case Es.NO_ERROR:const m=d.getResponseJson();L("Connection","XHR received:",JSON.stringify(m)),c(m);break;case Es.TIMEOUT:L("Connection",'RPC "'+i+'" timed out'),l(new k(D.DEADLINE_EXCEEDED,"Request time out"));break;case Es.HTTP_ERROR:const w=d.getStatus();if(L("Connection",'RPC "'+i+'" failed with status:',w,"response text:",d.getResponseText()),w>0){const b=d.getResponseJson().error;if(b&&b.status&&b.message){const x=function(P){const O=P.toLowerCase().replace(/_/g,"-");return Object.values(D).indexOf(O)>=0?O:D.UNKNOWN}(b.status);l(new k(x,b.message))}else l(new k(D.UNKNOWN,"Server responded with status "+d.getStatus()))}else l(new k(D.UNAVAILABLE,"Connection failed."));break;default:B()}}finally{L("Connection",'RPC "'+i+'" completed.')}});const f=JSON.stringify(a);d.send(r,"POST",f,o,15)})}ji(i,r){const o=[this.Fi,"/","google.firestore.v1.Firestore","/",i,"/channel"],a=new Ts,c=as(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(l.xmlHttpFactory=new Bl({})),this.Ui(l.initMessageHeaders,r),(0,W.uI)()||(0,W.b$)()||(0,W.d)()||(0,W.w1)()||(0,W.Mn)()||(0,W.ru)()||(l.httpHeadersOverwriteParam="$httpHeaders");const d=o.join("");L("Connection","Creating WebChannel: "+d,l);const f=a.createWebChannel(d,l);let m=!1,w=!1;const b=new Qp({vi:P=>{w?L("Connection","Not sending because WebChannel is closed:",P):(m||(L("Connection","Opening WebChannel transport."),f.open(),m=!0),L("Connection","WebChannel sending:",P),f.send(P))},Vi:()=>f.close()}),x=(P,O,q)=>{P.listen(O,H=>{try{q(H)}catch(ye){setTimeout(()=>{throw ye},0)}})};return x(f,Tr.EventType.OPEN,()=>{w||L("Connection","WebChannel transport opened.")}),x(f,Tr.EventType.CLOSE,()=>{w||(w=!0,L("Connection","WebChannel transport closed"),b.$i())}),x(f,Tr.EventType.ERROR,P=>{w||(w=!0,Er("Connection","WebChannel transport errored:",P),b.$i(new k(D.UNAVAILABLE,"The operation could not be completed")))}),x(f,Tr.EventType.MESSAGE,P=>{var O;if(!w){const q=P.data[0];K(!!q);const H=q,ye=H.error||(null===(O=H[0])||void 0===O?void 0:O.error);if(ye){L("Connection","WebChannel received error:",ye);const He=ye.status;let Qt=function(ts){const co=Se[ts];if(void 0!==co)return bu(co)}(He),Tt=ye.message;void 0===Qt&&(Qt=D.INTERNAL,Tt="Unknown error status: "+He+" with message "+ye.message),w=!0,b.$i(new k(Qt,Tt)),f.close()}else L("Connection","WebChannel received:",q),b.Oi(q)}}),x(c,Vl.STAT_EVENT,P=>{P.stat===ko_PROXY?L("Connection","Detected buffering proxy"):P.stat===ko_NOPROXY&&L("Connection","Detected no buffering proxy")}),setTimeout(()=>{b.ki()},0),b}}function Th(){return"undefined"!=typeof window?window:null}function Zs(){return"undefined"!=typeof document?document:null}function jr(s){return new rp(s,!0)}class wa{constructor(i,r,o=1e3,a=1.5,c=6e4){this.Oe=i,this.timerId=r,this.Qi=o,this.Wi=a,this.Gi=c,this.zi=0,this.Hi=null,this.Ji=Date.now(),this.reset()}reset(){this.zi=0}Yi(){this.zi=this.Gi}Xi(i){this.cancel();const r=Math.floor(this.zi+this.Zi()),o=Math.max(0,Date.now()-this.Ji),a=Math.max(0,r-o);a>0&&L("ExponentialBackoff",`Backing off for ${a} ms (base delay: ${this.zi} ms, delay with jitter: ${r} ms, last attempt: ${o} ms ago)`),this.Hi=this.Oe.enqueueAfterDelay(this.timerId,a,()=>(this.Ji=Date.now(),i())),this.zi*=this.Wi,this.zi<this.Qi&&(this.zi=this.Qi),this.zi>this.Gi&&(this.zi=this.Gi)}tr(){null!==this.Hi&&(this.Hi.skipDelay(),this.Hi=null)}cancel(){null!==this.Hi&&(this.Hi.cancel(),this.Hi=null)}Zi(){return(Math.random()-.5)*this.zi}}class Eh{constructor(i,r,o,a,c,l){this.Oe=i,this.er=o,this.nr=a,this.credentialsProvider=c,this.listener=l,this.state=0,this.sr=0,this.ir=null,this.stream=null,this.rr=new wa(i,r)}ar(){return 1===this.state||2===this.state||4===this.state}cr(){return 2===this.state}start(){3!==this.state?this.auth():this.ur()}stop(){var i=this;return(0,C.Z)(function*(){i.ar()&&(yield i.close(0))})()}hr(){this.state=0,this.rr.reset()}lr(){this.cr()&&null===this.ir&&(this.ir=this.Oe.enqueueAfterDelay(this.er,6e4,()=>this.dr()))}wr(i){this._r(),this.stream.send(i)}dr(){var i=this;return(0,C.Z)(function*(){if(i.cr())return i.close(0)})()}_r(){this.ir&&(this.ir.cancel(),this.ir=null)}close(i,r){var o=this;return(0,C.Z)(function*(){o._r(),o.rr.cancel(),o.sr++,3!==i?o.rr.reset():r&&r.code===D.RESOURCE_EXHAUSTED?(Te(r.toString()),Te("Using maximum backoff delay to prevent overloading the backend."),o.rr.Yi()):r&&r.code===D.UNAUTHENTICATED&&o.credentialsProvider.invalidateToken(),null!==o.stream&&(o.mr(),o.stream.close(),o.stream=null),o.state=i,yield o.listener.Ci(r)})()}mr(){}auth(){this.state=1;const i=this.gr(this.sr),r=this.sr;this.credentialsProvider.getToken().then(o=>{this.sr===r&&this.yr(o)},o=>{i(()=>{const a=new k(D.UNKNOWN,"Fetching auth token failed: "+o.message);return this.pr(a)})})}yr(i){const r=this.gr(this.sr);this.stream=this.Er(i),this.stream.Si(()=>{r(()=>(this.state=2,this.listener.Si()))}),this.stream.Ci(o=>{r(()=>this.pr(o))}),this.stream.onMessage(o=>{r(()=>this.onMessage(o))})}ur(){var i=this;this.state=4,this.rr.Xi((0,C.Z)(function*(){i.state=0,i.start()}))}pr(i){return L("PersistentStream",`close with error: ${i}`),this.stream=null,this.close(3,i)}gr(i){return r=>{this.Oe.enqueueAndForget(()=>this.sr===i?r():(L("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class Xp extends Eh{constructor(i,r,o,a,c){super(i,"listen_stream_connection_backoff","listen_stream_idle",r,o,c),this.N=a}Er(i){return this.nr.ji("Listen",i)}onMessage(i){this.rr.reset();const r=function(s,i){let r;if("targetChange"in i){const o="NO_CHANGE"===(f=i.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===f?1:"REMOVE"===f?2:"CURRENT"===f?3:"RESET"===f?4:B(),a=i.targetChange.targetIds||[],c=function(f,m){return f.D?(K(void 0===m||"string"==typeof m),ke.fromBase64String(m||"")):(K(void 0===m||m instanceof Uint8Array),ke.fromUint8Array(m||new Uint8Array))}(s,i.targetChange.resumeToken),l=i.targetChange.cause,d=l&&function(f){const m=void 0===f.code?D.UNKNOWN:bu(f.code);return new k(m,f.message||"")}(l);r=new Su(o,a,c,d||null)}else if("documentChange"in i){const o=i.documentChange,a=Rt(s,o.document.name),c=Le(o.document.updateTime),l=new qe({mapValue:{fields:o.document.fields}}),d=ue.newFoundDocument(a,c,l);r=new Fs(o.targetIds||[],o.removedTargetIds||[],d.key,d)}else if("documentDelete"in i){const o=i.documentDelete,a=Rt(s,o.document),c=o.readTime?Le(o.readTime):Y.min(),l=ue.newNoDocument(a,c);r=new Fs([],o.removedTargetIds||[],l.key,l)}else if("documentRemove"in i){const o=i.documentRemove,a=Rt(s,o.document);r=new Fs([],o.removedTargetIds||[],a,null)}else{if(!("filter"in i))return B();{const o=i.filter,c=new Yf(o.count||0);r=new Iu(o.targetId,c)}}var f;return r}(this.N,i),o=function(a){if(!("targetChange"in a))return Y.min();const c=a.targetChange;return c.targetIds&&c.targetIds.length?Y.min():c.readTime?Le(c.readTime):Y.min()}(i);return this.listener.Tr(r,o)}Ir(i){const r={};r.database=Vr(this.N),r.addTarget=function(a,c){let l;const d=c.target;return l=Cs(d)?{documents:Mu(a,d)}:{query:Fu(a,d)},l.targetId=c.targetId,c.resumeToken.approximateByteSize()>0?l.resumeToken=Au(a,c.resumeToken):c.snapshotVersion.compareTo(Y.min())>0&&(l.readTime=Fr(a,c.snapshotVersion.toTimestamp())),l}(this.N,i);const o=function(s,i){const r=function(o,a){switch(a){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return B()}}(0,i.purpose);return null==r?null:{"goog-listen-tags":r}}(0,i);o&&(r.labels=o),this.wr(r)}Ar(i){const r={};r.database=Vr(this.N),r.removeTarget=i,this.wr(r)}}class Jp extends Eh{constructor(i,r,o,a,c){super(i,"write_stream_connection_backoff","write_stream_idle",r,o,c),this.N=a,this.Rr=!1}get Pr(){return this.Rr}start(){this.Rr=!1,this.lastStreamToken=void 0,super.start()}mr(){this.Rr&&this.br([])}Er(i){return this.nr.ji("Write",i)}onMessage(i){if(K(!!i.streamToken),this.lastStreamToken=i.streamToken,this.Rr){this.rr.reset();const r=function(s,i){return s&&s.length>0?(K(void 0!==i),s.map(r=>function(o,a){let c=Le(o.updateTime?o.updateTime:a);return c.isEqual(Y.min())&&(c=Le(a)),new Kf(c,o.transformResults||[])}(r,i))):[]}(i.writeResults,i.commitTime),o=Le(i.commitTime);return this.listener.vr(o,r)}return K(!i.writeResults||0===i.writeResults.length),this.Rr=!0,this.listener.Vr()}Sr(){const i={};i.database=Vr(this.N),this.wr(i)}br(i){const r={streamToken:this.lastStreamToken,writes:i.map(o=>Us(this.N,o))};this.wr(r)}}class eg extends class{}{constructor(i,r,o){super(),this.credentials=i,this.nr=r,this.N=o,this.Dr=!1}Cr(){if(this.Dr)throw new k(D.FAILED_PRECONDITION,"The client has already been terminated.")}Li(i,r,o){return this.Cr(),this.credentials.getToken().then(a=>this.nr.Li(i,r,o,a)).catch(a=>{throw"FirebaseError"===a.name?(a.code===D.UNAUTHENTICATED&&this.credentials.invalidateToken(),a):new k(D.UNKNOWN,a.toString())})}Ki(i,r,o){return this.Cr(),this.credentials.getToken().then(a=>this.nr.Ki(i,r,o,a)).catch(a=>{throw"FirebaseError"===a.name?(a.code===D.UNAUTHENTICATED&&this.credentials.invalidateToken(),a):new k(D.UNKNOWN,a.toString())})}terminate(){this.Dr=!0}}class tg{constructor(i,r){this.asyncQueue=i,this.onlineStateHandler=r,this.state="Unknown",this.Nr=0,this.kr=null,this.$r=!0}Or(){0===this.Nr&&(this.Fr("Unknown"),this.kr=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.kr=null,this.Mr("Backend didn't respond within 10 seconds."),this.Fr("Offline"),Promise.resolve())))}Lr(i){"Online"===this.state?this.Fr("Unknown"):(this.Nr++,this.Nr>=1&&(this.Br(),this.Mr(`Connection failed 1 times. Most recent error: ${i.toString()}`),this.Fr("Offline")))}set(i){this.Br(),this.Nr=0,"Online"===i&&(this.$r=!1),this.Fr(i)}Fr(i){i!==this.state&&(this.state=i,this.onlineStateHandler(i))}Mr(i){const r=`Could not reach Cloud Firestore backend. ${i}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.$r?(Te(r),this.$r=!1):L("OnlineStateTracker",r)}Br(){null!==this.kr&&(this.kr.cancel(),this.kr=null)}}class ng{constructor(i,r,o,a,c){var l=this;this.localStore=i,this.datastore=r,this.asyncQueue=o,this.remoteSyncer={},this.Ur=[],this.qr=new Map,this.Kr=new Set,this.jr=[],this.Qr=c,this.Qr.Ei(d=>{o.enqueueAndForget((0,C.Z)(function*(){var f;bn(l)&&(L("RemoteStore","Restarting streams for network reachability change."),yield(f=(0,C.Z)(function*(m){const w=M(m);w.Kr.add(4),yield qi(w),w.Wr.set("Unknown"),w.Kr.delete(4),yield $r(w)}),function(m){return f.apply(this,arguments)})(l))}))}),this.Wr=new tg(o,a)}}function $r(s){return ba.apply(this,arguments)}function ba(){return(ba=(0,C.Z)(function*(s){if(bn(s))for(const i of s.jr)yield i(!0)})).apply(this,arguments)}function qi(s){return Ta.apply(this,arguments)}function Ta(){return(Ta=(0,C.Z)(function*(s){for(const i of s.jr)yield i(!1)})).apply(this,arguments)}function Hs(s,i){const r=M(s);r.qr.has(i.targetId)||(r.qr.set(i.targetId,i),Sa(r)?Ia(r):zi(r).cr()&&Ea(r,i))}function Kr(s,i){const r=M(s),o=zi(r);r.qr.delete(i),o.cr()&&Ih(r,i),0===r.qr.size&&(o.cr()?o.lr():bn(r)&&r.Wr.set("Unknown"))}function Ea(s,i){s.Gr.Y(i.targetId),zi(s).Ir(i)}function Ih(s,i){s.Gr.Y(i),zi(s).Ar(i)}function Ia(s){s.Gr=new tp({getRemoteKeysForTarget:i=>s.remoteSyncer.getRemoteKeysForTarget(i),Et:i=>s.qr.get(i)||null}),zi(s).start(),s.Wr.Or()}function Sa(s){return bn(s)&&!zi(s).ar()&&s.qr.size>0}function bn(s){return 0===M(s).Kr.size}function Sh(s){s.Gr=void 0}function ig(s){return Da.apply(this,arguments)}function Da(){return(Da=(0,C.Z)(function*(s){s.qr.forEach((i,r)=>{Ea(s,i)})})).apply(this,arguments)}function rg(s,i){return xa.apply(this,arguments)}function xa(){return(xa=(0,C.Z)(function*(s,i){Sh(s),Sa(s)?(s.Wr.Lr(i),Ia(s)):s.Wr.set("Unknown")})).apply(this,arguments)}function sg(s,i,r){return Ca.apply(this,arguments)}function Ca(){return(Ca=(0,C.Z)(function*(s,i,r){if(s.Wr.set("Online"),i instanceof Su&&2===i.state&&i.cause)try{yield(o=(0,C.Z)(function*(a,c){const l=c.cause;for(const d of c.targetIds)a.qr.has(d)&&(yield a.remoteSyncer.rejectListen(d,l),a.qr.delete(d),a.Gr.removeTarget(d))}),function(a,c){return o.apply(this,arguments)})(s,i)}catch(o){L("RemoteStore","Failed to remove targets %s: %s ",i.targetIds.join(","),o),yield Ys(s,o)}else if(i instanceof Fs?s.Gr.rt(i):i instanceof Iu?s.Gr.ft(i):s.Gr.ct(i),!r.isEqual(Y.min()))try{const o=yield ph(s.localStore);r.compareTo(o)>=0&&(yield function(a,c){const l=a.Gr._t(c);return l.targetChanges.forEach((d,f)=>{if(d.resumeToken.approximateByteSize()>0){const m=a.qr.get(f);m&&a.qr.set(f,m.withResumeToken(d.resumeToken,c))}}),l.targetMismatches.forEach(d=>{const f=a.qr.get(d);if(!f)return;a.qr.set(d,f.withResumeToken(ke.EMPTY_BYTE_STRING,f.snapshotVersion)),Ih(a,d);const m=new yn(f.target,d,1,f.sequenceNumber);Ea(a,m)}),a.remoteSyncer.applyRemoteEvent(l)}(s,r))}catch(o){L("RemoteStore","Failed to raise snapshot:",o),yield Ys(s,o)}var o})).apply(this,arguments)}function Ys(s,i,r){return Aa.apply(this,arguments)}function Aa(){return(Aa=(0,C.Z)(function*(s,i,r){if(!Zn(i))throw i;s.Kr.add(1),yield qi(s),s.Wr.set("Offline"),r||(r=()=>ph(s.localStore)),s.asyncQueue.enqueueRetryable((0,C.Z)(function*(){L("RemoteStore","Retrying IndexedDB access"),yield r(),s.Kr.delete(1),yield $r(s)}))})).apply(this,arguments)}function Dh(s,i){return i().catch(r=>Ys(s,r,i))}function Gi(s){return Ra.apply(this,arguments)}function Ra(){return(Ra=(0,C.Z)(function*(s){const i=M(s),r=Tn(i);let o=i.Ur.length>0?i.Ur[i.Ur.length-1].batchId:-1;for(;og(i);)try{const a=yield Fp(i.localStore,o);if(null===a){0===i.Ur.length&&r.lr();break}o=a.batchId,ag(i,a)}catch(a){yield Ys(i,a)}xh(i)&&Ch(i)})).apply(this,arguments)}function og(s){return bn(s)&&s.Ur.length<10}function ag(s,i){s.Ur.push(i);const r=Tn(s);r.cr()&&r.Pr&&r.br(i.mutations)}function xh(s){return bn(s)&&!Tn(s).ar()&&s.Ur.length>0}function Ch(s){Tn(s).start()}function cg(s){return Pa.apply(this,arguments)}function Pa(){return(Pa=(0,C.Z)(function*(s){Tn(s).Sr()})).apply(this,arguments)}function lg(s){return Na.apply(this,arguments)}function Na(){return(Na=(0,C.Z)(function*(s){const i=Tn(s);for(const r of s.Ur)i.br(r.mutations)})).apply(this,arguments)}function ug(s,i,r){return ka.apply(this,arguments)}function ka(){return(ka=(0,C.Z)(function*(s,i,r){const o=s.Ur.shift(),a=Xo.from(o,i,r);yield Dh(s,()=>s.remoteSyncer.applySuccessfulWrite(a)),yield Gi(s)})).apply(this,arguments)}function hg(s,i){return La.apply(this,arguments)}function La(){return(La=(0,C.Z)(function*(s,i){var r;i&&Tn(s).Pr&&(yield(r=(0,C.Z)(function*(o,a){if(wu(c=a.code)&&c!==D.ABORTED){const l=o.Ur.shift();Tn(o).hr(),yield Dh(o,()=>o.remoteSyncer.rejectFailedWrite(l.batchId,a)),yield Gi(o)}var c}),function(o,a){return r.apply(this,arguments)})(s,i)),xh(s)&&Ch(s)})).apply(this,arguments)}function Oa(s,i){return Ma.apply(this,arguments)}function Ma(){return(Ma=(0,C.Z)(function*(s,i){const r=M(s);i?(r.Kr.delete(2),yield $r(r)):i||(r.Kr.add(2),yield qi(r),r.Wr.set("Unknown"))})).apply(this,arguments)}function zi(s){return s.zr||(s.zr=function(i,r,o){const a=M(i);return a.Cr(),new Xp(r,a.nr,a.credentials,a.N,o)}(s.datastore,s.asyncQueue,{Si:ig.bind(null,s),Ci:rg.bind(null,s),Tr:sg.bind(null,s)}),s.jr.push(function(){var i=(0,C.Z)(function*(r){r?(s.zr.hr(),Sa(s)?Ia(s):s.Wr.set("Unknown")):(yield s.zr.stop(),Sh(s))});return function(r){return i.apply(this,arguments)}}())),s.zr}function Tn(s){return s.Hr||(s.Hr=function(i,r,o){const a=M(i);return a.Cr(),new Jp(r,a.nr,a.credentials,a.N,o)}(s.datastore,s.asyncQueue,{Si:cg.bind(null,s),Ci:hg.bind(null,s),Vr:lg.bind(null,s),vr:ug.bind(null,s)}),s.jr.push(function(){var i=(0,C.Z)(function*(r){r?(s.Hr.hr(),yield Gi(s)):(yield s.Hr.stop(),s.Ur.length>0&&(L("RemoteStore",`Stopping write stream with ${s.Ur.length} pending writes`),s.Ur=[]))});return function(r){return i.apply(this,arguments)}}())),s.Hr}class Fa{constructor(i,r,o,a,c){this.asyncQueue=i,this.timerId=r,this.targetTimeMs=o,this.op=a,this.removalCallback=c,this.deferred=new Pe,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(l=>{})}static createAndSchedule(i,r,o,a,c){const l=Date.now()+o,d=new Fa(i,r,l,a,c);return d.start(o),d}start(i){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),i)}skipDelay(){return this.handleDelayElapsed()}cancel(i){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new k(D.CANCELLED,"Operation cancelled"+(i?": "+i:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(i=>this.deferred.resolve(i))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function ji(s,i){if(Te("AsyncQueue",`${i}: ${s}`),Zn(s))return new k(D.UNAVAILABLE,`${i}: ${s}`);throw s}class $i{constructor(i){this.comparator=i?(r,o)=>i(r,o)||V.comparator(r.key,o.key):(r,o)=>V.comparator(r.key,o.key),this.keyedMap=Zo(),this.sortedSet=new Ce(this.comparator)}static emptySet(i){return new $i(i.comparator)}has(i){return null!=this.keyedMap.get(i)}get(i){return this.keyedMap.get(i)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(i){const r=this.keyedMap.get(i);return r?this.sortedSet.indexOf(r):-1}get size(){return this.sortedSet.size}forEach(i){this.sortedSet.inorderTraversal((r,o)=>(i(r),!1))}add(i){const r=this.delete(i.key);return r.copy(r.keyedMap.insert(i.key,i),r.sortedSet.insert(i,null))}delete(i){const r=this.get(i);return r?this.copy(this.keyedMap.remove(i),this.sortedSet.remove(r)):this}isEqual(i){if(!(i instanceof $i)||this.size!==i.size)return!1;const r=this.sortedSet.getIterator(),o=i.sortedSet.getIterator();for(;r.hasNext();){const a=r.getNext().key,c=o.getNext().key;if(!a.isEqual(c))return!1}return!0}toString(){const i=[];return this.forEach(r=>{i.push(r.toString())}),0===i.length?"DocumentSet ()":"DocumentSet (\n  "+i.join("  \n")+"\n)"}copy(i,r){const o=new $i;return o.comparator=this.comparator,o.keyedMap=i,o.sortedSet=r,o}}class Ah{constructor(){this.Jr=new Ce(V.comparator)}track(i){const r=i.doc.key,o=this.Jr.get(r);o?0!==i.type&&3===o.type?this.Jr=this.Jr.insert(r,i):3===i.type&&1!==o.type?this.Jr=this.Jr.insert(r,{type:o.type,doc:i.doc}):2===i.type&&2===o.type?this.Jr=this.Jr.insert(r,{type:2,doc:i.doc}):2===i.type&&0===o.type?this.Jr=this.Jr.insert(r,{type:0,doc:i.doc}):1===i.type&&0===o.type?this.Jr=this.Jr.remove(r):1===i.type&&2===o.type?this.Jr=this.Jr.insert(r,{type:1,doc:o.doc}):0===i.type&&1===o.type?this.Jr=this.Jr.insert(r,{type:2,doc:i.doc}):B():this.Jr=this.Jr.insert(r,i)}Yr(){const i=[];return this.Jr.inorderTraversal((r,o)=>{i.push(o)}),i}}class Ki{constructor(i,r,o,a,c,l,d,f){this.query=i,this.docs=r,this.oldDocs=o,this.docChanges=a,this.mutatedKeys=c,this.fromCache=l,this.syncStateChanged=d,this.excludesMetadataChanges=f}static fromInitialDocuments(i,r,o,a){const c=[];return r.forEach(l=>{c.push({type:0,doc:l})}),new Ki(i,r,$i.emptySet(r),c,o,a,!0,!1)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(i){if(!(this.fromCache===i.fromCache&&this.syncStateChanged===i.syncStateChanged&&this.mutatedKeys.isEqual(i.mutatedKeys)&&Rr(this.query,i.query)&&this.docs.isEqual(i.docs)&&this.oldDocs.isEqual(i.oldDocs)))return!1;const r=this.docChanges,o=i.docChanges;if(r.length!==o.length)return!1;for(let a=0;a<r.length;a++)if(r[a].type!==o[a].type||!r[a].doc.isEqual(o[a].doc))return!1;return!0}}class dg{constructor(){this.Xr=void 0,this.listeners=[]}}class fg{constructor(){this.queries=new Ui(i=>su(i),Rr),this.onlineState="Unknown",this.Zr=new Set}}function Ua(s,i){return Va.apply(this,arguments)}function Va(){return(Va=(0,C.Z)(function*(s,i){const r=M(s),o=i.query;let a=!1,c=r.queries.get(o);if(c||(a=!0,c=new dg),a)try{c.Xr=yield r.onListen(o)}catch(l){const d=ji(l,`Initialization of query '${jo(i.query)}' failed`);return void i.onError(d)}r.queries.set(o,c),c.listeners.push(i),i.eo(r.onlineState),c.Xr&&i.no(c.Xr)&&Ga(r)})).apply(this,arguments)}function Ba(s,i){return qa.apply(this,arguments)}function qa(){return(qa=(0,C.Z)(function*(s,i){const r=M(s),o=i.query;let a=!1;const c=r.queries.get(o);if(c){const l=c.listeners.indexOf(i);l>=0&&(c.listeners.splice(l,1),a=0===c.listeners.length)}if(a)return r.queries.delete(o),r.onUnlisten(o)})).apply(this,arguments)}function pg(s,i){const r=M(s);let o=!1;for(const a of i){const l=r.queries.get(a.query);if(l){for(const d of l.listeners)d.no(a)&&(o=!0);l.Xr=a}}o&&Ga(r)}function gg(s,i,r){const o=M(s),a=o.queries.get(i);if(a)for(const c of a.listeners)c.onError(r);o.queries.delete(i)}function Ga(s){s.Zr.forEach(i=>{i.next()})}class za{constructor(i,r,o){this.query=i,this.so=r,this.io=!1,this.ro=null,this.onlineState="Unknown",this.options=o||{}}no(i){if(!this.options.includeMetadataChanges){const o=[];for(const a of i.docChanges)3!==a.type&&o.push(a);i=new Ki(i.query,i.docs,i.oldDocs,o,i.mutatedKeys,i.fromCache,i.syncStateChanged,!0)}let r=!1;return this.io?this.oo(i)&&(this.so.next(i),r=!0):this.ao(i,this.onlineState)&&(this.co(i),r=!0),this.ro=i,r}onError(i){this.so.error(i)}eo(i){this.onlineState=i;let r=!1;return this.ro&&!this.io&&this.ao(this.ro,i)&&(this.co(this.ro),r=!0),r}ao(i,r){return!i.fromCache||!(this.options.uo&&"Offline"!==r||i.docs.isEmpty()&&"Offline"!==r)}oo(i){return i.docChanges.length>0||!!(i.syncStateChanged||this.ro&&this.ro.hasPendingWrites!==i.hasPendingWrites)&&!0===this.options.includeMetadataChanges}co(i){i=Ki.fromInitialDocuments(i.query,i.docs,i.mutatedKeys,i.fromCache),this.io=!0,this.so.next(i)}}class mg{constructor(i,r){this.payload=i,this.byteLength=r}ho(){return"metadata"in this.payload}}class Rh{constructor(i){this.N=i}zn(i){return Rt(this.N,i)}Hn(i){return i.metadata.exists?Lu(this.N,i.document,!1):ue.newNoDocument(this.zn(i.metadata.name),this.Jn(i.metadata.readTime))}Jn(i){return Le(i)}}class yg{constructor(i,r,o){this.lo=i,this.localStore=r,this.N=o,this.queries=[],this.documents=[],this.progress=Ph(i)}fo(i){this.progress.bytesLoaded+=i.byteLength;let r=this.progress.documentsLoaded;return i.payload.namedQuery?this.queries.push(i.payload.namedQuery):i.payload.documentMetadata?(this.documents.push({metadata:i.payload.documentMetadata}),i.payload.documentMetadata.exists||++r):i.payload.document&&(this.documents[this.documents.length-1].document=i.payload.document,++r),r!==this.progress.documentsLoaded?(this.progress.documentsLoaded=r,Object.assign({},this.progress)):null}wo(i){const r=new Map,o=new Rh(this.N);for(const a of i)if(a.metadata.queries){const c=o.zn(a.metadata.name);for(const l of a.metadata.queries){const d=(r.get(l)||ie()).add(c);r.set(l,d)}}return r}complete(){var i=this;return(0,C.Z)(function*(){const r=yield function(s,i,r,o){return da.apply(this,arguments)}(i.localStore,new Rh(i.N),i.documents,i.lo.id),o=i.wo(i.documents);for(const a of i.queries)yield Bp(i.localStore,a,o.get(a.name));return i.progress.taskState="Success",new kp(Object.assign({},i.progress),r)})()}}function Ph(s){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:s.totalDocuments,totalBytes:s.totalBytes}}class Nh{constructor(i){this.key=i}}class kh{constructor(i){this.key=i}}class Lh{constructor(i,r){this.query=i,this._o=r,this.mo=null,this.current=!1,this.yo=ie(),this.mutatedKeys=ie(),this.po=ou(i),this.Eo=new $i(this.po)}get To(){return this._o}Io(i,r){const o=r?r.Ao:new Ah,a=r?r.Eo:this.Eo;let c=r?r.mutatedKeys:this.mutatedKeys,l=a,d=!1;const f=Rs(this.query)&&a.size===this.query.limit?a.last():null,m=Ps(this.query)&&a.size===this.query.limit?a.first():null;if(i.inorderTraversal((w,b)=>{const x=a.get(w),P=Pr(this.query,b)?b:null,O=!!x&&this.mutatedKeys.has(x.key),q=!!P&&(P.hasLocalMutations||this.mutatedKeys.has(P.key)&&P.hasCommittedMutations);let H=!1;x&&P?x.data.isEqual(P.data)?O!==q&&(o.track({type:3,doc:P}),H=!0):this.Ro(x,P)||(o.track({type:2,doc:P}),H=!0,(f&&this.po(P,f)>0||m&&this.po(P,m)<0)&&(d=!0)):!x&&P?(o.track({type:0,doc:P}),H=!0):x&&!P&&(o.track({type:1,doc:x}),H=!0,(f||m)&&(d=!0)),H&&(P?(l=l.add(P),c=q?c.add(w):c.delete(w)):(l=l.delete(w),c=c.delete(w)))}),Rs(this.query)||Ps(this.query))for(;l.size>this.query.limit;){const w=Rs(this.query)?l.last():l.first();l=l.delete(w.key),c=c.delete(w.key),o.track({type:1,doc:w})}return{Eo:l,Ao:o,Ln:d,mutatedKeys:c}}Ro(i,r){return i.hasLocalMutations&&r.hasCommittedMutations&&!r.hasLocalMutations}applyChanges(i,r,o){const a=this.Eo;this.Eo=i.Eo,this.mutatedKeys=i.mutatedKeys;const c=i.Ao.Yr();c.sort((m,w)=>function(b,x){const P=O=>{switch(O){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return B()}};return P(b)-P(x)}(m.type,w.type)||this.po(m.doc,w.doc)),this.Po(o);const l=r?this.bo():[],d=0===this.yo.size&&this.current?1:0,f=d!==this.mo;return this.mo=d,0!==c.length||f?{snapshot:new Ki(this.query,i.Eo,a,c,i.mutatedKeys,0===d,f,!1),vo:l}:{vo:l}}eo(i){return this.current&&"Offline"===i?(this.current=!1,this.applyChanges({Eo:this.Eo,Ao:new Ah,mutatedKeys:this.mutatedKeys,Ln:!1},!1)):{vo:[]}}Vo(i){return!this._o.has(i)&&!!this.Eo.has(i)&&!this.Eo.get(i).hasLocalMutations}Po(i){i&&(i.addedDocuments.forEach(r=>this._o=this._o.add(r)),i.modifiedDocuments.forEach(r=>{}),i.removedDocuments.forEach(r=>this._o=this._o.delete(r)),this.current=i.current)}bo(){if(!this.current)return[];const i=this.yo;this.yo=ie(),this.Eo.forEach(o=>{this.Vo(o.key)&&(this.yo=this.yo.add(o.key))});const r=[];return i.forEach(o=>{this.yo.has(o)||r.push(new kh(o))}),this.yo.forEach(o=>{i.has(o)||r.push(new Nh(o))}),r}So(i){this._o=i.Gn,this.yo=ie();const r=this.Io(i.documents);return this.applyChanges(r,!0)}Do(){return Ki.fromInitialDocuments(this.query,this.Eo,this.mutatedKeys,0===this.mo)}}class vg{constructor(i,r,o){this.query=i,this.targetId=r,this.view=o}}class _g{constructor(i){this.key=i,this.Co=!1}}class wg{constructor(i,r,o,a,c,l){this.localStore=i,this.remoteStore=r,this.eventManager=o,this.sharedClientState=a,this.currentUser=c,this.maxConcurrentLimboResolutions=l,this.No={},this.xo=new Ui(d=>su(d),Rr),this.ko=new Map,this.$o=new Set,this.Oo=new Ce(V.comparator),this.Fo=new Map,this.Mo=new pa,this.Lo={},this.Bo=new Map,this.Uo=Yn.ie(),this.onlineState="Unknown",this.qo=void 0}get isPrimaryClient(){return!0===this.qo}}function bg(s,i){return ja.apply(this,arguments)}function ja(){return(ja=(0,C.Z)(function*(s,i){const r=fc(s);let o,a;const c=r.xo.get(i);if(c)o=c.targetId,r.sharedClientState.addLocalQueryTarget(o),a=c.view.Do();else{const l=yield Vi(r.localStore,dt(i)),d=r.sharedClientState.addLocalQueryTarget(l.targetId);o=l.targetId,a=yield $a(r,i,o,"current"===d),r.isPrimaryClient&&Hs(r.remoteStore,l)}return a})).apply(this,arguments)}function $a(s,i,r,o){return Ka.apply(this,arguments)}function Ka(){return(Ka=(0,C.Z)(function*(s,i,r,o){s.Ko=(w,b,x)=>{return(P=(0,C.Z)(function*(O,q,H,ye){let He=q.view.Io(H);He.Ln&&(He=yield js(O.localStore,q.query,!1).then(({documents:ts})=>q.view.Io(ts,He)));const Qt=ye&&ye.targetChanges.get(q.targetId),Tt=q.view.applyChanges(He,O.isPrimaryClient,Qt);return nc(O,q.targetId,Tt.vo),Tt.snapshot}),function(O,q,H,ye){return P.apply(this,arguments)})(s,w,b,x);var P};const a=yield js(s.localStore,i,!0),c=new Lh(i,a.Gn),l=c.Io(a.documents),d=Mr.createSynthesizedTargetChangeForCurrentChange(r,o&&"Offline"!==s.onlineState),f=c.applyChanges(l,s.isPrimaryClient,d);nc(s,r,f.vo);const m=new vg(i,r,c);return s.xo.set(i,m),s.ko.has(r)?s.ko.get(r).push(i):s.ko.set(r,[i]),f.snapshot})).apply(this,arguments)}function Tg(s,i){return Za.apply(this,arguments)}function Za(){return(Za=(0,C.Z)(function*(s,i){const r=M(s),o=r.xo.get(i),a=r.ko.get(o.targetId);if(a.length>1)return r.ko.set(o.targetId,a.filter(c=>!Rr(c,i))),void r.xo.delete(i);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(o.targetId),r.sharedClientState.isActiveQueryTarget(o.targetId)||(yield Bi(r.localStore,o.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(o.targetId),Kr(r.remoteStore,o.targetId),Zi(r,o.targetId)}).catch(Qn))):(Zi(r,o.targetId),yield Bi(r.localStore,o.targetId,!0))})).apply(this,arguments)}function Ha(){return(Ha=(0,C.Z)(function*(s,i,r){const o=pc(s);try{const a=yield function(c,l){const d=M(c),f=Ne.now(),m=l.reduce((b,x)=>b.add(x.key),ie());let w;return d.persistence.runTransaction("Locally write mutations","readwrite",b=>d.Qn.bn(b,m).next(x=>{w=x;const P=[];for(const O of l){const q=Hf(O,w.get(O.key));null!=q&&P.push(new gn(O.key,q,Xl(q.value.mapValue),Ie.exists(!0)))}return d.In.addMutationBatch(b,f,P,l)})).then(b=>(b.applyToLocalDocumentSet(w),{batchId:b.batchId,changes:w}))}(o.localStore,i);o.sharedClientState.addPendingMutation(a.batchId),function(c,l,d){let f=c.Lo[c.currentUser.toKey()];f||(f=new Ce(X)),f=f.insert(l,d),c.Lo[c.currentUser.toKey()]=f}(o,a.batchId,r),yield Zt(o,a.changes),yield Gi(o.remoteStore)}catch(a){const c=ji(a,"Failed to persist write");r.reject(c)}})).apply(this,arguments)}function Oh(s,i){return Ya.apply(this,arguments)}function Ya(){return(Ya=(0,C.Z)(function*(s,i){const r=M(s);try{const o=yield Mp(r.localStore,i);i.targetChanges.forEach((a,c)=>{const l=r.Fo.get(c);l&&(K(a.addedDocuments.size+a.modifiedDocuments.size+a.removedDocuments.size<=1),a.addedDocuments.size>0?l.Co=!0:a.modifiedDocuments.size>0?K(l.Co):a.removedDocuments.size>0&&(K(l.Co),l.Co=!1))}),yield Zt(r,o,i)}catch(o){yield Qn(o)}})).apply(this,arguments)}function Mh(s,i,r){const o=M(s);if(o.isPrimaryClient&&0===r||!o.isPrimaryClient&&1===r){const a=[];o.xo.forEach((c,l)=>{const d=l.view.eo(i);d.snapshot&&a.push(d.snapshot)}),function(c,l){const d=M(c);d.onlineState=l;let f=!1;d.queries.forEach((m,w)=>{for(const b of w.listeners)b.eo(l)&&(f=!0)}),f&&Ga(d)}(o.eventManager,i),a.length&&o.No.Tr(a),o.onlineState=i,o.isPrimaryClient&&o.sharedClientState.setOnlineState(i)}}function Ig(s,i,r){return Qa.apply(this,arguments)}function Qa(){return(Qa=(0,C.Z)(function*(s,i,r){const o=M(s);o.sharedClientState.updateQueryState(i,"rejected",r);const a=o.Fo.get(i),c=a&&a.key;if(c){let l=new Ce(V.comparator);l=l.insert(c,ue.newNoDocument(c,Y.min()));const d=ie().add(c),f=new Or(Y.min(),new Map,new pe(X),l,d);yield Oh(o,f),o.Oo=o.Oo.remove(c),o.Fo.delete(i),ic(o)}else yield Bi(o.localStore,i,!1).then(()=>Zi(o,i,r)).catch(Qn)})).apply(this,arguments)}function Sg(s,i){return Wa.apply(this,arguments)}function Wa(){return(Wa=(0,C.Z)(function*(s,i){const r=M(s),o=i.batch.batchId;try{const a=yield Op(r.localStore,i);tc(r,o,null),ec(r,o),r.sharedClientState.updateMutationState(o,"acknowledged"),yield Zt(r,a)}catch(a){yield Qn(a)}})).apply(this,arguments)}function Dg(s,i,r){return Xa.apply(this,arguments)}function Xa(){return(Xa=(0,C.Z)(function*(s,i,r){const o=M(s);try{const a=yield function(c,l){const d=M(c);return d.persistence.runTransaction("Reject batch","readwrite-primary",f=>{let m;return d.In.lookupMutationBatch(f,l).next(w=>(K(null!==w),m=w.keys(),d.In.removeMutationBatch(f,w))).next(()=>d.In.performConsistencyCheck(f)).next(()=>d.Qn.bn(f,m))})}(o.localStore,i);tc(o,i,r),ec(o,i),o.sharedClientState.updateMutationState(i,"rejected",r),yield Zt(o,a)}catch(a){yield Qn(a)}})).apply(this,arguments)}function Ja(){return(Ja=(0,C.Z)(function*(s,i){const r=M(s);bn(r.remoteStore)||L("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const o=yield function(c){const l=M(c);return l.persistence.runTransaction("Get highest unacknowledged batch id","readonly",d=>l.In.getHighestUnacknowledgedBatchId(d))}(r.localStore);if(-1===o)return void i.resolve();const a=r.Bo.get(o)||[];a.push(i),r.Bo.set(o,a)}catch(o){const a=ji(o,"Initialization of waitForPendingWrites() operation failed");i.reject(a)}})).apply(this,arguments)}function ec(s,i){(s.Bo.get(i)||[]).forEach(r=>{r.resolve()}),s.Bo.delete(i)}function tc(s,i,r){const o=M(s);let a=o.Lo[o.currentUser.toKey()];if(a){const c=a.get(i);c&&(r?c.reject(r):c.resolve(),a=a.remove(i)),o.Lo[o.currentUser.toKey()]=a}}function Zi(s,i,r=null){s.sharedClientState.removeLocalQueryTarget(i);for(const o of s.ko.get(i))s.xo.delete(o),r&&s.No.jo(o,r);s.ko.delete(i),s.isPrimaryClient&&s.Mo.cs(i).forEach(o=>{s.Mo.containsKey(o)||Fh(s,o)})}function Fh(s,i){s.$o.delete(i.path.canonicalString());const r=s.Oo.get(i);null!==r&&(Kr(s.remoteStore,r),s.Oo=s.Oo.remove(i),s.Fo.delete(r),ic(s))}function nc(s,i,r){for(const o of r)o instanceof Nh?(s.Mo.addReference(o.key,i),Cg(s,o)):o instanceof kh?(L("SyncEngine","Document no longer in limbo: "+o.key),s.Mo.removeReference(o.key,i),s.Mo.containsKey(o.key)||Fh(s,o.key)):B()}function Cg(s,i){const r=i.key,o=r.path.canonicalString();s.Oo.get(r)||s.$o.has(o)||(L("SyncEngine","New document in limbo: "+r),s.$o.add(o),ic(s))}function ic(s){for(;s.$o.size>0&&s.Oo.size<s.maxConcurrentLimboResolutions;){const i=s.$o.values().next().value;s.$o.delete(i);const r=new V(te.fromString(i)),o=s.Uo.next();s.Fo.set(o,new _g(r)),s.Oo=s.Oo.insert(r,o),Hs(s.remoteStore,new yn(dt(Si(r.path)),o,2,ot.T))}}function Zt(s,i,r){return rc.apply(this,arguments)}function rc(){return(rc=(0,C.Z)(function*(s,i,r){const o=M(s),a=[],c=[],l=[];var d;o.xo.isEmpty()||(o.xo.forEach((d,f)=>{l.push(o.Ko(f,i,r).then(m=>{if(m){o.isPrimaryClient&&o.sharedClientState.updateQueryState(f.targetId,m.fromCache?"not-current":"current"),a.push(m);const w=ca.kn(f.targetId,m);c.push(w)}}))}),yield Promise.all(l),o.No.Tr(a),yield(d=(0,C.Z)(function*(f,m){const w=M(f);try{yield w.persistence.runTransaction("notifyLocalViewChanges","readwrite",b=>N.forEach(m,x=>N.forEach(x.Nn,P=>w.persistence.referenceDelegate.addReference(b,x.targetId,P)).next(()=>N.forEach(x.xn,P=>w.persistence.referenceDelegate.removeReference(b,x.targetId,P)))))}catch(b){if(!Zn(b))throw b;L("LocalStore","Failed to update sequence numbers: "+b)}for(const b of m){const x=b.targetId;if(!b.fromCache){const P=w.Un.get(x),q=P.withLastLimboFreeSnapshotVersion(P.snapshotVersion);w.Un=w.Un.insert(x,q)}}}),function(f,m){return d.apply(this,arguments)})(o.localStore,c))})).apply(this,arguments)}function Ag(s,i){return sc.apply(this,arguments)}function sc(){return(sc=(0,C.Z)(function*(s,i){const r=M(s);if(!r.currentUser.isEqual(i)){L("SyncEngine","User change. New user:",i.toKey());const o=yield fh(r.localStore,i);r.currentUser=i,(a=r).Bo.forEach(l=>{l.forEach(d=>{d.reject(new k(D.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),a.Bo.clear(),r.sharedClientState.handleUserChange(i,o.removedBatchIds,o.addedBatchIds),yield Zt(r,o.Wn)}var a})).apply(this,arguments)}function Rg(s,i){const r=M(s),o=r.Fo.get(i);if(o&&o.Co)return ie().add(o.key);{let a=ie();const c=r.ko.get(i);if(!c)return a;for(const l of c){const d=r.xo.get(l);a=a.unionWith(d.view.To)}return a}}function Pg(s,i){return oc.apply(this,arguments)}function oc(){return(oc=(0,C.Z)(function*(s,i){const r=M(s),o=yield js(r.localStore,i.query,!0),a=i.view.So(o);return r.isPrimaryClient&&nc(r,i.targetId,a.vo),a})).apply(this,arguments)}function Ng(s){return ac.apply(this,arguments)}function ac(){return(ac=(0,C.Z)(function*(s){const i=M(s);return yh(i.localStore).then(r=>Zt(i,r))})).apply(this,arguments)}function kg(s,i,r,o){return cc.apply(this,arguments)}function cc(){return(cc=(0,C.Z)(function*(s,i,r,o){const a=M(s),c=yield function(l,d){const f=M(l),m=M(f.In);return f.persistence.runTransaction("Lookup mutation documents","readonly",w=>m.Xt(w,d).next(b=>b?f.Qn.bn(w,b):N.resolve(null)))}(a.localStore,i);var d;null!==c?("pending"===r?yield Gi(a.remoteStore):"acknowledged"===r||"rejected"===r?(tc(a,i,o||null),ec(a,i),d=i,M(M(a.localStore).In).te(d)):B(),yield Zt(a,c)):L("SyncEngine","Cannot apply mutation batch with id: "+i)})).apply(this,arguments)}function lc(){return(lc=(0,C.Z)(function*(s,i){const r=M(s);if(fc(r),pc(r),!0===i&&!0!==r.qo){const o=r.sharedClientState.getAllActiveQueryTargets(),a=yield Uh(r,o.toArray());r.qo=!0,yield Oa(r.remoteStore,!0);for(const c of a)Hs(r.remoteStore,c)}else if(!1===i&&!1!==r.qo){const o=[];let a=Promise.resolve();r.ko.forEach((c,l)=>{r.sharedClientState.isLocalQueryTarget(l)?o.push(l):a=a.then(()=>(Zi(r,l),Bi(r.localStore,l,!0))),Kr(r.remoteStore,l)}),yield a,yield Uh(r,o),function(c){const l=M(c);l.Fo.forEach((d,f)=>{Kr(l.remoteStore,f)}),l.Mo.us(),l.Fo=new Map,l.Oo=new Ce(V.comparator)}(r),r.qo=!1,yield Oa(r.remoteStore,!1)}})).apply(this,arguments)}function Uh(s,i,r){return uc.apply(this,arguments)}function uc(){return(uc=(0,C.Z)(function*(s,i,r){const o=M(s),a=[],c=[];for(const l of i){let d;const f=o.ko.get(l);if(f&&0!==f.length){d=yield Vi(o.localStore,dt(f[0]));for(const m of f){const w=o.xo.get(m),b=yield Pg(o,w);b.snapshot&&c.push(b.snapshot)}}else{const m=yield mh(o.localStore,l);d=yield Vi(o.localStore,m),yield $a(o,Vh(m),l,!1)}a.push(d)}return o.No.Tr(c),a})).apply(this,arguments)}function Vh(s){return iu(s.path,s.collectionGroup,s.orderBy,s.filters,s.limit,"F",s.startAt,s.endAt)}function Og(s){const i=M(s);return M(M(i.localStore).persistence).pn()}function Mg(s,i,r,o){return hc.apply(this,arguments)}function hc(){return(hc=(0,C.Z)(function*(s,i,r,o){const a=M(s);if(a.qo)L("SyncEngine","Ignoring unexpected query state notification.");else if(a.ko.has(i))switch(r){case"current":case"not-current":{const c=yield yh(a.localStore),l=Or.createSynthesizedRemoteEventForCurrentChange(i,"current"===r);yield Zt(a,c,l);break}case"rejected":yield Bi(a.localStore,i,!0),Zi(a,i,o);break;default:B()}})).apply(this,arguments)}function Fg(s,i,r){return dc.apply(this,arguments)}function dc(){return(dc=(0,C.Z)(function*(s,i,r){const o=fc(s);if(o.qo){for(const a of i){if(o.ko.has(a)){L("SyncEngine","Adding an already active target "+a);continue}const c=yield mh(o.localStore,a),l=yield Vi(o.localStore,c);yield $a(o,Vh(c),l.targetId,!1),Hs(o.remoteStore,l)}for(const a of r)o.ko.has(a)&&(yield Bi(o.localStore,a,!1).then(()=>{Kr(o.remoteStore,a),Zi(o,a)}).catch(Qn))}})).apply(this,arguments)}function fc(s){const i=M(s);return i.remoteStore.remoteSyncer.applyRemoteEvent=Oh.bind(null,i),i.remoteStore.remoteSyncer.getRemoteKeysForTarget=Rg.bind(null,i),i.remoteStore.remoteSyncer.rejectListen=Ig.bind(null,i),i.No.Tr=pg.bind(null,i.eventManager),i.No.jo=gg.bind(null,i.eventManager),i}function pc(s){const i=M(s);return i.remoteStore.remoteSyncer.applySuccessfulWrite=Sg.bind(null,i),i.remoteStore.remoteSyncer.rejectFailedWrite=Dg.bind(null,i),i}class Bh{constructor(){this.synchronizeTabs=!1}initialize(i){var r=this;return(0,C.Z)(function*(){r.N=jr(i.databaseInfo.databaseId),r.sharedClientState=r.Wo(i),r.persistence=r.Go(i),yield r.persistence.start(),r.gcScheduler=r.zo(i),r.localStore=r.Ho(i)})()}zo(i){return null}Ho(i){return dh(this.persistence,new hh,i.initialUser,this.N)}Go(i){return new Kp(ga.Ns,this.N)}Wo(i){return new wh}terminate(){var i=this;return(0,C.Z)(function*(){i.gcScheduler&&i.gcScheduler.stop(),yield i.sharedClientState.shutdown(),yield i.persistence.shutdown()})()}}class qh extends Bh{constructor(i,r,o){super(),this.Jo=i,this.cacheSizeBytes=r,this.forceOwnership=o,this.synchronizeTabs=!1}initialize(i){var r=()=>super.initialize,o=this;return(0,C.Z)(function*(){yield r().call(o,i),yield function(s){return ha.apply(this,arguments)}(o.localStore),yield o.Jo.initialize(o,i),yield pc(o.Jo.syncEngine),yield Gi(o.Jo.remoteStore),yield o.persistence.nn(()=>(o.gcScheduler&&!o.gcScheduler.started&&o.gcScheduler.start(o.localStore),Promise.resolve()))})()}Ho(i){return dh(this.persistence,new hh,i.initialUser,this.N)}zo(i){return new xp(this.persistence.referenceDelegate.garbageCollector,i.asyncQueue)}Go(i){const r=aa(i.databaseInfo.databaseId,i.databaseInfo.persistenceKey),o=void 0!==this.cacheSizeBytes?tt.withCacheSize(this.cacheSizeBytes):tt.DEFAULT;return new oa(this.synchronizeTabs,r,i.clientId,o,i.asyncQueue,Th(),Zs(),this.N,this.sharedClientState,!!this.forceOwnership)}Wo(i){return new wh}}class Vg extends qh{constructor(i,r){super(i,r,!1),this.Jo=i,this.cacheSizeBytes=r,this.synchronizeTabs=!0}initialize(i){var r=()=>super.initialize,o=this;return(0,C.Z)(function*(){yield r().call(o,i);const a=o.Jo.syncEngine;o.sharedClientState instanceof _a&&(o.sharedClientState.syncEngine={_i:kg.bind(null,a),mi:Mg.bind(null,a),gi:Fg.bind(null,a),pn:Og.bind(null,a),wi:Ng.bind(null,a)},yield o.sharedClientState.start()),yield o.persistence.nn(function(){var c=(0,C.Z)(function*(l){yield function(s,i){return lc.apply(this,arguments)}(o.Jo.syncEngine,l),o.gcScheduler&&(l&&!o.gcScheduler.started?o.gcScheduler.start(o.localStore):l||o.gcScheduler.stop())});return function(l){return c.apply(this,arguments)}}())})()}Wo(i){const r=Th();if(!_a.Pt(r))throw new k(D.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const o=aa(i.databaseInfo.databaseId,i.databaseInfo.persistenceKey);return new _a(r,i.asyncQueue,o,i.clientId,i.initialUser)}}class gc{initialize(i,r){var o=this;return(0,C.Z)(function*(){o.localStore||(o.localStore=i.localStore,o.sharedClientState=i.sharedClientState,o.datastore=o.createDatastore(r),o.remoteStore=o.createRemoteStore(r),o.eventManager=o.createEventManager(r),o.syncEngine=o.createSyncEngine(r,!i.synchronizeTabs),o.sharedClientState.onlineStateHandler=a=>Mh(o.syncEngine,a,1),o.remoteStore.remoteSyncer.handleCredentialChange=Ag.bind(null,o.syncEngine),yield Oa(o.remoteStore,o.syncEngine.isPrimaryClient))})()}createEventManager(i){return new fg}createDatastore(i){const r=jr(i.databaseInfo.databaseId),o=new Wp(i.databaseInfo);return new eg(i.credentials,o,r)}createRemoteStore(i){return r=this.localStore,o=this.datastore,a=i.asyncQueue,c=d=>Mh(this.syncEngine,d,0),l=bh.Pt()?new bh:new Hp,new ng(r,o,a,c,l);var r,o,a,c,l}createSyncEngine(i,r){return function(o,a,c,l,d,f,m){const w=new wg(o,a,c,l,d,f);return m&&(w.qo=!0),w}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,i.initialUser,i.maxConcurrentLimboResolutions,r)}terminate(){return(i=(0,C.Z)(function*(r){const o=M(r);L("RemoteStore","RemoteStore shutting down."),o.Kr.add(5),yield qi(o),o.Qr.shutdown(),o.Wr.set("Unknown")}),function(r){return i.apply(this,arguments)})(this.remoteStore);var i}}function Gh(s,i=10240){let r=0;return{read:()=>(0,C.Z)(function*(){if(r<s.byteLength){const o={value:s.slice(r,r+i),done:!1};return r+=i,o}return{done:!0}})(),cancel:()=>(0,C.Z)(function*(){})(),releaseLock(){},closed:Promise.reject("unimplemented")}}class Qs{constructor(i){this.observer=i,this.muted=!1}next(i){this.observer.next&&this.Yo(this.observer.next,i)}error(i){this.observer.error?this.Yo(this.observer.error,i):console.error("Uncaught Error in snapshot listener:",i)}Xo(){this.muted=!0}Yo(i,r){this.muted||setTimeout(()=>{this.muted||i(r)},0)}}class Bg{constructor(i,r){this.Zo=i,this.N=r,this.metadata=new Pe,this.buffer=new Uint8Array,this.ta=new TextDecoder("utf-8"),this.ea().then(o=>{o&&o.ho()?this.metadata.resolve(o.payload.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is\n             ${JSON.stringify(null==o?void 0:o.payload)}`))},o=>this.metadata.reject(o))}close(){return this.Zo.cancel()}getMetadata(){var i=this;return(0,C.Z)(function*(){return i.metadata.promise})()}Qo(){var i=this;return(0,C.Z)(function*(){return yield i.getMetadata(),i.ea()})()}ea(){var i=this;return(0,C.Z)(function*(){const r=yield i.na();if(null===r)return null;const o=i.ta.decode(r),a=Number(o);isNaN(a)&&i.sa(`length string (${o}) is not valid number`);const c=yield i.ia(a);return new mg(JSON.parse(c),r.length+a)})()}ra(){return this.buffer.findIndex(i=>i==="{".charCodeAt(0))}na(){var i=this;return(0,C.Z)(function*(){for(;i.ra()<0&&!(yield i.oa()););if(0===i.buffer.length)return null;const r=i.ra();r<0&&i.sa("Reached the end of bundle when a length string is expected.");const o=i.buffer.slice(0,r);return i.buffer=i.buffer.slice(r),o})()}ia(i){var r=this;return(0,C.Z)(function*(){for(;r.buffer.length<i;)(yield r.oa())&&r.sa("Reached the end of bundle when more is expected.");const o=r.ta.decode(r.buffer.slice(0,i));return r.buffer=r.buffer.slice(i),o})()}sa(i){throw this.Zo.cancel(),new Error(`Invalid bundle format: ${i}`)}oa(){var i=this;return(0,C.Z)(function*(){const r=yield i.Zo.read();if(!r.done){const o=new Uint8Array(i.buffer.length+r.value.length);o.set(i.buffer),o.set(r.value,i.buffer.length),i.buffer=o}return r.done})()}}class qg{constructor(i){this.datastore=i,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}lookup(i){var r=this;return(0,C.Z)(function*(){if(r.ensureCommitNotCalled(),r.mutations.length>0)throw new k(D.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");const o=yield(a=(0,C.Z)(function*(c,l){const d=M(c),f=Vr(d.N)+"/documents",m={documents:l.map(P=>Ur(d.N,P))},w=yield d.Ki("BatchGetDocuments",f,m),b=new Map;w.forEach(P=>{const O=function(s,i){return"found"in i?function(r,o){K(!!o.found);const a=Rt(r,o.found.name),c=Le(o.found.updateTime),l=new qe({mapValue:{fields:o.found.fields}});return ue.newFoundDocument(a,c,l)}(s,i):"missing"in i?function(r,o){K(!!o.missing),K(!!o.readTime);const a=Rt(r,o.missing),c=Le(o.readTime);return ue.newNoDocument(a,c)}(s,i):B()}(d.N,P);b.set(O.key.toString(),O)});const x=[];return l.forEach(P=>{const O=b.get(P.toString());K(!!O),x.push(O)}),x}),function(c,l){return a.apply(this,arguments)})(r.datastore,i);var a;return o.forEach(a=>r.recordVersion(a)),o})()}set(i,r){this.write(r.toMutation(i,this.precondition(i))),this.writtenDocs.add(i.toString())}update(i,r){try{this.write(r.toMutation(i,this.preconditionForUpdate(i)))}catch(o){this.lastWriteError=o}this.writtenDocs.add(i.toString())}delete(i){this.write(new Lr(i,this.precondition(i))),this.writtenDocs.add(i.toString())}commit(){var i=this;return(0,C.Z)(function*(){if(i.ensureCommitNotCalled(),i.lastWriteError)throw i.lastWriteError;const r=i.readVersions;var o;i.mutations.forEach(o=>{r.delete(o.key.toString())}),r.forEach((o,a)=>{const c=V.fromPath(a);i.mutations.push(new Ko(c,i.precondition(c)))}),yield(o=(0,C.Z)(function*(a,c){const l=M(a),d=Vr(l.N)+"/documents",f={writes:c.map(m=>Us(l.N,m))};yield l.Li("Commit",d,f)}),function(a,c){return o.apply(this,arguments)})(i.datastore,i.mutations),i.committed=!0})()}recordVersion(i){let r;if(i.isFoundDocument())r=i.version;else{if(!i.isNoDocument())throw B();r=Y.min()}const o=this.readVersions.get(i.key.toString());if(o){if(!r.isEqual(o))throw new k(D.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(i.key.toString(),r)}precondition(i){const r=this.readVersions.get(i.toString());return!this.writtenDocs.has(i.toString())&&r?Ie.updateTime(r):Ie.none()}preconditionForUpdate(i){const r=this.readVersions.get(i.toString());if(!this.writtenDocs.has(i.toString())&&r){if(r.isEqual(Y.min()))throw new k(D.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Ie.updateTime(r)}return Ie.exists(!0)}write(i){this.ensureCommitNotCalled(),this.mutations.push(i)}ensureCommitNotCalled(){}}class Gg{constructor(i,r,o,a){this.asyncQueue=i,this.datastore=r,this.updateFunction=o,this.deferred=a,this.aa=5,this.rr=new wa(this.asyncQueue,"transaction_retry")}run(){this.aa-=1,this.ca()}ca(){var i=this;this.rr.Xi((0,C.Z)(function*(){const r=new qg(i.datastore),o=i.ua(r);o&&o.then(a=>{i.asyncQueue.enqueueAndForget(()=>r.commit().then(()=>{i.deferred.resolve(a)}).catch(c=>{i.ha(c)}))}).catch(a=>{i.ha(a)})}))}ua(i){try{const r=this.updateFunction(i);return!Gn(r)&&r.catch&&r.then?r:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(r){return this.deferred.reject(r),null}}ha(i){this.aa>0&&this.la(i)?(this.aa-=1,this.asyncQueue.enqueueAndForget(()=>(this.ca(),Promise.resolve()))):this.deferred.reject(i)}la(i){if("FirebaseError"===i.name){const r=i.code;return"aborted"===r||"failed-precondition"===r||!wu(r)}return!1}}class zg{constructor(i,r,o){var a=this;this.credentials=i,this.asyncQueue=r,this.databaseInfo=o,this.user=Fe.UNAUTHENTICATED,this.clientId=zl.I(),this.credentialListener=()=>Promise.resolve(),this.credentials.start(r,function(){var c=(0,C.Z)(function*(l){L("FirestoreClient","Received user=",l.uid),yield a.credentialListener(l),a.user=l});return function(l){return c.apply(this,arguments)}}())}getConfiguration(){var i=this;return(0,C.Z)(function*(){return{asyncQueue:i.asyncQueue,databaseInfo:i.databaseInfo,clientId:i.clientId,credentials:i.credentials,initialUser:i.user,maxConcurrentLimboResolutions:100}})()}setCredentialChangeListener(i){this.credentialListener=i}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new k(D.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){var i=this;this.asyncQueue.enterRestrictedMode();const r=new Pe;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((0,C.Z)(function*(){try{i.onlineComponents&&(yield i.onlineComponents.terminate()),i.offlineComponents&&(yield i.offlineComponents.terminate()),i.credentials.shutdown(),r.resolve()}catch(o){const a=ji(o,"Failed to shutdown persistence");r.reject(a)}})),r.promise}}function zh(s,i){return mc.apply(this,arguments)}function mc(){return(mc=(0,C.Z)(function*(s,i){s.asyncQueue.verifyOperationInProgress(),L("FirestoreClient","Initializing OfflineComponentProvider");const r=yield s.getConfiguration();yield i.initialize(r);let o=r.initialUser;s.setCredentialChangeListener(function(){var a=(0,C.Z)(function*(c){o.isEqual(c)||(yield fh(i.localStore,c),o=c)});return function(c){return a.apply(this,arguments)}}()),i.persistence.setDatabaseDeletedListener(()=>s.terminate()),s.offlineComponents=i})).apply(this,arguments)}function jh(s,i){return yc.apply(this,arguments)}function yc(){return(yc=(0,C.Z)(function*(s,i){s.asyncQueue.verifyOperationInProgress();const r=yield vc(s);L("FirestoreClient","Initializing OnlineComponentProvider");const o=yield s.getConfiguration();yield i.initialize(r,o),s.setCredentialChangeListener(a=>{return(c=(0,C.Z)(function*(l,d){const f=M(l);f.asyncQueue.verifyOperationInProgress(),L("RemoteStore","RemoteStore received new credentials");const m=bn(f);f.Kr.add(3),yield qi(f),m&&f.Wr.set("Unknown"),yield f.remoteSyncer.handleCredentialChange(d),f.Kr.delete(3),yield $r(f)}),function(l,d){return c.apply(this,arguments)})(i.remoteStore,a);var c}),s.onlineComponents=i})).apply(this,arguments)}function vc(s){return _c.apply(this,arguments)}function _c(){return(_c=(0,C.Z)(function*(s){return s.offlineComponents||(L("FirestoreClient","Using default OfflineComponentProvider"),yield zh(s,new Bh)),s.offlineComponents})).apply(this,arguments)}function Ws(s){return wc.apply(this,arguments)}function wc(){return(wc=(0,C.Z)(function*(s){return s.onlineComponents||(L("FirestoreClient","Using default OnlineComponentProvider"),yield jh(s,new gc)),s.onlineComponents})).apply(this,arguments)}function $h(s){return vc(s).then(i=>i.persistence)}function bc(s){return vc(s).then(i=>i.localStore)}function Kh(s){return Ws(s).then(i=>i.remoteStore)}function Tc(s){return Ws(s).then(i=>i.syncEngine)}function Hi(s){return Ec.apply(this,arguments)}function Ec(){return(Ec=(0,C.Z)(function*(s){const i=yield Ws(s),r=i.eventManager;return r.onListen=bg.bind(null,i.syncEngine),r.onUnlisten=Tg.bind(null,i.syncEngine),r})).apply(this,arguments)}function Zh(s,i,r={}){const o=new Pe;return s.asyncQueue.enqueueAndForget((0,C.Z)(function*(){return function(a,c,l,d,f){const m=new Qs({next:b=>{c.enqueueAndForget(()=>Ba(a,w));const x=b.docs.has(l);!x&&b.fromCache?f.reject(new k(D.UNAVAILABLE,"Failed to get document because the client is offline.")):x&&b.fromCache&&d&&"server"===d.source?f.reject(new k(D.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):f.resolve(b)},error:b=>f.reject(b)}),w=new za(Si(l.path),m,{includeMetadataChanges:!0,uo:!0});return Ua(a,w)}(yield Hi(s),s.asyncQueue,i,r,o)})),o.promise}function Hh(s,i,r={}){const o=new Pe;return s.asyncQueue.enqueueAndForget((0,C.Z)(function*(){return function(a,c,l,d,f){const m=new Qs({next:b=>{c.enqueueAndForget(()=>Ba(a,w)),b.fromCache&&"server"===d.source?f.reject(new k(D.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):f.resolve(b)},error:b=>f.reject(b)}),w=new za(l,m,{includeMetadataChanges:!0,uo:!0});return Ua(a,w)}(yield Hi(s),s.asyncQueue,i,r,o)})),o.promise}class Xg{constructor(i,r,o,a,c,l,d,f){this.databaseId=i,this.appId=r,this.persistenceKey=o,this.host=a,this.ssl=c,this.forceLongPolling=l,this.autoDetectLongPolling=d,this.useFetchStreams=f}}class Yi{constructor(i,r){this.projectId=i,this.database=r||"(default)"}get isDefaultDatabase(){return"(default)"===this.database}isEqual(i){return i instanceof Yi&&i.projectId===this.projectId&&i.database===this.database}}const Yh=new Map;function Ic(s,i,r){if(!r)throw new k(D.INVALID_ARGUMENT,`Function ${s}() cannot be called with an empty ${i}.`)}function Qh(s,i,r,o){if(!0===i&&!0===o)throw new k(D.INVALID_ARGUMENT,`${s} and ${r} cannot be used together.`)}function Wh(s){if(!V.isDocumentKey(s))throw new k(D.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${s} has ${s.length}.`)}function Xh(s){if(V.isDocumentKey(s))throw new k(D.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${s} has ${s.length}.`)}function Xs(s){if(void 0===s)return"undefined";if(null===s)return"null";if("string"==typeof s)return s.length>20&&(s=`${s.substring(0,20)}...`),JSON.stringify(s);if("number"==typeof s||"boolean"==typeof s)return""+s;if("object"==typeof s){if(s instanceof Array)return"an array";{const i=function(r){if(r.constructor){const o=/function\s+([^\s(]+)\s*\(/.exec(r.constructor.toString());if(o&&o.length>1)return o[1]}return null}(s);return i?`a custom ${i} object`:"an object"}}return"function"==typeof s?"a function":B()}function ee(s,i){if("_delegate"in s&&(s=s._delegate),!(s instanceof i)){if(i.name===s.constructor.name)throw new k(D.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const r=Xs(s);throw new k(D.INVALID_ARGUMENT,`Expected type '${i.name}', but it was: ${r}`)}}return s}function Jh(s,i){if(i<=0)throw new k(D.INVALID_ARGUMENT,`Function ${s}() requires a positive number, but it was: ${i}.`)}class ed{constructor(i){var r;if(void 0===i.host){if(void 0!==i.ssl)throw new k(D.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=i.host,this.ssl=null===(r=i.ssl)||void 0===r||r;if(this.credentials=i.credentials,this.ignoreUndefinedProperties=!!i.ignoreUndefinedProperties,void 0===i.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==i.cacheSizeBytes&&i.cacheSizeBytes<1048576)throw new k(D.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=i.cacheSizeBytes}this.experimentalForceLongPolling=!!i.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!i.experimentalAutoDetectLongPolling,this.useFetchStreams=!!i.useFetchStreams,Qh("experimentalForceLongPolling",i.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",i.experimentalAutoDetectLongPolling)}isEqual(i){return this.host===i.host&&this.ssl===i.ssl&&this.credentials===i.credentials&&this.cacheSizeBytes===i.cacheSizeBytes&&this.experimentalForceLongPolling===i.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===i.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===i.ignoreUndefinedProperties&&this.useFetchStreams===i.useFetchStreams}}class Zr{constructor(i,r){this._credentials=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new ed({}),this._settingsFrozen=!1,i instanceof Yi?this._databaseId=i:(this._app=i,this._databaseId=function(o){if(!Object.prototype.hasOwnProperty.apply(o.options,["projectId"]))throw new k(D.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Yi(o.options.projectId)}(i))}get app(){if(!this._app)throw new k(D.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(i){if(this._settingsFrozen)throw new k(D.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new ed(i),void 0!==i.credentials&&(this._credentials=function(r){if(!r)return new Tf;switch(r.type){case"gapi":const o=r.client;return K(!("object"!=typeof o||null===o||!o.auth||!o.auth.getAuthHeaderValueForFirstParty)),new Df(o,r.sessionIndex||"0",r.iamToken||null);case"provider":return r.client;default:throw new k(D.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(i.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(i){const r=Yh.get(i);r&&(L("ComponentProvider","Removing Datastore"),Yh.delete(i),r.terminate())}(this),Promise.resolve()}}class ce{constructor(i,r,o){this.converter=r,this._key=o,this.type="document",this.firestore=i}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Nt(this.firestore,this.converter,this._key.path.popLast())}withConverter(i){return new ce(this.firestore,i,this._key)}}class ze{constructor(i,r,o){this.converter=r,this._query=o,this.type="query",this.firestore=i}withConverter(i){return new ze(this.firestore,i,this._query)}}class Nt extends ze{constructor(i,r,o){super(i,r,Si(o)),this._path=o,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const i=this._path.popLast();return i.isEmpty()?null:new ce(this.firestore,null,new V(i))}withConverter(i){return new Nt(this.firestore,i,this._path)}}function td(s,i,...r){if(s=(0,W.m9)(s),Ic("collection","path",i),s instanceof Zr){const o=te.fromString(i,...r);return Xh(o),new Nt(s,null,o)}{if(!(s instanceof ce||s instanceof Nt))throw new k(D.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const o=te.fromString(s.path,...r).child(te.fromString(i));return Xh(o),new Nt(s.firestore,null,o)}}function Js(s,i,...r){if(s=(0,W.m9)(s),1===arguments.length&&(i=zl.I()),Ic("doc","path",i),s instanceof Zr){const o=te.fromString(i,...r);return Wh(o),new ce(s,null,new V(o))}{if(!(s instanceof ce||s instanceof Nt))throw new k(D.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const o=s._path.child(te.fromString(i,...r));return Wh(o),new ce(s.firestore,s instanceof Nt?s.converter:null,new V(o))}}function nd(s,i){return s=(0,W.m9)(s),i=(0,W.m9)(i),(s instanceof ce||s instanceof Nt)&&(i instanceof ce||i instanceof Nt)&&s.firestore===i.firestore&&s.path===i.path&&s.converter===i.converter}function id(s,i){return s=(0,W.m9)(s),i=(0,W.m9)(i),s instanceof ze&&i instanceof ze&&s.firestore===i.firestore&&Rr(s._query,i._query)&&s.converter===i.converter}class tm{constructor(){this.fa=Promise.resolve(),this.da=[],this.wa=!1,this._a=[],this.ma=null,this.ga=!1,this.ya=!1,this.pa=[],this.rr=new wa(this,"async_queue_retry"),this.Ea=()=>{const r=Zs();r&&L("AsyncQueue","Visibility state changed to "+r.visibilityState),this.rr.tr()};const i=Zs();i&&"function"==typeof i.addEventListener&&i.addEventListener("visibilitychange",this.Ea)}get isShuttingDown(){return this.wa}enqueueAndForget(i){this.enqueue(i)}enqueueAndForgetEvenWhileRestricted(i){this.Ta(),this.Ia(i)}enterRestrictedMode(i){if(!this.wa){this.wa=!0,this.ya=i||!1;const r=Zs();r&&"function"==typeof r.removeEventListener&&r.removeEventListener("visibilitychange",this.Ea)}}enqueue(i){if(this.Ta(),this.wa)return new Promise(()=>{});const r=new Pe;return this.Ia(()=>this.wa&&this.ya?Promise.resolve():(i().then(r.resolve,r.reject),r.promise)).then(()=>r.promise)}enqueueRetryable(i){this.enqueueAndForget(()=>(this.da.push(i),this.Aa()))}Aa(){var i=this;return(0,C.Z)(function*(){if(0!==i.da.length){try{yield i.da[0](),i.da.shift(),i.rr.reset()}catch(r){if(!Zn(r))throw r;L("AsyncQueue","Operation failed with retryable error: "+r)}i.da.length>0&&i.rr.Xi(()=>i.Aa())}})()}Ia(i){const r=this.fa.then(()=>(this.ga=!0,i().catch(o=>{throw this.ma=o,this.ga=!1,Te("INTERNAL UNHANDLED ERROR: ",function(a){let c=a.message||"";return a.stack&&(c=a.stack.includes(a.message)?a.stack:a.message+"\n"+a.stack),c}(o)),o}).then(o=>(this.ga=!1,o))));return this.fa=r,r}enqueueAfterDelay(i,r,o){this.Ta(),this.pa.indexOf(i)>-1&&(r=0);const a=Fa.createAndSchedule(this,i,r,o,c=>this.Ra(c));return this._a.push(a),a}Ta(){this.ma&&B()}verifyOperationInProgress(){}Pa(){var i=this;return(0,C.Z)(function*(){let r;do{r=i.fa,yield r}while(r!==i.fa)})()}ba(i){for(const r of this._a)if(r.timerId===i)return!0;return!1}va(i){return this.Pa().then(()=>{this._a.sort((r,o)=>r.targetTimeMs-o.targetTimeMs);for(const r of this._a)if(r.skipDelay(),"all"!==i&&r.timerId===i)break;return this.Pa()})}Va(i){this.pa.push(i)}Ra(i){const r=this._a.indexOf(i);this._a.splice(r,1)}}function Sc(s){return function(i,r){if("object"!=typeof i||null===i)return!1;const o=i;for(const a of["next","error","complete"])if(a in o&&"function"==typeof o[a])return!0;return!1}(s)}class nm{constructor(){this._progressObserver={},this._taskCompletionResolver=new Pe,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(i,r,o){this._progressObserver={next:i,error:r,complete:o}}catch(i){return this._taskCompletionResolver.promise.catch(i)}then(i,r){return this._taskCompletionResolver.promise.then(i,r)}_completeWith(i){this._updateProgress(i),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(i)}_failWith(i){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(i),this._taskCompletionResolver.reject(i)}_updateProgress(i){this._lastProgress=i,this._progressObserver.next&&this._progressObserver.next(i)}}class me extends Zr{constructor(i,r){super(i,r),this.type="firestore",this._queue=new tm,this._persistenceKey="name"in i?i.name:"[DEFAULT]"}_terminate(){return this._firestoreClient||rd(this),this._firestoreClient.terminate()}}function Ae(s){return s._firestoreClient||rd(s),s._firestoreClient.verifyNotTerminated(),s._firestoreClient}function rd(s){var i;const r=s._freezeSettings(),o=(c=(null===(i=s._app)||void 0===i?void 0:i.options.appId)||"",new Xg(s._databaseId,c,s._persistenceKey,(d=r).host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,d.useFetchStreams));var c,d;s._firestoreClient=new zg(s._credentials,s._queue,o)}function sd(s,i,r){const o=new Pe;return s.asyncQueue.enqueue((0,C.Z)(function*(){try{yield zh(s,r),yield jh(s,i),o.resolve()}catch(a){if(!("FirebaseError"===(c=a).name?c.code===D.FAILED_PRECONDITION||c.code===D.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&c instanceof DOMException)||22===c.code||20===c.code||11===c.code))throw a;console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+a),o.reject(a)}var c})).then(()=>o.promise)}function od(s){if(s._initialized||s._terminated)throw new k(D.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}class Ht{constructor(...i){for(let r=0;r<i.length;++r)if(0===i[r].length)throw new k(D.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ue(i)}isEqual(i){return this._internalPath.isEqual(i._internalPath)}}class kt{constructor(i){this._byteString=i}static fromBase64String(i){try{return new kt(ke.fromBase64String(i))}catch(r){throw new k(D.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+r)}}static fromUint8Array(i){return new kt(ke.fromUint8Array(i))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(i){return this._byteString.isEqual(i._byteString)}}class Wn{constructor(i){this._methodName=i}}class eo{constructor(i,r){if(!isFinite(i)||i<-90||i>90)throw new k(D.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+i);if(!isFinite(r)||r<-180||r>180)throw new k(D.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+r);this._lat=i,this._long=r}get latitude(){return this._lat}get longitude(){return this._long}isEqual(i){return this._lat===i._lat&&this._long===i._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(i){return X(this._lat,i._lat)||X(this._long,i._long)}}const dm=/^__.*__$/;class fm{constructor(i,r,o){this.data=i,this.fieldMask=r,this.fieldTransforms=o}toMutation(i,r){return null!==this.fieldMask?new gn(i,this.data,this.fieldMask,r,this.fieldTransforms):new kr(i,this.data,r,this.fieldTransforms)}}class ad{constructor(i,r,o){this.data=i,this.fieldMask=r,this.fieldTransforms=o}toMutation(i,r){return new gn(i,this.data,this.fieldMask,r,this.fieldTransforms)}}function cd(s){switch(s){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw B()}}class to{constructor(i,r,o,a,c,l){this.settings=i,this.databaseId=r,this.N=o,this.ignoreUndefinedProperties=a,void 0===c&&this.Sa(),this.fieldTransforms=c||[],this.fieldMask=l||[]}get path(){return this.settings.path}get Da(){return this.settings.Da}Ca(i){return new to(Object.assign(Object.assign({},this.settings),i),this.databaseId,this.N,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Na(i){var r;const o=null===(r=this.path)||void 0===r?void 0:r.child(i),a=this.Ca({path:o,xa:!1});return a.ka(i),a}$a(i){var r;const o=null===(r=this.path)||void 0===r?void 0:r.child(i),a=this.Ca({path:o,xa:!1});return a.Sa(),a}Oa(i){return this.Ca({path:void 0,xa:!0})}Fa(i){return io(i,this.settings.methodName,this.settings.Ma||!1,this.path,this.settings.La)}contains(i){return void 0!==this.fieldMask.find(r=>i.isPrefixOf(r))||void 0!==this.fieldTransforms.find(r=>i.isPrefixOf(r.field))}Sa(){if(this.path)for(let i=0;i<this.path.length;i++)this.ka(this.path.get(i))}ka(i){if(0===i.length)throw this.Fa("Document fields must not be empty");if(cd(this.Da)&&dm.test(i))throw this.Fa('Document fields cannot begin and end with "__"')}}class pm{constructor(i,r,o){this.databaseId=i,this.ignoreUndefinedProperties=r,this.N=o||jr(i)}Ba(i,r,o,a=!1){return new to({Da:i,methodName:r,La:o,path:Ue.emptyPath(),xa:!1,Ma:a},this.databaseId,this.N,this.ignoreUndefinedProperties)}}function Xn(s){const i=s._freezeSettings(),r=jr(s._databaseId);return new pm(s._databaseId,!!i.ignoreUndefinedProperties,r)}function no(s,i,r,o,a,c={}){const l=s.Ba(c.merge||c.mergeFields?2:0,i,r,a);Ac("Data must be an object, but it was:",l,o);const d=hd(o,l);let f,m;if(c.merge)f=new bi(l.fieldMask),m=l.fieldTransforms;else if(c.mergeFields){const w=[];for(const b of c.mergeFields){const x=Rc(i,b,r);if(!l.contains(x))throw new k(D.INVALID_ARGUMENT,`Field '${x}' is specified in your field mask but missing from your input data.`);fd(w,x)||w.push(x)}f=new bi(w),m=l.fieldTransforms.filter(b=>f.covers(b.field))}else f=null,m=l.fieldTransforms;return new fm(new qe(d),f,m)}class Hr extends Wn{_toFieldTransform(i){if(2!==i.Da)throw i.Fa(1===i.Da?`${this._methodName}() can only appear at the top level of your update data`:`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return i.fieldMask.push(i.path),null}isEqual(i){return i instanceof Hr}}function ld(s,i,r){return new to({Da:3,La:i.settings.La,methodName:s._methodName,xa:r},i.databaseId,i.N,i.ignoreUndefinedProperties)}class Dc extends Wn{_toFieldTransform(i){return new Nr(i.path,new xi)}isEqual(i){return i instanceof Dc}}class gm extends Wn{constructor(i,r){super(i),this.Ua=r}_toFieldTransform(i){const r=ld(this,i,!0),o=this.Ua.map(c=>Jn(c,r)),a=new jn(o);return new Nr(i.path,a)}isEqual(i){return this===i}}class mm extends Wn{constructor(i,r){super(i),this.Ua=r}_toFieldTransform(i){const r=ld(this,i,!0),o=this.Ua.map(c=>Jn(c,r)),a=new $n(o);return new Nr(i.path,a)}isEqual(i){return this===i}}class ym extends Wn{constructor(i,r){super(i),this.qa=r}_toFieldTransform(i){const r=new Ci(i.N,lu(i.N,this.qa));return new Nr(i.path,r)}isEqual(i){return this===i}}function xc(s,i,r,o){const a=s.Ba(1,i,r);Ac("Data must be an object, but it was:",a,o);const c=[],l=qe.empty();qn(o,(f,m)=>{const w=Pc(i,f,r);m=(0,W.m9)(m);const b=a.$a(w);if(m instanceof Hr)c.push(w);else{const x=Jn(m,b);null!=x&&(c.push(w),l.set(w,x))}});const d=new bi(c);return new ad(l,d,a.fieldTransforms)}function Cc(s,i,r,o,a,c){const l=s.Ba(1,i,r),d=[Rc(i,o,r)],f=[a];if(c.length%2!=0)throw new k(D.INVALID_ARGUMENT,`Function ${i}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let x=0;x<c.length;x+=2)d.push(Rc(i,c[x])),f.push(c[x+1]);const m=[],w=qe.empty();for(let x=d.length-1;x>=0;--x)if(!fd(m,d[x])){const P=d[x];let O=f[x];O=(0,W.m9)(O);const q=l.$a(P);if(O instanceof Hr)m.push(P);else{const H=Jn(O,q);null!=H&&(m.push(P),w.set(P,H))}}const b=new bi(m);return new ad(w,b,l.fieldTransforms)}function ud(s,i,r,o=!1){return Jn(r,s.Ba(o?4:3,i))}function Jn(s,i){if(dd(s=(0,W.m9)(s)))return Ac("Unsupported field value:",i,s),hd(s,i);if(s instanceof Wn)return function(r,o){if(!cd(o.Da))throw o.Fa(`${r._methodName}() can only be used with update() and set()`);if(!o.path)throw o.Fa(`${r._methodName}() is not currently supported inside arrays`);const a=r._toFieldTransform(o);a&&o.fieldTransforms.push(a)}(s,i),null;if(void 0===s&&i.ignoreUndefinedProperties)return null;if(i.path&&i.fieldMask.push(i.path),s instanceof Array){if(i.settings.xa&&4!==i.Da)throw i.Fa("Nested arrays are not supported");return function(r,o){const a=[];let c=0;for(const l of r){let d=Jn(l,o.Oa(c));null==d&&(d={nullValue:"NULL_VALUE"}),a.push(d),c++}return{arrayValue:{values:a}}}(s,i)}return function(r,o){if(null===(r=(0,W.m9)(r)))return{nullValue:"NULL_VALUE"};if("number"==typeof r)return lu(o.N,r);if("boolean"==typeof r)return{booleanValue:r};if("string"==typeof r)return{stringValue:r};if(r instanceof Date){const a=Ne.fromDate(r);return{timestampValue:Fr(o.N,a)}}if(r instanceof Ne){const a=new Ne(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Fr(o.N,a)}}if(r instanceof eo)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof kt)return{bytesValue:Au(o.N,r._byteString)};if(r instanceof ce){const a=o.databaseId,c=r.firestore._databaseId;if(!c.isEqual(a))throw o.Fa(`Document reference is for database ${c.projectId}/${c.database} but should be for database ${a.projectId}/${a.database}`);return{referenceValue:Ho(r.firestore._databaseId||o.databaseId,r._key.path)}}throw o.Fa(`Unsupported field value: ${Xs(r)}`)}(s,i)}function hd(s,i){const r={};return Kl(s)?i.path&&i.path.length>0&&i.fieldMask.push(i.path):qn(s,(o,a)=>{const c=Jn(a,i.Na(o));null!=c&&(r[o]=c)}),{mapValue:{fields:r}}}function dd(s){return!("object"!=typeof s||null===s||s instanceof Array||s instanceof Date||s instanceof Ne||s instanceof eo||s instanceof kt||s instanceof ce||s instanceof Wn)}function Ac(s,i,r){if(!dd(r)||"object"!=typeof(o=r)||null===o||Object.getPrototypeOf(o)!==Object.prototype&&null!==Object.getPrototypeOf(o)){const o=Xs(r);throw i.Fa("an object"===o?s+" a custom object":s+" "+o)}var o}function Rc(s,i,r){if((i=(0,W.m9)(i))instanceof Ht)return i._internalPath;if("string"==typeof i)return Pc(s,i);throw io("Field path arguments must be of type string or FieldPath.",s,!1,void 0,r)}const vm=new RegExp("[~\\*/\\[\\]]");function Pc(s,i,r){if(i.search(vm)>=0)throw io(`Invalid field path (${i}). Paths must not contain '~', '*', '/', '[', or ']'`,s,!1,void 0,r);try{return new Ht(...i.split("."))._internalPath}catch(o){throw io(`Invalid field path (${i}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,s,!1,void 0,r)}}function io(s,i,r,o,a){const c=o&&!o.isEmpty(),l=void 0!==a;let d=`Function ${i}() called with invalid data`;r&&(d+=" (via `toFirestore()`)"),d+=". ";let f="";return(c||l)&&(f+=" (found",c&&(f+=` in field ${o}`),l&&(f+=` in document ${a}`),f+=")"),new k(D.INVALID_ARGUMENT,d+s+f)}function fd(s,i){return s.some(r=>r.isEqual(i))}class Yr{constructor(i,r,o,a,c){this._firestore=i,this._userDataWriter=r,this._key=o,this._document=a,this._converter=c}get id(){return this._key.path.lastSegment()}get ref(){return new ce(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const i=new _m(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(i)}return this._userDataWriter.convertValue(this._document.data.value)}}get(i){if(this._document){const r=this._document.data.field(ro("DocumentSnapshot.get",i));if(null!==r)return this._userDataWriter.convertValue(r)}}}class _m extends Yr{data(){return super.data()}}function ro(s,i){return"string"==typeof i?Pc(s,i):i instanceof Ht?i._internalPath:i._delegate._internalPath}class ei{constructor(i,r){this.hasPendingWrites=i,this.fromCache=r}isEqual(i){return this.hasPendingWrites===i.hasPendingWrites&&this.fromCache===i.fromCache}}class Yt extends Yr{constructor(i,r,o,a,c,l){super(i,r,o,a,l),this._firestore=i,this._firestoreImpl=i,this.metadata=c}exists(){return super.exists()}data(i={}){if(this._document){if(this._converter){const r=new Qr(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,i)}return this._userDataWriter.convertValue(this._document.data.value,i.serverTimestamps)}}get(i,r={}){if(this._document){const o=this._document.data.field(ro("DocumentSnapshot.get",i));if(null!==o)return this._userDataWriter.convertValue(o,r.serverTimestamps)}}}class Qr extends Yt{data(i={}){return super.data(i)}}class En{constructor(i,r,o,a){this._firestore=i,this._userDataWriter=r,this._snapshot=a,this.metadata=new ei(a.hasPendingWrites,a.fromCache),this.query=o}get docs(){const i=[];return this.forEach(r=>i.push(r)),i}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(i,r){this._snapshot.docs.forEach(o=>{i.call(r,new Qr(this._firestore,this._userDataWriter,o.key,o,new ei(this._snapshot.mutatedKeys.has(o.key),this._snapshot.fromCache),this.query.converter))})}docChanges(i={}){const r=!!i.includeMetadataChanges;if(r&&this._snapshot.excludesMetadataChanges)throw new k(D.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===r||(this._cachedChanges=function(o,a){if(o._snapshot.oldDocs.isEmpty()){let c=0;return o._snapshot.docChanges.map(l=>({type:"added",doc:new Qr(o._firestore,o._userDataWriter,l.doc.key,l.doc,new ei(o._snapshot.mutatedKeys.has(l.doc.key),o._snapshot.fromCache),o.query.converter),oldIndex:-1,newIndex:c++}))}{let c=o._snapshot.oldDocs;return o._snapshot.docChanges.filter(l=>a||3!==l.type).map(l=>{const d=new Qr(o._firestore,o._userDataWriter,l.doc.key,l.doc,new ei(o._snapshot.mutatedKeys.has(l.doc.key),o._snapshot.fromCache),o.query.converter);let f=-1,m=-1;return 0!==l.type&&(f=c.indexOf(l.doc.key),c=c.delete(l.doc.key)),1!==l.type&&(c=c.add(l.doc),m=c.indexOf(l.doc.key)),{type:wm(l.type),doc:d,oldIndex:f,newIndex:m}})}}(this,r),this._cachedChangesIncludeMetadataChanges=r),this._cachedChanges}}function wm(s){switch(s){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return B()}}function pd(s,i){return s instanceof Yt&&i instanceof Yt?s._firestore===i._firestore&&s._key.isEqual(i._key)&&(null===s._document?null===i._document:s._document.isEqual(i._document))&&s._converter===i._converter:s instanceof En&&i instanceof En&&s._firestore===i._firestore&&id(s.query,i.query)&&s.metadata.isEqual(i.metadata)&&s._snapshot.isEqual(i._snapshot)}function gd(s){if(Ps(s)&&0===s.explicitOrderBy.length)throw new k(D.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Wr{}function In(s,...i){for(const r of i)s=r._apply(s);return s}class bm extends Wr{constructor(i,r,o){super(),this.Ka=i,this.ja=r,this.Qa=o,this.type="where"}_apply(i){const r=Xn(i.firestore),o=function(a,c,l,d,f,m,w){let b;if(f.isKeyField()){if("array-contains"===m||"array-contains-any"===m)throw new k(D.INVALID_ARGUMENT,`Invalid Query. You can't perform '${m}' queries on FieldPath.documentId().`);if("in"===m||"not-in"===m){bd(w,m);const P=[];for(const O of w)P.push(wd(d,a,O));b={arrayValue:{values:P}}}else b=wd(d,a,w)}else"in"!==m&&"not-in"!==m&&"array-contains-any"!==m||bd(w,m),b=ud(l,"where",w,"in"===m||"not-in"===m);const x=$e.create(f,m,b);return function(P,O){if(O.v()){const H=Go(P);if(null!==H&&!H.isEqual(O.field))throw new k(D.INVALID_ARGUMENT,`Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '${H.toString()}' and '${O.field.toString()}'`);const ye=qo(P);null!==ye&&Td(0,O.field,ye)}const q=function(H,ye){for(const He of H.filters)if(ye.indexOf(He.op)>=0)return He.op;return null}(P,function(H){switch(H){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(O.op));if(null!==q)throw new k(D.INVALID_ARGUMENT,q===O.op?`Invalid query. You cannot use more than one '${O.op.toString()}' filter.`:`Invalid query. You cannot use '${O.op.toString()}' filters with '${q.toString()}' filters.`)}(a,x),x}(i._query,0,r,i.firestore._databaseId,this.Ka,this.ja,this.Qa);return new ze(i.firestore,i.converter,function(a,c){const l=a.filters.concat([c]);return new jt(a.path,a.collectionGroup,a.explicitOrderBy.slice(),l,a.limit,a.limitType,a.startAt,a.endAt)}(i._query,o))}}class Em extends Wr{constructor(i,r){super(),this.Ka=i,this.Wa=r,this.type="orderBy"}_apply(i){const r=function(o,a,c){if(null!==o.startAt)throw new k(D.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==o.endAt)throw new k(D.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");const l=new Ii(a,c);return function(d,f){if(null===qo(d)){const m=Go(d);null!==m&&Td(0,m,f.field)}}(o,l),l}(i._query,this.Ka,this.Wa);return new ze(i.firestore,i.converter,function(o,a){const c=o.explicitOrderBy.concat([a]);return new jt(o.path,o.collectionGroup,c,o.filters.slice(),o.limit,o.limitType,o.startAt,o.endAt)}(i._query,r))}}class md extends Wr{constructor(i,r,o){super(),this.type=i,this.Ga=r,this.za=o}_apply(i){return new ze(i.firestore,i.converter,ru(i._query,this.Ga,this.za))}}class yd extends Wr{constructor(i,r,o){super(),this.type=i,this.Ha=r,this.Ja=o}_apply(i){const r=_d(i,this.type,this.Ha,this.Ja);return new ze(i.firestore,i.converter,(a=r,new jt((o=i._query).path,o.collectionGroup,o.explicitOrderBy.slice(),o.filters.slice(),o.limit,o.limitType,a,o.endAt)));var o,a}}class vd extends Wr{constructor(i,r,o){super(),this.type=i,this.Ha=r,this.Ja=o}_apply(i){const r=_d(i,this.type,this.Ha,this.Ja);return new ze(i.firestore,i.converter,(a=r,new jt((o=i._query).path,o.collectionGroup,o.explicitOrderBy.slice(),o.filters.slice(),o.limit,o.limitType,o.startAt,a)));var o,a}}function _d(s,i,r,o){if(r[0]=(0,W.m9)(r[0]),r[0]instanceof Yr)return function(a,c,l,d,f){if(!d)throw new k(D.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${l}().`);const m=[];for(const w of Di(a))if(w.field.isKeyField())m.push(Ss(c,d.key));else{const b=d.data.field(w.field);if(Mo(b))throw new k(D.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+w.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===b){const x=w.field.canonicalString();throw new k(D.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${x}' (used as the orderBy) does not exist.`)}m.push(b)}return new Ar(m,f)}(s._query,s.firestore._databaseId,i,r[0]._document,o);{const a=Xn(s.firestore);return function(c,l,d,f,m,w){const b=c.explicitOrderBy;if(m.length>b.length)throw new k(D.INVALID_ARGUMENT,`Too many arguments provided to ${f}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const x=[];for(let P=0;P<m.length;P++){const O=m[P];if(b[P].field.isKeyField()){if("string"!=typeof O)throw new k(D.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${f}(), but got a ${typeof O}`);if(!zo(c)&&-1!==O.indexOf("/"))throw new k(D.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to ${f}() must be a plain document ID, but '${O}' contains a slash.`);const q=c.path.child(te.fromString(O));if(!V.isDocumentKey(q))throw new k(D.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to ${f}() must result in a valid document path, but '${q}' is not because it contains an odd number of segments.`);const H=new V(q);x.push(Ss(l,H))}else{const q=ud(d,f,O);x.push(q)}}return new Ar(x,w)}(s._query,s.firestore._databaseId,a,i,r,o)}}function wd(s,i,r){if("string"==typeof(r=(0,W.m9)(r))){if(""===r)throw new k(D.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!zo(i)&&-1!==r.indexOf("/"))throw new k(D.INVALID_ARGUMENT,`Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '${r}' contains a '/' character.`);const o=i.path.child(te.fromString(r));if(!V.isDocumentKey(o))throw new k(D.INVALID_ARGUMENT,`Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '${o}' is not because it has an odd number of segments (${o.length}).`);return Ss(s,new V(o))}if(r instanceof ce)return Ss(s,r._key);throw new k(D.INVALID_ARGUMENT,`Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: ${Xs(r)}.`)}function bd(s,i){if(!Array.isArray(s)||0===s.length)throw new k(D.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${i.toString()}' filters.`);if(s.length>10)throw new k(D.INVALID_ARGUMENT,`Invalid Query. '${i.toString()}' filters support a maximum of 10 elements in the value array.`)}function Td(s,i,r){if(!r.isEqual(i))throw new k(D.INVALID_ARGUMENT,`Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '${i.toString()}' and so you must also use '${i.toString()}' as your first argument to orderBy(), but your first orderBy() is on field '${r.toString()}' instead.`)}class Nc{convertValue(i,r="none"){switch(zn(i)){case 0:return null;case 1:return i.booleanValue;case 2:return Ee(i.integerValue||i.doubleValue);case 3:return this.convertTimestamp(i.timestampValue);case 4:return this.convertServerTimestamp(i,r);case 5:return i.stringValue;case 6:return this.convertBytes(Ti(i.bytesValue));case 7:return this.convertReference(i.referenceValue);case 8:return this.convertGeoPoint(i.geoPointValue);case 9:return this.convertArray(i.arrayValue,r);case 10:return this.convertObject(i.mapValue,r);default:throw B()}}convertObject(i,r){const o={};return qn(i.fields,(a,c)=>{o[a]=this.convertValue(c,r)}),o}convertGeoPoint(i){return new eo(Ee(i.latitude),Ee(i.longitude))}convertArray(i,r){return(i.values||[]).map(o=>this.convertValue(o,r))}convertServerTimestamp(i,r){switch(r){case"previous":const o=Zl(i);return null==o?null:this.convertValue(o,r);case"estimate":return this.convertTimestamp(Sr(i));default:return null}}convertTimestamp(i){const r=pn(i);return new Ne(r.seconds,r.nanos)}convertDocumentKey(i,r){const o=te.fromString(i);K(Gu(o));const a=new Yi(o.get(1),o.get(3)),c=new V(o.popFirst(5));return a.isEqual(r)||Te(`Document ${c} contains a document reference within a different database (${a.projectId}/${a.database}) which is not supported. It will be treated as a reference in the current database (${r.projectId}/${r.database}) instead.`),c}}function so(s,i,r){let o;return o=s?r&&(r.merge||r.mergeFields)?s.toFirestore(i,r):s.toFirestore(i):i,o}class Pm extends Nc{constructor(i){super(),this.firestore=i}convertBytes(i){return new kt(i)}convertReference(i){const r=this.convertDocumentKey(i,this.firestore._databaseId);return new ce(this.firestore,null,r)}}class Ed{constructor(i,r){this._firestore=i,this._commitHandler=r,this._mutations=[],this._committed=!1,this._dataReader=Xn(i)}set(i,r,o){this._verifyNotCommitted();const a=Sn(i,this._firestore),c=so(a.converter,r,o),l=no(this._dataReader,"WriteBatch.set",a._key,c,null!==a.converter,o);return this._mutations.push(l.toMutation(a._key,Ie.none())),this}update(i,r,o,...a){this._verifyNotCommitted();const c=Sn(i,this._firestore);let l;return l="string"==typeof(r=(0,W.m9)(r))||r instanceof Ht?Cc(this._dataReader,"WriteBatch.update",c._key,r,o,a):xc(this._dataReader,"WriteBatch.update",c._key,r),this._mutations.push(l.toMutation(c._key,Ie.exists(!0))),this}delete(i){this._verifyNotCommitted();const r=Sn(i,this._firestore);return this._mutations=this._mutations.concat(new Lr(r._key,Ie.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new k(D.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Sn(s,i){if((s=(0,W.m9)(s)).firestore!==i)throw new k(D.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return s}class ti extends Nc{constructor(i){super(),this.firestore=i}convertBytes(i){return new kt(i)}convertReference(i){const r=this.convertDocumentKey(i,this.firestore._databaseId);return new ce(this.firestore,null,r)}}function Id(s,i,r){s=ee(s,ce);const o=ee(s.firestore,me),a=so(s.converter,i,r);return Qi(o,[no(Xn(o),"setDoc",s._key,a,null!==s.converter,r).toMutation(s._key,Ie.none())])}function Sd(s,i,r,...o){s=ee(s,ce);const a=ee(s.firestore,me),c=Xn(a);let l;return l="string"==typeof(i=(0,W.m9)(i))||i instanceof Ht?Cc(c,"updateDoc",s._key,i,r,o):xc(c,"updateDoc",s._key,i),Qi(a,[l.toMutation(s._key,Ie.exists(!0))])}function Dd(s,...i){var r,o,a;s=(0,W.m9)(s);let c={includeMetadataChanges:!1},l=0;"object"!=typeof i[l]||Sc(i[l])||(c=i[l],l++);const d={includeMetadataChanges:c.includeMetadataChanges};if(Sc(i[l])){const b=i[l];i[l]=null===(r=b.next)||void 0===r?void 0:r.bind(b),i[l+1]=null===(o=b.error)||void 0===o?void 0:o.bind(b),i[l+2]=null===(a=b.complete)||void 0===a?void 0:a.bind(b)}let f,m,w;if(s instanceof ce)m=ee(s.firestore,me),w=Si(s._key.path),f={next:b=>{i[l]&&i[l](kc(m,s,b))},error:i[l+1],complete:i[l+2]};else{const b=ee(s,ze);m=ee(b.firestore,me),w=b._query;const x=new ti(m);f={next:P=>{i[l]&&i[l](new En(m,x,b,P))},error:i[l+1],complete:i[l+2]},gd(s._query)}return function(b,x,P,O){const q=new Qs(O),H=new za(x,q,P);return b.asyncQueue.enqueueAndForget((0,C.Z)(function*(){return Ua(yield Hi(b),H)})),()=>{q.Xo(),b.asyncQueue.enqueueAndForget((0,C.Z)(function*(){return Ba(yield Hi(b),H)}))}}(Ae(m),w,d,f)}function Qi(s,i){return function(r,o){const a=new Pe;return r.asyncQueue.enqueueAndForget((0,C.Z)(function*(){return function(s,i,r){return Ha.apply(this,arguments)}(yield Tc(r),o,a)})),a.promise}(Ae(s),i)}function kc(s,i,r){const o=r.docs.get(i._key),a=new ti(s);return new Yt(s,a,i._key,o,new ei(r.hasPendingWrites,r.fromCache),i.converter)}class qm extends class{constructor(i,r){this._firestore=i,this._transaction=r,this._dataReader=Xn(i)}get(i){const r=Sn(i,this._firestore),o=new Pm(this._firestore);return this._transaction.lookup([r._key]).then(a=>{if(!a||1!==a.length)return B();const c=a[0];if(c.isFoundDocument())return new Yr(this._firestore,o,c.key,c,r.converter);if(c.isNoDocument())return new Yr(this._firestore,o,r._key,null,r.converter);throw B()})}set(i,r,o){const a=Sn(i,this._firestore),c=so(a.converter,r,o),l=no(this._dataReader,"Transaction.set",a._key,c,null!==a.converter,o);return this._transaction.set(a._key,l),this}update(i,r,o,...a){const c=Sn(i,this._firestore);let l;return l="string"==typeof(r=(0,W.m9)(r))||r instanceof Ht?Cc(this._dataReader,"Transaction.update",c._key,r,o,a):xc(this._dataReader,"Transaction.update",c._key,r),this._transaction.update(c._key,l),this}delete(i){const r=Sn(i,this._firestore);return this._transaction.delete(r._key),this}}{constructor(i,r){super(i,r),this._firestore=i}get(i){const r=Sn(i,this._firestore),o=new ti(this._firestore);return super.get(i).then(a=>new Yt(this._firestore,o,r._key,a._document,new ei(!1,!1),r.converter))}}function Lc(s,i){if(void 0===i)return{merge:!1};if(void 0!==i.mergeFields&&void 0!==i.merge)throw new k("invalid-argument",`Invalid options passed to function ${s}(): You cannot specify both "merge" and "mergeFields".`);return i}function xd(){if("undefined"==typeof Uint8Array)throw new k("unimplemented","Uint8Arrays are not available in this environment.")}function Cd(){if("undefined"==typeof atob)throw new k("unimplemented","Blobs are unavailable in Firestore in this environment.")}(function(s){_i=s})(en.SDK_VERSION),(0,en._registerComponent)(new it.wA("firestore",(s,{options:i})=>{const r=s.getProvider("app").getImmediate(),o=new me(r,new If(s.getProvider("auth-internal")));return i=Object.assign({useFetchStreams:!0},i),o._setSettings(i),o},"PUBLIC")),(0,en.registerVersion)("@firebase/firestore","3.0.1",void 0);class Xr{constructor(i){this._delegate=i}static fromBase64String(i){return Cd(),new Xr(kt.fromBase64String(i))}static fromUint8Array(i){return xd(),new Xr(kt.fromUint8Array(i))}toBase64(){return Cd(),this._delegate.toBase64()}toUint8Array(){return xd(),this._delegate.toUint8Array()}isEqual(i){return this._delegate.isEqual(i._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}}function Oc(s){return function(s,i){if("object"!=typeof s||null===s)return!1;const r=s;for(const o of["next","error","complete"])if(o in r&&"function"==typeof r[o])return!0;return!1}(s)}class Xm{enableIndexedDbPersistence(i,r){return function(s,i){od(s=ee(s,me));const r=Ae(s),o=s._freezeSettings(),a=new gc;return sd(r,a,new qh(a,o.cacheSizeBytes,null==i?void 0:i.forceOwnership))}(i._delegate,{forceOwnership:r})}enableMultiTabIndexedDbPersistence(i){return function(s){od(s=ee(s,me));const i=Ae(s),r=s._freezeSettings(),o=new gc;return sd(i,o,new Vg(o,r.cacheSizeBytes))}(i._delegate)}clearIndexedDbPersistence(i){return function(s){if(s._initialized&&!s._terminated)throw new k(D.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const i=new Pe;return s._queue.enqueueAndForgetEvenWhileRestricted((0,C.Z)(function*(){try{yield(r=(0,C.Z)(function*(o){if(!bt.Pt())return Promise.resolve();const a=o+"main";yield bt.delete(a)}),function(o){return r.apply(this,arguments)})(aa(s._databaseId,s._persistenceKey)),i.resolve()}catch(r){i.reject(r)}var r})),i.promise}(i._delegate)}}class Ad{constructor(i,r,o){this._delegate=r,this._persistenceProvider=o,this.INTERNAL={delete:()=>this.terminate()},i instanceof Yi||(this._appCompat=i)}get _databaseId(){return this._delegate._databaseId}settings(i){const r=this._delegate._getSettings();!i.merge&&r.host!==i.host&&Er("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),i.merge&&delete(i=Object.assign(Object.assign({},r),i)).merge,this._delegate._setSettings(i)}useEmulator(i,r,o={}){!function(s,i,r,o={}){var a;const c=(s=ee(s,Zr))._getSettings();if("firestore.googleapis.com"!==c.host&&c.host!==i&&Er("Host has been set in both settings() and useEmulator(), emulator host will be used"),s._setSettings(Object.assign(Object.assign({},c),{host:`${i}:${r}`,ssl:!1})),o.mockUserToken){let l,d;if("string"==typeof o.mockUserToken)l=o.mockUserToken,d=Fe.MOCK_USER;else{l=(0,W.Sg)(o.mockUserToken,null===(a=s._app)||void 0===a?void 0:a.options.projectId);const f=o.mockUserToken.sub||o.mockUserToken.user_id;if(!f)throw new k(D.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");d=new Fe(f)}s._credentials=new Ef(new Gl(l,d))}}(this._delegate,i,r,o)}enableNetwork(){return function(s){return function(s){return s.asyncQueue.enqueue((0,C.Z)(function*(){const i=yield $h(s),r=yield Kh(s);return i.setNetworkEnabled(!0),function(o){const a=M(o);return a.Kr.delete(0),$r(a)}(r)}))}(Ae(s=ee(s,me)))}(this._delegate)}disableNetwork(){return function(s){return function(s){return s.asyncQueue.enqueue((0,C.Z)(function*(){const i=yield $h(s),r=yield Kh(s);return i.setNetworkEnabled(!1),(o=(0,C.Z)(function*(a){const c=M(a);c.Kr.add(0),yield qi(c),c.Wr.set("Offline")}),function(a){return o.apply(this,arguments)})(r);var o}))}(Ae(s=ee(s,me)))}(this._delegate)}enablePersistence(i){let r=!1,o=!1;return i&&(r=!!i.synchronizeTabs,o=!!i.experimentalForceOwningTab,Qh("synchronizeTabs",r,"experimentalForceOwningTab",o)),r?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,o)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return function(s){return function(i){const r=new Pe;return i.asyncQueue.enqueueAndForget((0,C.Z)(function*(){return function(s,i){return Ja.apply(this,arguments)}(yield Tc(i),r)})),r.promise}(Ae(s=ee(s,me)))}(this._delegate)}onSnapshotsInSync(i){return function(s,i){return function(s,i){const r=new Qs(i);return s.asyncQueue.enqueueAndForget((0,C.Z)(function*(){return o=yield Hi(s),a=r,M(o).Zr.add(a),void a.next();var o,a})),()=>{r.Xo(),s.asyncQueue.enqueueAndForget((0,C.Z)(function*(){return o=yield Hi(s),a=r,void M(o).Zr.delete(a);var o,a}))}}(Ae(s=ee(s,me)),Sc(i)?i:{next:i})}(this._delegate,i)}get app(){if(!this._appCompat)throw new k("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(i){try{return new Wi(this,td(this._delegate,i))}catch(r){throw Ke(r,"collection()","Firestore.collection()")}}doc(i){try{return new pt(this,Js(this._delegate,i))}catch(r){throw Ke(r,"doc()","Firestore.doc()")}}collectionGroup(i){try{return new Ze(this,function(s,i){if(s=ee(s,Zr),Ic("collectionGroup","collection id",i),i.indexOf("/")>=0)throw new k(D.INVALID_ARGUMENT,`Invalid collection ID '${i}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new ze(s,null,(r=i,new jt(te.emptyPath(),r)));var r}(this._delegate,i))}catch(r){throw Ke(r,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(i){return function(s,i){return function(s,i){const r=new Pe;return s.asyncQueue.enqueueAndForget((0,C.Z)(function*(){const o=yield(a=s,Ws(a).then(c=>c.datastore));var a;new Gg(s.asyncQueue,o,i,r).run()})),r.promise}(Ae(s),r=>i(new qm(s,r)))}(this._delegate,r=>i(new Rd(this,r)))}batch(){return Ae(this._delegate),new Pd(new Ed(this._delegate,i=>Qi(this._delegate,i)))}loadBundle(i){return function(s,i){const r=Ae(s=ee(s,me)),o=new nm;return function(s,i,r,o){const a=function(c,l){let d;return d="string"==typeof c?(new TextEncoder).encode(c):c,f=function(f,m){if(f instanceof Uint8Array)return Gh(f,m);if(f instanceof ArrayBuffer)return Gh(new Uint8Array(f),m);if(f instanceof ReadableStream)return f.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(d),new Bg(f,l);var f}(r,jr(i));s.asyncQueue.enqueueAndForget((0,C.Z)(function*(){!function(s,i,r){const o=M(s);var a;(a=(0,C.Z)(function*(c,l,d){try{const f=yield l.getMetadata();if(yield function(x,P){const O=M(x),q=Le(P.createTime);return O.persistence.runTransaction("hasNewerBundle","readonly",H=>O.Je.getBundleMetadata(H,P.id)).then(H=>!!H&&H.createTime.compareTo(q)>=0)}(c.localStore,f))return yield l.close(),void d._completeWith((x=f,{taskState:"Success",documentsLoaded:x.totalDocuments,bytesLoaded:x.totalBytes,totalDocuments:x.totalDocuments,totalBytes:x.totalBytes}));d._updateProgress(Ph(f));const m=new yg(f,c.localStore,l.N);let w=yield l.Qo();for(;w;){const x=yield m.fo(w);x&&d._updateProgress(x),w=yield l.Qo()}const b=yield m.complete();yield Zt(c,b.Tn,void 0),yield function(x,P){const O=M(x);return O.persistence.runTransaction("Save bundle","readwrite",q=>O.Je.saveBundleMetadata(q,P))}(c.localStore,f),d._completeWith(b.progress)}catch(f){Er("SyncEngine",`Loading bundle failed with ${f}`),d._failWith(f)}var x}),function(c,l,d){return a.apply(this,arguments)})(o,i,r).then(()=>{o.sharedClientState.notifyBundleLoaded()})}(yield Tc(s),a,o)}))}(r,s._databaseId,i,o),o}(this._delegate,i)}namedQuery(i){return function(s,i){return function(s,i){return s.asyncQueue.enqueue((0,C.Z)(function*(){return function(r,o){const a=M(r);return a.persistence.runTransaction("Get named query","readonly",c=>a.Je.getNamedQuery(c,o))}(yield bc(s),i)}))}(Ae(s=ee(s,me)),i).then(r=>r?new ze(s,null,r.query):null)}(this._delegate,i).then(r=>r?new Ze(this,r):null)}}class oo extends Nc{constructor(i){super(),this.firestore=i}convertBytes(i){return new Xr(new kt(i))}convertReference(i){const r=this.convertDocumentKey(i,this.firestore._databaseId);return pt.forKey(r,this.firestore,null)}}class Rd{constructor(i,r){this._firestore=i,this._delegate=r,this._userDataWriter=new oo(i)}get(i){const r=ii(i);return this._delegate.get(r).then(o=>new Jr(this._firestore,new Yt(this._firestore._delegate,this._userDataWriter,o._key,o._document,o.metadata,r.converter)))}set(i,r,o){const a=ii(i);return o?(Lc("Transaction.set",o),this._delegate.set(a,r,o)):this._delegate.set(a,r),this}update(i,r,o,...a){const c=ii(i);return 2===arguments.length?this._delegate.update(c,r):this._delegate.update(c,r,o,...a),this}delete(i){const r=ii(i);return this._delegate.delete(r),this}}class Pd{constructor(i){this._delegate=i}set(i,r,o){const a=ii(i);return o?(Lc("WriteBatch.set",o),this._delegate.set(a,r,o)):this._delegate.set(a,r),this}update(i,r,o,...a){const c=ii(i);return 2===arguments.length?this._delegate.update(c,r):this._delegate.update(c,r,o,...a),this}delete(i){const r=ii(i);return this._delegate.delete(r),this}commit(){return this._delegate.commit()}}class ni{constructor(i,r,o){this._firestore=i,this._userDataWriter=r,this._delegate=o}fromFirestore(i,r){const o=new Qr(this._firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,null);return this._delegate.fromFirestore(new es(this._firestore,o),null!=r?r:{})}toFirestore(i,r){return r?this._delegate.toFirestore(i,r):this._delegate.toFirestore(i)}static getInstance(i,r){const o=ni.INSTANCES;let a=o.get(i);a||(a=new WeakMap,o.set(i,a));let c=a.get(r);return c||(c=new ni(i,new oo(i),r),a.set(r,c)),c}}ni.INSTANCES=new WeakMap;class pt{constructor(i,r){this.firestore=i,this._delegate=r,this._userDataWriter=new oo(i)}static forPath(i,r,o){if(i.length%2!=0)throw new k("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${i.canonicalString()} has ${i.length}`);return new pt(r,new ce(r._delegate,o,new V(i)))}static forKey(i,r,o){return new pt(r,new ce(r._delegate,o,i))}get id(){return this._delegate.id}get parent(){return new Wi(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(i){try{return new Wi(this.firestore,td(this._delegate,i))}catch(r){throw Ke(r,"collection()","DocumentReference.collection()")}}isEqual(i){return(i=(0,W.m9)(i))instanceof ce&&nd(this._delegate,i)}set(i,r){r=Lc("DocumentReference.set",r);try{return r?Id(this._delegate,i,r):Id(this._delegate,i)}catch(o){throw Ke(o,"setDoc()","DocumentReference.set()")}}update(i,r,...o){try{return 1===arguments.length?Sd(this._delegate,i):Sd(this._delegate,i,r,...o)}catch(a){throw Ke(a,"updateDoc()","DocumentReference.update()")}}delete(){return function(s){return Qi(ee(s.firestore,me),[new Lr(s._key,Ie.none())])}(this._delegate)}onSnapshot(...i){const r=Nd(i),o=kd(i,a=>new Jr(this.firestore,new Yt(this.firestore._delegate,this._userDataWriter,a._key,a._document,a.metadata,this._delegate.converter)));return Dd(this._delegate,r,o)}get(i){let r;return r="cache"===(null==i?void 0:i.source)?function(s){s=ee(s,ce);const i=ee(s.firestore,me),r=Ae(i),o=new ti(i);return function(s,i){const r=new Pe;return s.asyncQueue.enqueueAndForget((0,C.Z)(function*(){return(o=(0,C.Z)(function*(a,c,l){try{const d=yield function(f,m){const w=M(f);return w.persistence.runTransaction("read document","readonly",b=>w.Qn.An(b,m))}(a,c);d.isFoundDocument()?l.resolve(d):d.isNoDocument()?l.resolve(null):l.reject(new k(D.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(d){const f=ji(d,`Failed to get document '${c} from cache`);l.reject(f)}}),function(a,c,l){return o.apply(this,arguments)})(yield bc(s),i,r);var o})),r.promise}(r,s._key).then(a=>new Yt(i,o,s._key,a,new ei(null!==a&&a.hasLocalMutations,!0),s.converter))}(this._delegate):"server"===(null==i?void 0:i.source)?function(s){s=ee(s,ce);const i=ee(s.firestore,me);return Zh(Ae(i),s._key,{source:"server"}).then(r=>kc(i,s,r))}(this._delegate):function(s){s=ee(s,ce);const i=ee(s.firestore,me);return Zh(Ae(i),s._key).then(r=>kc(i,s,r))}(this._delegate),r.then(o=>new Jr(this.firestore,new Yt(this.firestore._delegate,this._userDataWriter,o._key,o._document,o.metadata,this._delegate.converter)))}withConverter(i){return new pt(this.firestore,this._delegate.withConverter(i?ni.getInstance(this.firestore,i):null))}}function Ke(s,i,r){return s.message=s.message.replace(i,r),s}function Nd(s){for(const i of s)if("object"==typeof i&&!Oc(i))return i;return{}}function kd(s,i){var r,o;let a;return a=Oc(s[0])?s[0]:Oc(s[1])?s[1]:"function"==typeof s[0]?{next:s[0],error:s[1],complete:s[2]}:{next:s[1],error:s[2],complete:s[3]},{next:c=>{a.next&&a.next(i(c))},error:null===(r=a.error)||void 0===r?void 0:r.bind(a),complete:null===(o=a.complete)||void 0===o?void 0:o.bind(a)}}class Jr{constructor(i,r){this._firestore=i,this._delegate=r}get ref(){return new pt(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(i){return this._delegate.data(i)}get(i,r){return this._delegate.get(i,r)}isEqual(i){return pd(this._delegate,i._delegate)}}class es extends Jr{data(i){const r=this._delegate.data(i);return function(s,i){s||B()}(void 0!==r),r}}class Ze{constructor(i,r){this.firestore=i,this._delegate=r,this._userDataWriter=new oo(i)}where(i,r,o){try{return new Ze(this.firestore,In(this._delegate,function(s,i,r){const o=i,a=ro("where",s);return new bm(a,o,r)}(i,r,o)))}catch(a){throw Ke(a,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(i,r){try{return new Ze(this.firestore,In(this._delegate,function(s,i="asc"){const r=i,o=ro("orderBy",s);return new Em(o,r)}(i,r)))}catch(o){throw Ke(o,/(orderBy|where)\(\)/,"Query.$1()")}}limit(i){try{return new Ze(this.firestore,In(this._delegate,function(s){return Jh("limit",s),new md("limit",s,"F")}(i)))}catch(r){throw Ke(r,"limit()","Query.limit()")}}limitToLast(i){try{return new Ze(this.firestore,In(this._delegate,function(s){return Jh("limitToLast",s),new md("limitToLast",s,"L")}(i)))}catch(r){throw Ke(r,"limitToLast()","Query.limitToLast()")}}startAt(...i){try{return new Ze(this.firestore,In(this._delegate,function(...s){return new yd("startAt",s,!0)}(...i)))}catch(r){throw Ke(r,"startAt()","Query.startAt()")}}startAfter(...i){try{return new Ze(this.firestore,In(this._delegate,function(...s){return new yd("startAfter",s,!1)}(...i)))}catch(r){throw Ke(r,"startAfter()","Query.startAfter()")}}endBefore(...i){try{return new Ze(this.firestore,In(this._delegate,function(...s){return new vd("endBefore",s,!0)}(...i)))}catch(r){throw Ke(r,"endBefore()","Query.endBefore()")}}endAt(...i){try{return new Ze(this.firestore,In(this._delegate,function(...s){return new vd("endAt",s,!1)}(...i)))}catch(r){throw Ke(r,"endAt()","Query.endAt()")}}isEqual(i){return id(this._delegate,i._delegate)}get(i){let r;return r="cache"===(null==i?void 0:i.source)?function(s){s=ee(s,ze);const i=ee(s.firestore,me),r=Ae(i),o=new ti(i);return function(s,i){const r=new Pe;return s.asyncQueue.enqueueAndForget((0,C.Z)(function*(){return(o=(0,C.Z)(function*(a,c,l){try{const d=yield js(a,c,!0),f=new Lh(c,d.Gn),m=f.Io(d.documents),w=f.applyChanges(m,!1);l.resolve(w.snapshot)}catch(d){const f=ji(d,`Failed to execute query '${c} against cache`);l.reject(f)}}),function(a,c,l){return o.apply(this,arguments)})(yield bc(s),i,r);var o})),r.promise}(r,s._query).then(a=>new En(i,o,s,a))}(this._delegate):"server"===(null==i?void 0:i.source)?function(s){s=ee(s,ze);const i=ee(s.firestore,me),r=Ae(i),o=new ti(i);return Hh(r,s._query,{source:"server"}).then(a=>new En(i,o,s,a))}(this._delegate):function(s){s=ee(s,ze);const i=ee(s.firestore,me),r=Ae(i),o=new ti(i);return gd(s._query),Hh(r,s._query).then(a=>new En(i,o,s,a))}(this._delegate),r.then(o=>new Mc(this.firestore,new En(this.firestore._delegate,this._userDataWriter,this._delegate,o._snapshot)))}onSnapshot(...i){const r=Nd(i),o=kd(i,a=>new Mc(this.firestore,new En(this.firestore._delegate,this._userDataWriter,this._delegate,a._snapshot)));return Dd(this._delegate,r,o)}withConverter(i){return new Ze(this.firestore,this._delegate.withConverter(i?ni.getInstance(this.firestore,i):null))}}class ey{constructor(i,r){this._firestore=i,this._delegate=r}get type(){return this._delegate.type}get doc(){return new es(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class Mc{constructor(i,r){this._firestore=i,this._delegate=r}get query(){return new Ze(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(i=>new es(this._firestore,i))}docChanges(i){return this._delegate.docChanges(i).map(r=>new ey(this._firestore,r))}forEach(i,r){this._delegate.forEach(o=>{i.call(r,new es(this._firestore,o))})}isEqual(i){return pd(this._delegate,i._delegate)}}class Wi extends Ze{constructor(i,r){super(i,r),this.firestore=i,this._delegate=r}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const i=this._delegate.parent;return i?new pt(this.firestore,i):null}doc(i){try{return new pt(this.firestore,void 0===i?Js(this._delegate):Js(this._delegate,i))}catch(r){throw Ke(r,"doc()","CollectionReference.doc()")}}add(i){return function(s,i){const r=ee(s.firestore,me),o=Js(s),a=so(s.converter,i);return Qi(r,[no(Xn(s.firestore),"addDoc",o._key,a,null!==s.converter,{}).toMutation(o._key,Ie.exists(!1))]).then(()=>o)}(this._delegate,i).then(r=>new pt(this.firestore,r))}isEqual(i){return nd(this._delegate,i._delegate)}withConverter(i){return new Wi(this.firestore,this._delegate.withConverter(i?ni.getInstance(this.firestore,i):null))}}function ii(s){return ee(s,ce)}class Fc{constructor(...i){this._delegate=new Ht(...i)}static documentId(){return new Fc(Ue.keyField().canonicalString())}isEqual(i){return(i=(0,W.m9)(i))instanceof Ht&&this._delegate._internalPath.isEqual(i._internalPath)}}class ri{constructor(i){this._delegate=i}static serverTimestamp(){const i=new Dc("serverTimestamp");return i._methodName="FieldValue.serverTimestamp",new ri(i)}static delete(){const i=new Hr("deleteField");return i._methodName="FieldValue.delete",new ri(i)}static arrayUnion(...i){const r=function(...s){return new gm("arrayUnion",s)}(...i);return r._methodName="FieldValue.arrayUnion",new ri(r)}static arrayRemove(...i){const r=function(...s){return new mm("arrayRemove",s)}(...i);return r._methodName="FieldValue.arrayRemove",new ri(r)}static increment(i){const r=function(s){return new ym("increment",s)}(i);return r._methodName="FieldValue.increment",new ri(r)}isEqual(i){return this._delegate.isEqual(i._delegate)}}const ty={Firestore:Ad,GeoPoint:eo,Timestamp:Ne,Blob:Xr,Transaction:Rd,WriteBatch:Pd,DocumentReference:pt,DocumentSnapshot:Jr,Query:Ze,QueryDocumentSnapshot:es,QuerySnapshot:Mc,CollectionReference:Wi,FieldPath:Fc,FieldValue:ri,setLogLevel:function(s){!function(s){fn.setLogLevel(s)}(s)},CACHE_SIZE_UNLIMITED:-1};!function(s){(function(s,i){s.INTERNAL.registerComponent(new it.wA("firestore-compat",r=>((i,r)=>new Ad(i,r,new Xm))(r.getProvider("app-compat").getImmediate(),r.getProvider("firestore").getImmediate()),"PUBLIC").setServiceProps(Object.assign({},ty)))})(s),s.registerVersion("@firebase/firestore-compat","0.1.1")}(xn.Z);var Dn=A(3820);function Ld(s,i){return function(s,i=he.z){return new y.y(r=>{let o;return null!=i?i.schedule(()=>{o=s.onSnapshot({includeMetadataChanges:!0},r)}):o=s.onSnapshot({includeMetadataChanges:!0},r),()=>{null!=o&&o()}})}(s,i)}function Uc(s,i){return Ld(s,i).pipe((0,ve.U)(r=>({payload:r,type:"query"})))}function ao(s,i){return Uc(s,i).pipe((0,Me.O)(void 0),(0,we.G)(),(0,ve.U)(([r,o])=>{const a=o.payload.docChanges(),c=a.map(l=>({type:l.type,payload:l}));return r&&JSON.stringify(r.payload.metadata)!==JSON.stringify(o.payload.metadata)&&o.payload.docs.forEach((l,d)=>{const f=a.find(w=>w.doc.ref.isEqual(l.ref)),m=null==r?void 0:r.payload.docs.find(w=>w.ref.isEqual(l.ref));f&&JSON.stringify(f.doc.metadata)===JSON.stringify(l.metadata)||!f&&m&&JSON.stringify(m.metadata)===JSON.stringify(l.metadata)||c.push({type:"modified",payload:{oldIndex:d,newIndex:d,type:"modified",doc:l}})}),c}))}function Od(s,i,r){return ao(s,r).pipe((0,ut.R)((o,a)=>function(s,i,r){return i.forEach(o=>{r.indexOf(o.type)>-1&&(s=function(s,i){switch(i.type){case"added":if(!s[i.newIndex]||!s[i.newIndex].doc.ref.isEqual(i.doc.ref))return Vc(s,i.newIndex,0,i);break;case"modified":if(null==s[i.oldIndex]||s[i.oldIndex].doc.ref.isEqual(i.doc.ref)){if(i.oldIndex!==i.newIndex){const r=s.slice();return r.splice(i.oldIndex,1),r.splice(i.newIndex,0,i),r}return Vc(s,i.newIndex,1,i)}break;case"removed":if(s[i.oldIndex]&&s[i.oldIndex].doc.ref.isEqual(i.doc.ref))return Vc(s,i.oldIndex,1)}return s}(s,o))}),s}(o,a.map(c=>c.payload),i),[]),(0,Wt.x)(),(0,ve.U)(o=>o.map(a=>({type:a.type,payload:a}))))}function Vc(s,i,r,...o){const a=s.slice();return a.splice(i,r,...o),a}function Md(s){return(!s||0===s.length)&&(s=["added","removed","modified"]),s}A(7841);class Fd{constructor(i,r,o){this.ref=i,this.query=r,this.afs=o}stateChanges(i){let r=ao(this.query,this.afs.schedulers.outsideAngular);return i&&i.length>0&&(r=r.pipe((0,ve.U)(o=>o.filter(a=>i.indexOf(a.type)>-1)))),r.pipe((0,Me.O)(void 0),(0,we.G)(),(0,se.h)(([o,a])=>a.length>0||!o),(0,ve.U)(([o,a])=>a),re.iC)}auditTrail(i){return this.stateChanges(i).pipe((0,ut.R)((r,o)=>[...r,...o],[]))}snapshotChanges(i){const r=Md(i);return Od(this.query,r,this.afs.schedulers.outsideAngular).pipe(re.iC)}valueChanges(i={}){return Uc(this.query,this.afs.schedulers.outsideAngular).pipe((0,ve.U)(r=>r.payload.docs.map(o=>i.idField?Object.assign(Object.assign({},o.data()),{[i.idField]:o.id}):o.data())),re.iC)}get(i){return(0,$.D)(this.query.get(i)).pipe(re.f6)}add(i){return this.ref.add(i)}doc(i){return new Ud(this.ref.doc(i),this.afs)}}class Ud{constructor(i,r){this.ref=i,this.afs=r}set(i,r){return this.ref.set(i,r)}update(i){return this.ref.update(i)}delete(){return this.ref.delete()}collection(i,r){const o=this.ref.collection(i),{ref:a,query:c}=Vd(o,r);return new Fd(a,c,this.afs)}snapshotChanges(){return function(s,i){return Ld(s,i).pipe((0,Me.O)(void 0),(0,we.G)(),(0,ve.U)(([r,o])=>o.exists?(null==r?void 0:r.exists)?{payload:o,type:"modified"}:{payload:o,type:"added"}:{payload:o,type:"removed"}))}(this.ref,this.afs.schedulers.outsideAngular).pipe(re.iC)}valueChanges(i={}){return this.snapshotChanges().pipe((0,ve.U)(({payload:r})=>i.idField?Object.assign(Object.assign({},r.data()),{[i.idField]:r.id}):r.data()))}get(i){return(0,$.D)(this.ref.get(i)).pipe((0,gt.QV)(this.afs.schedulers.insideAngular))}}class cy{constructor(i,r){this.query=i,this.afs=r}stateChanges(i){return i&&0!==i.length?ao(this.query,this.afs.schedulers.outsideAngular).pipe((0,ve.U)(r=>r.filter(o=>i.indexOf(o.type)>-1)),(0,se.h)(r=>r.length>0),re.iC):ao(this.query,this.afs.schedulers.outsideAngular).pipe(re.iC)}auditTrail(i){return this.stateChanges(i).pipe((0,ut.R)((r,o)=>[...r,...o],[]))}snapshotChanges(i){const r=Md(i);return Od(this.query,r,this.afs.schedulers.outsideAngular).pipe(re.iC)}valueChanges(i={}){return Uc(this.query,this.afs.schedulers.outsideAngular).pipe((0,ve.U)(o=>o.payload.docs.map(a=>i.idField?Object.assign({[i.idField]:a.id},a.data()):a.data())),re.iC)}get(i){return(0,$.D)(this.query.get(i)).pipe(re.f6)}}const ly=new E.OlP("angularfire2.enableFirestorePersistence"),uy=new E.OlP("angularfire2.firestore.persistenceSettings"),hy=new E.OlP("angularfire2.firestore.settings"),dy=new E.OlP("angularfire2.firestore.use-emulator");function Vd(s,i=(r=>r)){return{query:i(s),ref:s}}let fy=(()=>{class s{constructor(r,o,a,c,l,d,f,m,w,b,x,P,O,q,H,ye){this.schedulers=f;const He=(0,Xt.on)(r,d,o),Qt=w;b&&(0,Dn.nw)(He,d,x,O,q,H,P,ye),[this.firestore,this.persistenceEnabled$]=(0,re.cc)(`${He.name}.firestore`,"AngularFirestore",He.name,()=>{const Tt=d.runOutsideAngular(()=>He.firestore());if(c&&Tt.settings(c),Qt&&Tt.useEmulator(...Qt),a&&!(0,nt.PM)(l)){const ts=()=>{try{return(0,$.D)(Tt.enablePersistence(m||void 0).then(()=>!0,()=>!1))}catch(co){return"undefined"!=typeof console&&console.warn(co),(0,Q.of)(!1)}};return[Tt,d.runOutsideAngular(ts)]}return[Tt,(0,Q.of)(!1)]},[c,Qt,a])}collection(r,o){let a;a="string"==typeof r?this.firestore.collection(r):r;const{ref:c,query:l}=Vd(a,o),d=this.schedulers.ngZone.run(()=>c);return new Fd(d,l,this)}collectionGroup(r,o){const a=o||(l=>l),c=this.firestore.collectionGroup(r);return new cy(a(c),this)}doc(r){let o;o="string"==typeof r?this.firestore.doc(r):r;const a=this.schedulers.ngZone.run(()=>o);return new Ud(a,this)}createId(){return this.firestore.collection("_").doc().id}}return s.\u0275fac=function(r){return new(r||s)(E.LFG(Xt.Dh),E.LFG(Xt.xv,8),E.LFG(ly,8),E.LFG(hy,8),E.LFG(E.Lbi),E.LFG(E.R0b),E.LFG(re.HU),E.LFG(uy,8),E.LFG(dy,8),E.LFG(Dn.zQ,8),E.LFG(Dn.Qv,8),E.LFG(Dn.L6,8),E.LFG(Dn._Q,8),E.LFG(Dn.rT,8),E.LFG(Dn.lh,8),E.LFG(Dn.f7,8))},s.\u0275prov=E.Yz7({token:s,factory:s.\u0275fac,providedIn:"any"}),s})(),py=(()=>{class s{constructor(r){this.db=r,this._dbPath="/repository",this.repositoryRef=r.collection(this._dbPath)}get data(){return this.repositoryRef}setUrl(r){this.repositoryRef=this.db.collection(r),this._dbPath=r}updateData(r){return this._dbPath="/templateff",this.db.collection(this._dbPath).add(r).then(o=>o)}createRepository(r){return this._dbPath="/repositoryNew",this.db.collection(this._dbPath).add(r).then(o=>o)}}return s.\u0275fac=function(r){return new(r||s)(E.LFG(fy))},s.\u0275prov=E.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})()},531:(Xi,lt,A)=>{A.d(lt,{F:()=>$});var E=A(7636),he=A(7716),y=A(625);let $=(()=>{class Q{constructor(Me){this._ovelay=Me}display(Me,we){const ve=Me;this.overlayRef=this._ovelay.create({hasBackdrop:!0,backdropClass:"cdk-overlay-transparent-backdrop",panelClass:"vorkurt-overlay",positionStrategy:this._ovelay.position().flexibleConnectedTo(ve).withPositions([{originX:"start",originY:"bottom",overlayX:"start",overlayY:"top"},{originX:"center",originY:"top",overlayX:"end",overlayY:"bottom"},{originX:"end",originY:"top",overlayX:"start",overlayY:"top"},{originX:"start",originY:"top",overlayX:"end",overlayY:"top"}])}),this.component=new E.C5(we),this.overlayRef.attach(this.component),this.overlayRef.backdropClick().subscribe(()=>{this.overlayRef.detach(),this.overlayRef.dispose()})}closeOverlay(){this.overlayRef.detach()}}return Q.\u0275fac=function(Me){return new(Me||Q)(he.LFG(y.aV))},Q.\u0275prov=he.Yz7({token:Q,factory:Q.\u0275fac,providedIn:"root"}),Q})()},2809:(Xi,lt,A)=>{A.d(lt,{f:()=>y});var E=A(6215),he=A(7716);let y=(()=>{class ${constructor(){this.timerArray=new Array,this._counterData=new E.X(new Array),this.counterData$=this._counterData.asObservable()}sendCounterData(re){re.id=0===this.timerArray.length?1:this.timerArray.length+1,this.timerArray.push(re),this._counterData.next(this.timerArray)}}return $.\u0275fac=function(re){return new(re||$)},$.\u0275prov=he.Yz7({token:$,factory:$.\u0275fac,providedIn:"root"}),$})()}}]);